# scMetaLink

**scMetaLink** is an R package for inferring metabolite-mediated
cell-cell communication from single-cell and spatial transcriptomics
data.

ðŸ“– **Documentation**: <https://Zaoqu-Liu.github.io/scMetaLink/>

## Background

Metabolites serve as critical signaling molecules in the cellular
microenvironment. While tools like CellChat and CellPhoneDB have
advanced our understanding of ligand-receptor interactions, the
metabolic dimension of intercellular communication remains
underexplored. scMetaLink addresses this gap by integrating enzyme
expression, transporter activity, and receptor-metabolite interactions
to reconstruct metabolite-mediated communication networks.

## Workflow

![](reference/figures/flowchart.png)

## Features

- **Metabolite Production Inference**: Estimate metabolite production
  potential based on biosynthetic enzyme expression
- **Metabolite Sensing Analysis**: Quantify sensing capability via
  receptors (GPCRs, nuclear receptors) and transporters
- **Statistical Framework**: Permutation-based significance testing with
  multiple hypothesis correction
- **Pathway Integration**: Aggregate communication patterns at the
  pathway level
- **Spatial Transcriptomics**: Distance-weighted communication analysis
  for spatial data
- **Visualization**: Heatmaps, chord diagrams, network plots, and
  spatial maps

## Database

scMetaLink utilizes MetalinksDB, containing:

- 41,894 metabolite-protein interactions
- 1,128 metabolites
- 4,374 proteins/genes
- 157,741 pathway associations

## Installation

``` r
# Install from GitHub
devtools::install_github("Zaoqu-Liu/scMetaLink")
```

## Quick Start

### Single-Cell Analysis

``` r
library(scMetaLink)

# Create scMetaLink object
obj <- createScMetaLink(
  expression_data = expr_matrix,
  cell_meta = cell_metadata,
  cell_type_column = "cell_type"
)

# Infer metabolite production and sensing
obj <- inferProduction(obj)
obj <- inferSensing(obj)

# Compute communication with significance testing
obj <- computeCommunication(obj, n_permutations = 1000)
obj <- filterSignificantInteractions(obj, pvalue_threshold = 0.05)

# Visualize results
plotCommunicationHeatmap(obj)
plotCommunicationCircle(obj)
```

For Seurat users:

``` r
result <- runScMetaLinkSeurat(seurat_obj, cell_type_column = "cell_type")
```

------------------------------------------------------------------------

## Spatial Transcriptomics Analysis

scMetaLink supports **spatial transcriptomics** data with
distance-weighted communication analysis.

### Spatial Workflow

![](reference/figures/spatial-flow.png)

### Spatial Communication Algorithm

![](reference/figures/spatial-cal.png)

### Spatial Quick Start

``` r
library(scMetaLink)

# Load spatial data
data(st_expr)
data(st_meta)
data(st_scalefactors)

# Create spatial scMetaLink object
obj <- createScMetaLinkFromSpatial(
  expression_data = st_expr,
  spatial_coords = st_meta[, c("x", "y")],
  cell_meta = st_meta,
  cell_type_column = "cell_type",
  scale_factors = st_scalefactors
)

# Infer production and sensing
obj <- inferProduction(obj)
obj <- inferSensing(obj)

# Compute spatially-weighted communication
obj <- computeSpatialCommunication(
  obj,
  method = "knn",        # K-nearest neighbors (recommended for Visium)
  k_neighbors = 6,       # Hexagonal grid neighbors
  n_permutations = 1000
)

# Filter and visualize
obj <- filterSignificantInteractions(obj)
plotSpatialCellTypes(obj)
plotSpatialCommunicationNetwork(obj)
plotSpatialFeature(obj, metabolite = "L-Lactic acid", type = "production")
```

### Spatial Weighting Methods

| Method        | Formula             | Best for              |
|:--------------|:--------------------|:----------------------|
| `knn`         | K-nearest neighbors | Visium (recommended)  |
| `gaussian`    | exp(-dÂ²/2ÏƒÂ²)        | Smooth decay          |
| `exponential` | exp(-d/Î»)           | Sharp decay           |
| `threshold`   | Binary cutoff       | Strict distance limit |

------------------------------------------------------------------------

## Methodology

### Metabolite Production Potential (MPP)

$$MPP(m,c) = \frac{\sum\limits_{e \in E_{m}^{+}}w_{e} \cdot \text{expr}(e,c)}{\left| E_{m}^{+} \right|} \cdot S(m)$$

where $E_{m}^{+}$ denotes biosynthetic enzymes for metabolite $m$,
$w_{e}$ is the evidence weight, and $S(m)$ represents secretion
potential.

### Metabolite Sensing Capability (MSC)

$$MSC(m,c) = \sum\limits_{r \in R_{m}}w_{r} \cdot \tau(r) \cdot \text{expr}(r,c)$$

where $R_{m}$ includes receptors and transporters for metabolite $m$,
and $\tau(r)$ is the receptor type weight.

### Communication Score

$$C\left( s\rightarrow r,m \right) = \sqrt{MPP(m,s) \times MSC(m,r)}$$

### Spatial Communication Score

$$C_{spatial}\left( s\rightarrow r,m \right) = \sqrt{MPP(m,s) \times MSC(m,r)} \times w\left( d_{sr} \right)$$

where $w(d)$ is the spatial weight function (e.g., Gaussian decay).

Statistical significance is assessed via permutation testing with FDR
correction.

------------------------------------------------------------------------

## Tutorials

| Tutorial                                                                                        | Description             |
|:------------------------------------------------------------------------------------------------|:------------------------|
| [Quick Start](https://Zaoqu-Liu.github.io/scMetaLink/articles/quick-start.html)                 | Basic workflow          |
| [Theory](https://Zaoqu-Liu.github.io/scMetaLink/articles/theory.html)                           | Mathematical framework  |
| [Production & Sensing](https://Zaoqu-Liu.github.io/scMetaLink/articles/production-sensing.html) | Inference details       |
| [Communication](https://Zaoqu-Liu.github.io/scMetaLink/articles/communication.html)             | Statistical analysis    |
| [Spatial Analysis](https://Zaoqu-Liu.github.io/scMetaLink/articles/spatial-analysis.html)       | Spatial transcriptomics |
| [Visualization](https://Zaoqu-Liu.github.io/scMetaLink/articles/visualization.html)             | Plotting functions      |
| [Applications](https://Zaoqu-Liu.github.io/scMetaLink/articles/applications.html)               | Case studies            |

## Citation

If you use scMetaLink in your research, please cite:

    Liu Z, et al. (2026). scMetaLink: Inferring metabolite-mediated cell-cell
    communication from single-cell and spatial transcriptomics data.

## Contact

- **Author**: Zaoqu Liu
- **Email**: <liuzaoqu@163.com>
- **GitHub**: <https://github.com/Zaoqu-Liu/scMetaLink>

# Package index

## Main Workflow

High-level functions for running scMetaLink analysis

- [`createScMetaLink()`](https://Zaoqu-Liu.github.io/scMetaLink/reference/createScMetaLink.md)
  : Create scMetaLink Object
- [`createScMetaLinkFromSeurat()`](https://Zaoqu-Liu.github.io/scMetaLink/reference/createScMetaLinkFromSeurat.md)
  : Create scMetaLink from Seurat Object
- [`runScMetaLink()`](https://Zaoqu-Liu.github.io/scMetaLink/reference/runScMetaLink.md)
  : Run Complete scMetaLink Analysis
- [`runScMetaLinkSeurat()`](https://Zaoqu-Liu.github.io/scMetaLink/reference/runScMetaLinkSeurat.md)
  : Run scMetaLink from Seurat Object

## Production Analysis

Infer metabolite production potential

- [`inferProduction()`](https://Zaoqu-Liu.github.io/scMetaLink/reference/inferProduction.md)
  : Infer Metabolite Production Potential
- [`getTopProducers()`](https://Zaoqu-Liu.github.io/scMetaLink/reference/getTopProducers.md)
  : Get Top Producing Cell Types for a Metabolite

## Sensing Analysis

Infer metabolite sensing capability

- [`inferSensing()`](https://Zaoqu-Liu.github.io/scMetaLink/reference/inferSensing.md)
  : Infer Metabolite Sensing Capability
- [`getTopSensors()`](https://Zaoqu-Liu.github.io/scMetaLink/reference/getTopSensors.md)
  : Get Top Sensing Cell Types for a Metabolite
- [`getMetaboliteReceptors()`](https://Zaoqu-Liu.github.io/scMetaLink/reference/getMetaboliteReceptors.md)
  : Get Receptors for a Metabolite

## Communication Analysis

Compute cell-cell communication scores

- [`computeCommunication()`](https://Zaoqu-Liu.github.io/scMetaLink/reference/computeCommunication.md)
  : Compute Metabolite-Mediated Cell Communication
- [`filterSignificantInteractions()`](https://Zaoqu-Liu.github.io/scMetaLink/reference/filterSignificantInteractions.md)
  : Filter Significant Interactions
- [`summarizeCommunicationPairs()`](https://Zaoqu-Liu.github.io/scMetaLink/reference/summarizeCommunicationPairs.md)
  : Summarize Communication by Cell Type Pairs
- [`getCommunicationMatrix()`](https://Zaoqu-Liu.github.io/scMetaLink/reference/getCommunicationMatrix.md)
  : Get Communication Summary Matrix
- [`compareCommunication()`](https://Zaoqu-Liu.github.io/scMetaLink/reference/compareCommunication.md)
  : Compare Two Conditions
- [`identifyCellTypeSpecificMetabolites()`](https://Zaoqu-Liu.github.io/scMetaLink/reference/identifyCellTypeSpecificMetabolites.md)
  : Identify Cell Type Specific Metabolites

## Spatial Analysis

Spatial transcriptomics support

- [`createScMetaLinkFromSpatial()`](https://Zaoqu-Liu.github.io/scMetaLink/reference/createScMetaLinkFromSpatial.md)
  : Create scMetaLink Object from Spatial Data
- [`createScMetaLinkFromSeuratSpatial()`](https://Zaoqu-Liu.github.io/scMetaLink/reference/createScMetaLinkFromSeuratSpatial.md)
  : Create scMetaLink from Seurat Spatial Object
- [`computeSpatialCommunication()`](https://Zaoqu-Liu.github.io/scMetaLink/reference/computeSpatialCommunication.md)
  : Compute Spatial Communication
- [`getSpatialDistanceStats()`](https://Zaoqu-Liu.github.io/scMetaLink/reference/getSpatialDistanceStats.md)
  : Get Spatial Distance Statistics
- [`identifyCommunicationHotspots()`](https://Zaoqu-Liu.github.io/scMetaLink/reference/identifyCommunicationHotspots.md)
  : Identify Communication Hotspots

## Spatial Visualization

Spatial plotting functions

- [`plotSpatialCellTypes()`](https://Zaoqu-Liu.github.io/scMetaLink/reference/plotSpatialCellTypes.md)
  : Plot Spatial Cell Types
- [`plotSpatialFeature()`](https://Zaoqu-Liu.github.io/scMetaLink/reference/plotSpatialFeature.md)
  : Plot Spatial Communication Heatmap
- [`plotSpatialCommunicationNetwork()`](https://Zaoqu-Liu.github.io/scMetaLink/reference/plotSpatialCommunicationNetwork.md)
  : Plot Spatial Communication Network
- [`plotSpatialDistanceDistribution()`](https://Zaoqu-Liu.github.io/scMetaLink/reference/plotSpatialDistanceDistribution.md)
  : Plot Spatial Distance Distribution
- [`plotSpatialHotspots()`](https://Zaoqu-Liu.github.io/scMetaLink/reference/plotSpatialHotspots.md)
  : Plot Spatial Hotspots
- [`plotSpatialComparison()`](https://Zaoqu-Liu.github.io/scMetaLink/reference/plotSpatialComparison.md)
  : Plot Spatial Communication Comparison

## Pathway Analysis

Pathway-level aggregation and enrichment

- [`aggregateByPathway()`](https://Zaoqu-Liu.github.io/scMetaLink/reference/aggregateByPathway.md)
  : Aggregate Communication by Pathway
- [`enrichPathways()`](https://Zaoqu-Liu.github.io/scMetaLink/reference/enrichPathways.md)
  : Pathway Enrichment Analysis
- [`getPathwayCommunicationMatrix()`](https://Zaoqu-Liu.github.io/scMetaLink/reference/getPathwayCommunicationMatrix.md)
  : Get Pathway Communication Matrix
- [`getPathwayMetabolites()`](https://Zaoqu-Liu.github.io/scMetaLink/reference/getPathwayMetabolites.md)
  : Get Metabolites in Pathway
- [`getPathwayMetaboliteNetwork()`](https://Zaoqu-Liu.github.io/scMetaLink/reference/getPathwayMetaboliteNetwork.md)
  : Get Pathway-Metabolite Network
- [`summarizePathwayActivity()`](https://Zaoqu-Liu.github.io/scMetaLink/reference/summarizePathwayActivity.md)
  : Summarize Pathway Activity
- [`listTopPathways()`](https://Zaoqu-Liu.github.io/scMetaLink/reference/listTopPathways.md)
  : List Top Pathways

## Visualization

General plotting functions

- [`plotCommunicationHeatmap()`](https://Zaoqu-Liu.github.io/scMetaLink/reference/plotCommunicationHeatmap.md)
  : Plot Communication Heatmap
- [`plotCommunicationCircle()`](https://Zaoqu-Liu.github.io/scMetaLink/reference/plotCommunicationCircle.md)
  : Plot Communication Circle
- [`plotCommunicationNetwork()`](https://Zaoqu-Liu.github.io/scMetaLink/reference/plotCommunicationNetwork.md)
  : Plot Communication Network
- [`plotMetaboliteProfile()`](https://Zaoqu-Liu.github.io/scMetaLink/reference/plotMetaboliteProfile.md)
  : Plot Metabolite Profile
- [`plotTopInteractions()`](https://Zaoqu-Liu.github.io/scMetaLink/reference/plotTopInteractions.md)
  : Plot Top Interactions
- [`plotPathwayCommunication()`](https://Zaoqu-Liu.github.io/scMetaLink/reference/plotPathwayCommunication.md)
  : Plot Pathway Communication
- [`plotDifferentialCommunication()`](https://Zaoqu-Liu.github.io/scMetaLink/reference/plotDifferentialCommunication.md)
  : Plot Differential Communication
- [`plotEnrichedPathways()`](https://Zaoqu-Liu.github.io/scMetaLink/reference/plotEnrichedPathways.md)
  : Plot Enriched Pathways

## Database Utilities

Functions to query MetalinksDB

- [`listMetabolites()`](https://Zaoqu-Liu.github.io/scMetaLink/reference/listMetabolites.md)
  : List Available Metabolites
- [`listGenes()`](https://Zaoqu-Liu.github.io/scMetaLink/reference/listGenes.md)
  : List Available Genes
- [`searchMetabolite()`](https://Zaoqu-Liu.github.io/scMetaLink/reference/searchMetabolite.md)
  : Search Metabolite in Database
- [`searchGene()`](https://Zaoqu-Liu.github.io/scMetaLink/reference/searchGene.md)
  : Search Gene in Database
- [`getDatabaseInfo()`](https://Zaoqu-Liu.github.io/scMetaLink/reference/getDatabaseInfo.md)
  : Get Database Information

## Export & Utilities

Export results and helper functions

- [`exportResults()`](https://Zaoqu-Liu.github.io/scMetaLink/reference/exportResults.md)
  : Export Results to CSV
- [`saveScMetaLink()`](https://Zaoqu-Liu.github.io/scMetaLink/reference/saveScMetaLink.md)
  : Save scMetaLink Object
- [`loadScMetaLink()`](https://Zaoqu-Liu.github.io/scMetaLink/reference/loadScMetaLink.md)
  : Load scMetaLink Object
- [`getSummaryStats()`](https://Zaoqu-Liu.github.io/scMetaLink/reference/getSummaryStats.md)
  : Get Summary Statistics
- [`citationScMetaLink()`](https://Zaoqu-Liu.github.io/scMetaLink/reference/citationScMetaLink.md)
  : Show Package Citation

## Data Accessors

S4 methods and class definition

- [`show(`*`<scMetaLink>`*`)`](https://Zaoqu-Liu.github.io/scMetaLink/reference/scMetaLink-class.md)
  : scMetaLink Class Definition
- [`getProductionScores()`](https://Zaoqu-Liu.github.io/scMetaLink/reference/accessors.md)
  [`getSensingScores()`](https://Zaoqu-Liu.github.io/scMetaLink/reference/accessors.md)
  [`getCommunicationScores()`](https://Zaoqu-Liu.github.io/scMetaLink/reference/accessors.md)
  [`getSignificantInteractions()`](https://Zaoqu-Liu.github.io/scMetaLink/reference/accessors.md)
  [`getPathwayAggregated()`](https://Zaoqu-Liu.github.io/scMetaLink/reference/accessors.md)
  [`getParameters()`](https://Zaoqu-Liu.github.io/scMetaLink/reference/accessors.md)
  : Accessor Functions for scMetaLink Objects

## Example Data

Built-in datasets for tutorials

- [`crc_expr`](https://Zaoqu-Liu.github.io/scMetaLink/reference/crc_expr.md)
  : CRC Example Expression Data
- [`crc_meta`](https://Zaoqu-Liu.github.io/scMetaLink/reference/crc_meta.md)
  : CRC Example Cell Metadata
- [`metalinksdb`](https://Zaoqu-Liu.github.io/scMetaLink/reference/metalinksdb.md)
  : MetalinksDB Database
- [`st_expr`](https://Zaoqu-Liu.github.io/scMetaLink/reference/st_expr.md)
  : Colon Spatial Transcriptomics Expression Data
- [`st_meta`](https://Zaoqu-Liu.github.io/scMetaLink/reference/st_meta.md)
  : Colon Spatial Transcriptomics Metadata
- [`st_scalefactors`](https://Zaoqu-Liu.github.io/scMetaLink/reference/st_scalefactors.md)
  : Colon Spatial Transcriptomics Scale Factors

## Package

Package documentation

- [`scMetaLink`](https://Zaoqu-Liu.github.io/scMetaLink/reference/scMetaLink-package.md)
  [`scMetaLink-package`](https://Zaoqu-Liu.github.io/scMetaLink/reference/scMetaLink-package.md)
  : scMetaLink: Single-Cell Metabolite-Mediated Cell Communication
  Analysis

# Articles

### Getting Started

- [Quick Start
  Guide](https://Zaoqu-Liu.github.io/scMetaLink/articles/quick-start.md):

### Methodology

- [Theory &
  Methods](https://Zaoqu-Liu.github.io/scMetaLink/articles/theory.md):

### Detailed Tutorials

- [Production & Sensing
  Analysis](https://Zaoqu-Liu.github.io/scMetaLink/articles/production-sensing.md):
- [Communication
  Analysis](https://Zaoqu-Liu.github.io/scMetaLink/articles/communication.md):
- [Spatial Transcriptomics
  Analysis](https://Zaoqu-Liu.github.io/scMetaLink/articles/spatial-analysis.md):
- [Visualization
  Gallery](https://Zaoqu-Liu.github.io/scMetaLink/articles/visualization.md):

### Applications

- [Application
  Examples](https://Zaoqu-Liu.github.io/scMetaLink/articles/applications.md):
