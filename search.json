[{"path":"https://Zaoqu-Liu.github.io/scMetaLink/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2026 Zaoqu Liu Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/applications.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"Application Examples","text":"tutorial demonstrates practical applications scMetaLink using colorectal cancer (CRC) example dataset. ’ll explore: Tumor metabolism communication Immune cell metabolic interactions Stromal-epithelial crosstalk Pathway-level analysis Hypothesis generation","code":"library(scMetaLink) library(Matrix)  # Load data and run full analysis data(crc_example)  # Check cell types available cat(\"Cell types in CRC dataset:\\n\") #> Cell types in CRC dataset: print(table(crc_meta$cell_type)) #>  #>                 B               CAF       Endothelial          Gliacyte  #>               150               200               100                20  #>              Mast          Monocyte Normal Epithelial Normal Fibroblast  #>                30               120               300               200  #> Normal Macrophage          Pericyte            Plasma               SMC  #>               150                50               250                30  #>                 T               TAM  Tumor Epithelial  #>               500               150               600"},{"path":[]},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/applications.html","id":"question-how-do-tumor-cells-communicate-with-their-microenvironment","dir":"Articles","previous_headings":"Application 1: Tumor Metabolic Communication","what":"Question: How do tumor cells communicate with their microenvironment?","title":"Application Examples","text":"","code":"# Run scMetaLink obj <- createScMetaLink(crc_expr, crc_meta, \"cell_type\") obj <- inferProduction(obj, verbose = FALSE) obj <- inferSensing(obj, verbose = FALSE) obj <- computeCommunication(obj, n_permutations = 100, verbose = FALSE) obj <- filterSignificantInteractions(obj, adjust_method = \"none\") # For demo  # Get significant interactions sig <- obj@significant_interactions  # Filter for tumor as sender or receiver tumor_types <- c(\"Tumor Epithelial\") tumor_sender <- sig[sig$sender %in% tumor_types, ] tumor_receiver <- sig[sig$receiver %in% tumor_types, ]  cat(\"Interactions with tumor cells:\\n\") #> Interactions with tumor cells: cat(\"  As sender:\", nrow(tumor_sender), \"\\n\") #>   As sender: 497 cat(\"  As receiver:\", nrow(tumor_receiver), \"\\n\") #>   As receiver: 391"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/applications.html","id":"tumor-outgoing-signals","dir":"Articles","previous_headings":"Application 1: Tumor Metabolic Communication","what":"Tumor Outgoing Signals","title":"Application Examples","text":"Figure 1: Tumor-Secreted Metabolites. Bar plot showing top metabolites produced tumor cells number different cell types sense metabolite.","code":"if (nrow(tumor_sender) > 0) {   # What metabolites do tumors secrete?   tumor_secreted <- table(tumor_sender$metabolite_name)   tumor_secreted <- sort(tumor_secreted, decreasing = TRUE)    par(mar = c(10, 4, 4, 2))   barplot(head(tumor_secreted, 15),     las = 2, col = \"#E57373\",     main = \"Metabolites Secreted by Tumor Cells\",     ylab = \"Number of Target Cell Types\"   ) }"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/applications.html","id":"tumor-incoming-signals","dir":"Articles","previous_headings":"Application 1: Tumor Metabolic Communication","what":"Tumor Incoming Signals","title":"Application Examples","text":"Figure 1b: Tumor-Sensed Metabolites. Top metabolites detected taken tumor cells. metabolites may provide nutrients signaling molecules support tumor growth.","code":"if (nrow(tumor_receiver) > 0) {   # What metabolites do tumors sense?   tumor_sensed <- table(tumor_receiver$metabolite_name)   tumor_sensed <- sort(tumor_sensed, decreasing = TRUE)    par(mar = c(10, 4, 4, 2))   barplot(head(tumor_sensed, 15),     las = 2, col = \"#64B5F6\",     main = \"Metabolites Sensed by Tumor Cells\",     ylab = \"Number of Source Cell Types\"   ) }"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/applications.html","id":"the-warburg-effect-lactate-signaling","dir":"Articles","previous_headings":"Application 1: Tumor Metabolic Communication","what":"The Warburg Effect: Lactate Signaling","title":"Application Examples","text":"Lactate hallmark metabolite Warburg effect cancer metabolism. Tumor cells produce excess lactate even presence oxygen. Figure 2: Lactate-Mediated Communication (Warburg Effect). Left: Cell types produce lactate. Right: Cell types sense/uptake lactate. Tumor cells typically major producers, immune cells important sensors. Biological Insight: Tumor cells often produce high levels lactate even presence oxygen (Warburg effect). lactate can modulate immune cell function promote tumor progression.","code":"# Lactate is a hallmark of tumor metabolism (Warburg effect) lactate_sig <- sig[sig$metabolite_name == \"L-Lactic acid\", ]  if (nrow(lactate_sig) > 0) {   cat(\"Lactate-mediated interactions:\", nrow(lactate_sig), \"\\n\\n\")    # Who produces lactate?   lactate_prod <- aggregate(communication_score ~ sender, data = lactate_sig, FUN = sum)   lactate_prod <- lactate_prod[order(-lactate_prod$communication_score), ]    # Who senses lactate?   lactate_sens <- aggregate(communication_score ~ receiver, data = lactate_sig, FUN = sum)   lactate_sens <- lactate_sens[order(-lactate_sens$communication_score), ]    par(mfrow = c(1, 2))   barplot(lactate_prod$communication_score,     names.arg = lactate_prod$sender,     las = 2, col = \"#FF8A65\", main = \"Lactate Producers\"   )   barplot(lactate_sens$communication_score,     names.arg = lactate_sens$receiver,     las = 2, col = \"#4FC3F7\", main = \"Lactate Sensors\"   )   par(mfrow = c(1, 1)) } #> Lactate-mediated interactions: 3"},{"path":[]},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/applications.html","id":"question-how-do-immune-cells-communicate-via-metabolites","dir":"Articles","previous_headings":"Application 2: Immune Cell Metabolic Interactions","what":"Question: How do immune cells communicate via metabolites?","title":"Application Examples","text":"","code":"# Define immune cell types immune_types <- c(\"T\", \"B\", \"Plasma\", \"TAM\", \"Monocyte\", \"Normal Macrophage\", \"Mast\")  # Filter for immune-immune interactions immune_sig <- sig[sig$sender %in% immune_types & sig$receiver %in% immune_types, ] cat(\"Immune-immune interactions:\", nrow(immune_sig), \"\\n\") #> Immune-immune interactions: 531"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/applications.html","id":"immune-communication-network","dir":"Articles","previous_headings":"Application 2: Immune Cell Metabolic Interactions","what":"Immune Communication Network","title":"Application Examples","text":"Figure 3: Immune Cell Communication Network. Heatmap showing metabolite-mediated communication strength immune cell types. T cells, macrophages, B cells often form key communication hubs.","code":"if (nrow(immune_sig) > 0) {   # Build communication matrix for immune cells   immune_cells <- unique(c(immune_sig$sender, immune_sig$receiver))   immune_mat <- matrix(0, length(immune_cells), length(immune_cells),     dimnames = list(immune_cells, immune_cells)   )    for (i in 1:nrow(immune_sig)) {     immune_mat[immune_sig$sender[i], immune_sig$receiver[i]] <-       immune_mat[immune_sig$sender[i], immune_sig$receiver[i]] +       immune_sig$communication_score[i]   }    heatmap(immune_mat,     col = hcl.colors(50, \"YlOrRd\"), scale = \"none\",     main = \"Immune Cell Metabolic Communication\"   ) }"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/applications.html","id":"macrophage-polarization-metabolites","dir":"Articles","previous_headings":"Application 2: Immune Cell Metabolic Interactions","what":"Macrophage Polarization Metabolites","title":"Application Examples","text":"","code":"# TAM (Tumor-Associated Macrophages) vs Normal Macrophages mac_types <- c(\"TAM\", \"Normal Macrophage\") mac_sig <- sig[sig$sender %in% mac_types | sig$receiver %in% mac_types, ]  if (nrow(mac_sig) > 0) {   # Compare metabolites   tam_mets <- mac_sig$metabolite_name[mac_sig$sender == \"TAM\" | mac_sig$receiver == \"TAM\"]   normal_mac_mets <- mac_sig$metabolite_name[mac_sig$sender == \"Normal Macrophage\" |     mac_sig$receiver == \"Normal Macrophage\"]    cat(\"TAM-associated metabolites:\", length(unique(tam_mets)), \"\\n\")   cat(\"Normal Macrophage-associated metabolites:\", length(unique(normal_mac_mets)), \"\\n\")    # Unique to each   tam_unique <- setdiff(unique(tam_mets), unique(normal_mac_mets))   normal_unique <- setdiff(unique(normal_mac_mets), unique(tam_mets))    cat(\"\\nUnique to TAM:\\n\")   print(head(tam_unique, 10))   cat(\"\\nUnique to Normal Macrophage:\\n\")   print(head(normal_unique, 10)) } #> TAM-associated metabolites: 207  #> Normal Macrophage-associated metabolites: 200  #>  #> Unique to TAM: #>  [1] \"Estriol\"                   \"Leukotriene C4\"            #>  [3] \"L-Lactic acid\"             \"Leukotriene E4\"            #>  [5] \"Lithocholyltaurine\"        \"5-HETE\"                    #>  [7] \"Gamma-linolenyl carnitine\" \"Vaccenyl carnitine\"        #>  [9] \"Arachidyl carnitine\"       \"Stearoylcarnitine\"         #>  #> Unique to Normal Macrophage: #>  [1] \"Cholic acid\"                     \"Hydrogen carbonate\"              #>  [3] \"L-Methionine\"                    \"13-cis-Retinoic acid\"            #>  [5] \"Calcitriol\"                      \"Liothyronine\"                    #>  [7] \"MG(0:0/20:4(5Z,8Z,11Z,14Z)/0:0)\" \"Formic acid\"                     #>  [9] \"Sulfate\"                         \"Prostaglandin F2a\""},{"path":[]},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/applications.html","id":"question-how-do-cafs-communicate-with-tumor-and-normal-epithelium","dir":"Articles","previous_headings":"Application 3: Stromal-Epithelial Crosstalk","what":"Question: How do CAFs communicate with tumor and normal epithelium?","title":"Application Examples","text":"","code":"# Define cell type groups stromal <- c(\"CAF\", \"Normal Fibroblast\", \"Pericyte\", \"SMC\", \"Endothelial\") epithelial <- c(\"Tumor Epithelial\", \"Normal Epithelial\")  # Stromal to epithelial stroma_to_epi <- sig[sig$sender %in% stromal & sig$receiver %in% epithelial, ] # Epithelial to stromal epi_to_stroma <- sig[sig$sender %in% epithelial & sig$receiver %in% stromal, ]  cat(\"Stromal -> Epithelial:\", nrow(stroma_to_epi), \"interactions\\n\") #> Stromal -> Epithelial: 173 interactions cat(\"Epithelial -> Stromal:\", nrow(epi_to_stroma), \"interactions\\n\") #> Epithelial -> Stromal: 311 interactions"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/applications.html","id":"caf-tumor-communication","dir":"Articles","previous_headings":"Application 3: Stromal-Epithelial Crosstalk","what":"CAF-Tumor Communication","title":"Application Examples","text":"Biological Insight: Cancer-Associated Fibroblasts (CAFs) can provide metabolic support tumor cells receive metabolic signals promote activation.","code":"caf_tumor <- sig[(sig$sender == \"CAF\" & sig$receiver == \"Tumor Epithelial\") |   (sig$sender == \"Tumor Epithelial\" & sig$receiver == \"CAF\"), ]  if (nrow(caf_tumor) > 0) {   cat(\"CAF-Tumor interactions:\", nrow(caf_tumor), \"\\n\\n\")    # Split by direction   caf_to_tumor <- caf_tumor[caf_tumor$sender == \"CAF\", ]   tumor_to_caf <- caf_tumor[caf_tumor$sender == \"Tumor Epithelial\", ]    par(mfrow = c(1, 2))    if (nrow(caf_to_tumor) > 0) {     caf_mets <- table(caf_to_tumor$metabolite_name)     barplot(sort(caf_mets, decreasing = TRUE),       las = 2, col = \"#A5D6A7\",       main = \"CAF -> Tumor\", cex.names = 0.7     )   }    if (nrow(tumor_to_caf) > 0) {     tumor_mets <- table(tumor_to_caf$metabolite_name)     barplot(sort(tumor_mets, decreasing = TRUE),       las = 2, col = \"#EF9A9A\",       main = \"Tumor -> CAF\", cex.names = 0.7     )   }    par(mfrow = c(1, 1)) } #> CAF-Tumor interactions: 106"},{"path":[]},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/applications.html","id":"question-which-metabolic-pathways-are-most-active-in-communication","dir":"Articles","previous_headings":"Application 4: Pathway-Level Analysis","what":"Question: Which metabolic pathways are most active in communication?","title":"Application Examples","text":"","code":"# Aggregate by pathway obj <- aggregateByPathway(obj)  # View pathway-level results pathway_data <- obj@pathway_aggregated  if (!is.null(pathway_data) && nrow(pathway_data) > 0) {   cat(\"Pathway analysis available\\n\")   cat(\"Number of pathway entries:\", nrow(pathway_data), \"\\n\")   cat(\"Unique pathways:\", length(unique(pathway_data$pathway)), \"\\n\") } #> Pathway analysis available #> Number of pathway entries: 5356  #> Unique pathways: 50"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/applications.html","id":"top-active-pathways","dir":"Articles","previous_headings":"Application 4: Pathway-Level Analysis","what":"Top Active Pathways","title":"Application Examples","text":"","code":"# Get pathway enrichment pathway_enrichment <- enrichPathways(obj)  if (!is.null(pathway_enrichment) && nrow(pathway_enrichment) > 0) {   # Top enriched pathways   top_pathways <- head(pathway_enrichment[order(pathway_enrichment$pvalue), ], 15)    par(mar = c(4, 15, 4, 2))   barplot(-log10(top_pathways$pvalue),     horiz = TRUE,     names.arg = top_pathways$pathway, las = 1,     col = \"#9575CD\", main = \"Enriched Metabolic Pathways\",     xlab = \"-log10(p-value)\"   )   abline(v = -log10(0.05), lty = 2, col = \"red\") }"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/applications.html","id":"specific-pathway-focus-amino-acid-metabolism","dir":"Articles","previous_headings":"Application 4: Pathway-Level Analysis","what":"Specific Pathway Focus: Amino Acid Metabolism","title":"Application Examples","text":"","code":"# Filter for amino acid-related metabolites amino_acids <- c(   \"L-Glutamic acid\", \"L-Glutamine\", \"L-Alanine\", \"Glycine\",   \"L-Serine\", \"L-Proline\", \"L-Aspartic acid\", \"L-Arginine\",   \"L-Leucine\", \"L-Isoleucine\", \"L-Valine\", \"L-Tryptophan\" )  aa_sig <- sig[sig$metabolite_name %in% amino_acids, ] cat(\"Amino acid-mediated interactions:\", nrow(aa_sig), \"\\n\") #> Amino acid-mediated interactions: 136  if (nrow(aa_sig) > 0) {   # Which amino acids are most involved?   aa_counts <- table(aa_sig$metabolite_name)   aa_counts <- sort(aa_counts, decreasing = TRUE)    barplot(aa_counts,     las = 2, col = \"#FFB74D\",     main = \"Amino Acid Communication\",     ylab = \"Number of Interactions\"   ) }"},{"path":[]},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/applications.html","id":"identifying-novel-communication-axes","dir":"Articles","previous_headings":"Application 5: Hypothesis Generation","what":"Identifying Novel Communication Axes","title":"Application Examples","text":"","code":"# Find unexpected interactions (high score, unique combinations) sig_sorted <- sig[order(-sig$communication_score), ]  cat(\"=== Top Novel Communication Axes ===\\n\\n\") #> === Top Novel Communication Axes ===  # Show top interactions with context for (i in 1:min(10, nrow(sig_sorted))) {   row <- sig_sorted[i, ]   cat(sprintf(\"%d. %s -> %s via %s\\n\", i, row$sender, row$receiver, row$metabolite_name))   cat(sprintf(     \"   Score: %.3f, Adjusted p-value: %.4f\\n\\n\",     row$communication_score, row$pvalue_adjusted   )) } #> 1. Monocyte -> Mast via Epinephrine #>    Score: 1.000, Adjusted p-value: 0.0099 #>  #> 2. Normal Epithelial -> Plasma via 5-Androstenediol #>    Score: 0.999, Adjusted p-value: 0.0099 #>  #> 3. Endothelial -> Mast via Prostaglandin F1a #>    Score: 0.990, Adjusted p-value: 0.0099 #>  #> 4. Gliacyte -> B via 12-Keto-leukotriene B4 #>    Score: 0.986, Adjusted p-value: 0.0099 #>  #> 5. Plasma -> Plasma via Estriol #>    Score: 0.982, Adjusted p-value: 0.0099 #>  #> 6. Normal Macrophage -> T via Cholesterol sulfate #>    Score: 0.977, Adjusted p-value: 0.0099 #>  #> 7. Tumor Epithelial -> B via Stearoylethanolamide #>    Score: 0.975, Adjusted p-value: 0.0099 #>  #> 8. Monocyte -> B via L-Lactic acid #>    Score: 0.968, Adjusted p-value: 0.0099 #>  #> 9. Endothelial -> CAF via Prostaglandin F2a #>    Score: 0.966, Adjusted p-value: 0.0099 #>  #> 10. Tumor Epithelial -> Plasma via 16a-Hydroxyestrone #>    Score: 0.956, Adjusted p-value: 0.0099"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/applications.html","id":"autocrine-signaling","dir":"Articles","previous_headings":"Application 5: Hypothesis Generation","what":"Autocrine Signaling","title":"Application Examples","text":"","code":"# Cells signaling to themselves autocrine <- sig[sig$sender == sig$receiver, ] cat(\"Autocrine interactions:\", nrow(autocrine), \"\\n\\n\") #> Autocrine interactions: 213  if (nrow(autocrine) > 0) {   # Which cell types have autocrine signaling?   auto_counts <- table(autocrine$sender)    barplot(sort(auto_counts, decreasing = TRUE),     las = 2, col = \"#81D4FA\",     main = \"Autocrine Metabolite Signaling\",     ylab = \"Number of Autocrine Interactions\"   )    # What metabolites are involved in autocrine signaling?   cat(\"\\nTop autocrine metabolites:\\n\")   print(head(sort(table(autocrine$metabolite_name), decreasing = TRUE), 10)) } #>  #> Top autocrine metabolites: #>  #>                      Acetaldehyde                   Androstenedione  #>                                 3                                 3  #>                         L-Proline                    Leukotriene A4  #>                                 3                                 3  #>                      Progesterone        11beta-Hydroxyprogesterone  #>                                 3                                 2  #> 16a-Hydroxydehydroisoandrosterone      2-Arachidonyl Glycerol ether  #>                                 2                                 2  #>            22b-Hydroxycholesterol                  4-Hydroxynonenal  #>                                 2                                 2"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/applications.html","id":"hub-cell-types","dir":"Articles","previous_headings":"Application 5: Hypothesis Generation","what":"Hub Cell Types","title":"Application Examples","text":"","code":"# Which cell types are communication hubs? cell_types <- unique(c(sig$sender, sig$receiver))  hub_stats <- data.frame(   cell_type = cell_types,   out_degree = sapply(cell_types, function(ct) length(unique(sig$receiver[sig$sender == ct]))),   in_degree = sapply(cell_types, function(ct) length(unique(sig$sender[sig$receiver == ct]))),   out_strength = sapply(cell_types, function(ct) sum(sig$communication_score[sig$sender == ct])),   in_strength = sapply(cell_types, function(ct) sum(sig$communication_score[sig$receiver == ct])) ) hub_stats$total_degree <- hub_stats$out_degree + hub_stats$in_degree hub_stats <- hub_stats[order(-hub_stats$total_degree), ]  cat(\"=== Communication Hub Analysis ===\\n\") #> === Communication Hub Analysis === print(hub_stats) #>                           cell_type out_degree in_degree out_strength #> Normal Epithelial Normal Epithelial         15        15    274.94376 #> Endothelial             Endothelial         15        15     97.69638 #> Plasma                       Plasma         15        15     81.42825 #> Normal Macrophage Normal Macrophage         15        15    148.36082 #> Tumor Epithelial   Tumor Epithelial         15        15    311.72322 #> Pericyte                   Pericyte         15        15    113.00079 #> CAF                             CAF         15        15    134.26134 #> Normal Fibroblast Normal Fibroblast         15        14    151.78725 #> TAM                             TAM         14        15    130.41822 #> T                                 T         14        15     86.71780 #> Monocyte                   Monocyte         13        15     51.48416 #> B                                 B         13        15     45.08255 #> Mast                           Mast         15        12     51.42597 #> Gliacyte                   Gliacyte         13        12     52.71885 #> SMC                             SMC         12        11     33.22659 #>                   in_strength total_degree #> Normal Epithelial    67.84414           30 #> Endothelial          58.91013           30 #> Plasma               80.31860           30 #> Normal Macrophage   302.40475           30 #> Tumor Epithelial    240.96658           30 #> Pericyte            106.76955           30 #> CAF                 136.64635           30 #> Normal Fibroblast   148.94226           29 #> TAM                 228.65835           29 #> T                   144.36241           29 #> Monocyte             63.43905           28 #> B                    80.18010           28 #> Mast                 36.83130           27 #> Gliacyte             48.88093           25 #> SMC                  19.12146           23  # Visualize par(mfrow = c(1, 2)) plot(hub_stats$out_strength, hub_stats$in_strength,   pch = 19, cex = 2, col = \"#1976D2\",   xlab = \"Outgoing Strength\", ylab = \"Incoming Strength\",   main = \"Cell Type Communication Profile\" ) text(hub_stats$out_strength, hub_stats$in_strength,   hub_stats$cell_type,   pos = 3, cex = 0.7 ) abline(0, 1, lty = 2, col = \"gray\")  # Degree distribution barplot(hub_stats$total_degree,   names.arg = hub_stats$cell_type,   las = 2, col = \"#4CAF50\", main = \"Communication Degree\" ) par(mfrow = c(1, 1))"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/applications.html","id":"summary-key-findings-from-crc-analysis","dir":"Articles","previous_headings":"","what":"Summary: Key Findings from CRC Analysis","title":"Application Examples","text":"","code":"cat(\"=== Analysis Summary ===\\n\\n\") #> === Analysis Summary === cat(\"Dataset: Colorectal Cancer Single-Cell Data\\n\") #> Dataset: Colorectal Cancer Single-Cell Data cat(\"Cells:\", ncol(crc_expr), \"\\n\") #> Cells: 2850 cat(\"Cell Types:\", length(unique(crc_meta$cell_type)), \"\\n\") #> Cell Types: 15 cat(\"Significant Interactions:\", nrow(sig), \"\\n\") #> Significant Interactions: 2754 cat(\"Metabolites Involved:\", length(unique(sig$metabolite_name)), \"\\n\\n\") #> Metabolites Involved: 277  cat(\"Key Observations:\\n\") #> Key Observations: cat(\"1. Tumor cells are active metabolic communicators\\n\") #> 1. Tumor cells are active metabolic communicators cat(\"2. Lactate (Warburg effect) mediates tumor-stroma crosstalk\\n\") #> 2. Lactate (Warburg effect) mediates tumor-stroma crosstalk cat(\"3. Immune cells form a metabolic communication network\\n\") #> 3. Immune cells form a metabolic communication network cat(\"4. CAF-tumor axis shows bidirectional signaling\\n\") #> 4. CAF-tumor axis shows bidirectional signaling cat(\"5. Amino acid metabolism is highly connected\\n\") #> 5. Amino acid metabolism is highly connected"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/applications.html","id":"export-results-for-further-analysis","dir":"Articles","previous_headings":"","what":"Export Results for Further Analysis","title":"Application Examples","text":"","code":"# Export all results exportResults(obj, output_dir = \"scMetaLink_CRC_results\")  # Export specific tables write.csv(sig, \"significant_interactions.csv\", row.names = FALSE) write.csv(hub_stats, \"cell_type_hub_analysis.csv\", row.names = FALSE)"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/applications.html","id":"session-info","dir":"Articles","previous_headings":"","what":"Session Info","title":"Application Examples","text":"","code":"sessionInfo() #> R version 4.5.2 (2025-10-31) #> Platform: x86_64-pc-linux-gnu #> Running under: Ubuntu 24.04.3 LTS #>  #> Matrix products: default #> BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3  #> LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0 #>  #> locale: #>  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        #>  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    #>  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           #> [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    #>  #> time zone: UTC #> tzcode source: system (glibc) #>  #> attached base packages: #> [1] stats     graphics  grDevices utils     datasets  methods   base      #>  #> other attached packages: #> [1] Matrix_1.7-4      scMetaLink_0.99.0 #>  #> loaded via a namespace (and not attached): #>  [1] gtable_0.3.6       jsonlite_2.0.0     dplyr_1.1.4        compiler_4.5.2     #>  [5] tidyselect_1.2.1   jquerylib_0.1.4    systemfonts_1.3.1  scales_1.4.0       #>  [9] textshaping_1.0.4  yaml_2.3.12        fastmap_1.2.0      lattice_0.22-7     #> [13] ggplot2_4.0.1      R6_2.6.1           generics_0.1.4     knitr_1.51         #> [17] htmlwidgets_1.6.4  tibble_3.3.1       desc_1.4.3         bslib_0.9.0        #> [21] pillar_1.11.1      RColorBrewer_1.1-3 rlang_1.1.7        cachem_1.1.0       #> [25] xfun_0.56          fs_1.6.6           sass_0.4.10        S7_0.2.1           #> [29] otel_0.2.0         cli_3.6.5          pkgdown_2.2.0      magrittr_2.0.4     #> [33] digest_0.6.39      grid_4.5.2         lifecycle_1.0.5    vctrs_0.7.0        #> [37] evaluate_1.0.5     glue_1.8.0         farver_2.1.2       ragg_1.5.0         #> [41] rmarkdown_2.30     tools_4.5.2        pkgconfig_2.0.3    htmltools_0.5.9"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/communication.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"Communication Analysis","text":"tutorial covers communication analysis step, production sensing scores combined quantify cell-cell communication via metabolites.","code":"library(scMetaLink) library(Matrix)  # Load and prepare data data(crc_example) obj <- createScMetaLink(crc_expr, crc_meta, \"cell_type\") obj <- inferProduction(obj, verbose = FALSE) obj <- inferSensing(obj, verbose = FALSE)"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/communication.html","id":"understanding-communication-scores","dir":"Articles","previous_headings":"","what":"Understanding Communication Scores","title":"Communication Analysis","text":"Communication sender receiver via metabolite:","code":"Sender Cell ──[Production]──▶ Metabolite ──[Sensing]──▶ Receiver Cell      │                            │                           │      │                            │                           │      ▼                            ▼                           ▼   MPP(m,s)         ----->   Comm(s->r,m)   <-----         MSC(m,r)"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/communication.html","id":"the-computecommunication-function","dir":"Articles","previous_headings":"","what":"The computeCommunication() Function","title":"Communication Analysis","text":"","code":"obj <- computeCommunication(   obj,   method = \"geometric\", # How to combine production and sensing   min_production = 0.1, # Minimum production threshold   min_sensing = 0.1, # Minimum sensing threshold   population.size = FALSE, # Weight by cell type abundance   n_permutations = 100, # Permutations for significance   n_cores = 1, # Parallel cores   seed = 42, # Reproducibility   verbose = TRUE ) #>   |                                                                              |                                                                      |   0%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |===                                                                   |   4%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |========                                                              |  11%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |==========                                                            |  14%  |                                                                              |==========                                                            |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  17%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |===============                                                       |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  23%  |                                                                              |=================                                                     |  24%  |                                                                              |==================                                                    |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |====================                                                  |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |========================                                              |  34%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |===========================                                           |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  40%  |                                                                              |=============================                                         |  41%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |===============================                                       |  44%  |                                                                              |================================                                      |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |==================================                                    |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |====================================                                  |  51%  |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |======================================                                |  54%  |                                                                              |======================================                                |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  57%  |                                                                              |=========================================                             |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |===========================================                           |  61%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  63%  |                                                                              |=============================================                         |  64%  |                                                                              |==============================================                        |  65%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |==================================================                    |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |====================================================                  |  74%  |                                                                              |====================================================                  |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  77%  |                                                                              |=======================================================               |  78%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  80%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |===========================================================           |  84%  |                                                                              |============================================================          |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |==============================================================        |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================| 100%"},{"path":[]},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/communication.html","id":"method-combining-production-and-sensing","dir":"Articles","previous_headings":"The computeCommunication() Function > Parameter Deep Dive","what":"1. method: Combining Production and Sensing","title":"Communication Analysis","text":"Three methods compute communication score: Figure 1: Communication Score Method Comparison. Heatmaps showing total communication strength cell types using different aggregation methods. Geometric mean (default) provides balanced weighting, product emphasizes strong bilateral signals, harmonic mean penalizes imbalanced communication. Method recommendations:","code":"# Run with different methods obj_geom <- computeCommunication(obj, method = \"geometric\", n_permutations = 0, verbose = FALSE) obj_prod <- computeCommunication(obj, method = \"product\", n_permutations = 0, verbose = FALSE) obj_harm <- computeCommunication(obj, method = \"harmonic\", n_permutations = 0, verbose = FALSE)  # Compare total communication strength par(mfrow = c(1, 3))  total_geom <- apply(obj_geom@communication_scores, c(1, 2), sum) total_prod <- apply(obj_prod@communication_scores, c(1, 2), sum) total_harm <- apply(obj_harm@communication_scores, c(1, 2), sum)  image(total_geom,   main = \"Geometric: sqrt(PxS)\", col = hcl.colors(50, \"YlOrRd\"),   axes = FALSE ) image(total_prod,   main = \"Product: PxS\", col = hcl.colors(50, \"YlOrRd\"),   axes = FALSE ) image(total_harm,   main = \"Harmonic: 2PS/(P+S)\", col = hcl.colors(50, \"YlOrRd\"),   axes = FALSE ) par(mfrow = c(1, 1))"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/communication.html","id":"min_production-and-min_sensing-noise-filtering","dir":"Articles","previous_headings":"The computeCommunication() Function > Parameter Deep Dive","what":"2. min_production and min_sensing: Noise Filtering","title":"Communication Analysis","text":"Figure 2: Effect Expression Thresholds. Higher thresholds reduce number detected interactions requiring stronger production sensing signals. Choose based desired stringency. Guidelines: - 0.1: Default, moderate filtering - 0.05: permissive, may include noise - 0.2-0.3: stringent, focused analysis","code":"# Compare different thresholds thresholds <- c(0.05, 0.1, 0.2, 0.3) n_interactions <- sapply(thresholds, function(t) {   obj_t <- computeCommunication(obj,     min_production = t, min_sensing = t,     n_permutations = 0, verbose = FALSE   )   sum(obj_t@communication_scores > 0) })  barplot(n_interactions,   names.arg = thresholds,   xlab = \"Threshold (min_production = min_sensing)\",   ylab = \"Number of Non-zero Interactions\",   main = \"Effect of Thresholds on Detected Interactions\",   col = \"#64B5F6\" )"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/communication.html","id":"population-size-cell-type-abundance-weighting","dir":"Articles","previous_headings":"The computeCommunication() Function > Parameter Deep Dive","what":"3. population.size: Cell Type Abundance Weighting","title":"Communication Analysis","text":"enabled, communication weighted cell type abundance: Commweighted=Comm×nsenderN×nreceiverN\\text{Comm}_{\\text{weighted}} = \\text{Comm} \\times \\sqrt{\\frac{n_{\\text{sender}}}{N} \\times \\frac{n_{\\text{receiver}}}{N}} use population.size = TRUE: - Tissue-level signaling analysis - abundant cell types influence - Comparing communication strength across tissues use population.size = FALSE: - Cell type potential analysis (independent abundance) - Comparing rare vs common cell types fairly","code":"# Compare with and without population size correction obj_no_pop <- computeCommunication(obj,   population.size = FALSE,   n_permutations = 0, verbose = FALSE ) obj_with_pop <- computeCommunication(obj,   population.size = TRUE,   n_permutations = 0, verbose = FALSE )  # Total communication per cell type pair total_no_pop <- apply(obj_no_pop@communication_scores, c(1, 2), sum) total_with_pop <- apply(obj_with_pop@communication_scores, c(1, 2), sum)  cat(\"Without population size correction:\\n\") #> Without population size correction: print(round(total_no_pop[1:5, 1:5], 3)) #>                    receiver #> sender              Normal Epithelial       T Plasma Normal Fibroblast     CAF #>   Normal Epithelial            95.343 105.704 90.919           120.128 119.573 #>   T                            83.677  94.382 80.301           105.682 105.110 #>   Plasma                       83.028  93.692 80.557           104.482 103.873 #>   Normal Fibroblast            91.996 102.945 87.495           114.784 114.247 #>   CAF                          91.263 101.869 86.869           113.753 113.273  cat(\"\\nWith population size correction:\\n\") #>  #> With population size correction: print(round(total_with_pop[1:5, 1:5], 3)) #>                    receiver #> sender              Normal Epithelial      T Plasma Normal Fibroblast    CAF #>   Normal Epithelial            10.036 14.365  8.737            10.325 10.277 #>   T                            11.371 16.558  9.962            11.726 11.663 #>   Plasma                        7.978 11.623  7.066             8.197  8.150 #>   Normal Fibroblast             7.907 11.422  6.865             8.055  8.017 #>   CAF                           7.844 11.303  6.816             7.983  7.949  # Show cell type sizes cat(\"\\nCell type counts:\\n\") #>  #> Cell type counts: print(table(crc_meta$cell_type)) #>  #>                 B               CAF       Endothelial          Gliacyte  #>               150               200               100                20  #>              Mast          Monocyte Normal Epithelial Normal Fibroblast  #>                30               120               300               200  #> Normal Macrophage          Pericyte            Plasma               SMC  #>               150                50               250                30  #>                 T               TAM  Tumor Epithelial  #>               500               150               600"},{"path":[]},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/communication.html","id":"permutation-test","dir":"Articles","previous_headings":"Statistical Significance Testing","what":"Permutation Test","title":"Communication Analysis","text":"Figure 3: P-value Distribution Permutation Test. Histogram p-values 100 permutations. uniform distribution null expected; enrichment near 0 indicates true signals. Red line marks significance threshold (p=0.05).","code":"# Run with permutation test obj <- computeCommunication(obj, n_permutations = 100, verbose = TRUE) #>   |                                                                              |                                                                      |   0%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |===                                                                   |   4%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |========                                                              |  11%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |==========                                                            |  14%  |                                                                              |==========                                                            |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  17%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |===============                                                       |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  23%  |                                                                              |=================                                                     |  24%  |                                                                              |==================                                                    |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |====================                                                  |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |========================                                              |  34%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |===========================                                           |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  40%  |                                                                              |=============================                                         |  41%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |===============================                                       |  44%  |                                                                              |================================                                      |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |==================================                                    |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |====================================                                  |  51%  |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |======================================                                |  54%  |                                                                              |======================================                                |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  57%  |                                                                              |=========================================                             |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |===========================================                           |  61%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  63%  |                                                                              |=============================================                         |  64%  |                                                                              |==============================================                        |  65%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |==================================================                    |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |====================================================                  |  74%  |                                                                              |====================================================                  |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  77%  |                                                                              |=======================================================               |  78%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  80%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |===========================================================           |  84%  |                                                                              |============================================================          |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |==============================================================        |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================| 100%  # Check p-value distribution pvals <- as.vector(obj@communication_pvalues) hist(pvals,   breaks = 50, main = \"P-value Distribution\",   xlab = \"P-value\", col = \"#90CAF9\", border = \"white\" ) abline(v = 0.05, col = \"red\", lwd = 2, lty = 2) text(0.1, par(\"usr\")[4] * 0.9, \"p = 0.05\", col = \"red\")"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/communication.html","id":"multiple-testing-correction","dir":"Articles","previous_headings":"Statistical Significance Testing","what":"Multiple Testing Correction","title":"Communication Analysis","text":"Different correction methods vary stringency. limited permutations (tutorial), p-value correction may result zero significant interactions: Note: real analysis sufficient permutations (>1000), BH correction recommended. demonstration purposes limited permutations, use adjustment.","code":"# Different correction methods - show counts obj_none <- filterSignificantInteractions(obj, adjust_method = \"none\") obj_bh <- filterSignificantInteractions(obj, adjust_method = \"BH\")  cat(\"Significant interactions by correction method:\\n\") #> Significant interactions by correction method: cat(\"  No correction:\", nrow(obj_none@significant_interactions), \"\\n\") #>   No correction: 2754 cat(\"  BH correction:\", nrow(obj_bh@significant_interactions), \"\\n\") #>   BH correction: 0"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/communication.html","id":"filtering-significant-interactions","dir":"Articles","previous_headings":"","what":"Filtering Significant Interactions","title":"Communication Analysis","text":"","code":"# For this tutorial, use no adjustment to demonstrate the workflow # In real analysis, use adjust_method = \"BH\" with more permutations obj <- filterSignificantInteractions(   obj,   pvalue_threshold = 0.05, # Significance level   adjust_method = \"none\", # Use \"BH\" for real analysis   min_score = 0 # Minimum communication score )  # View results cat(\"Total significant interactions:\", nrow(obj@significant_interactions), \"\\n\\n\") #> Total significant interactions: 2754 cat(\"Top interactions:\\n\") #> Top interactions: head(obj@significant_interactions[, c(   \"sender\", \"receiver\", \"metabolite_name\",   \"communication_score\", \"pvalue_adjusted\" )]) #>              sender receiver        metabolite_name communication_score #> 1          Monocyte     Mast            Epinephrine           0.9999641 #> 2 Normal Epithelial   Plasma       5-Androstenediol           0.9992733 #> 3       Endothelial     Mast      Prostaglandin F1a           0.9903007 #> 4          Gliacyte        B 12-Keto-leukotriene B4           0.9862472 #> 5            Plasma   Plasma                Estriol           0.9822572 #> 6 Normal Macrophage        T    Cholesterol sulfate           0.9768051 #>   pvalue_adjusted #> 1      0.00990099 #> 2      0.00990099 #> 3      0.00990099 #> 4      0.00990099 #> 5      0.00990099 #> 6      0.00990099"},{"path":[]},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/communication.html","id":"communication-score-structure","dir":"Articles","previous_headings":"Exploring Communication Results","what":"Communication Score Structure","title":"Communication Analysis","text":"","code":"# The communication_scores slot is a 3D array comm <- obj@communication_scores cat(\"Dimensions: sender x receiver x metabolite\\n\") #> Dimensions: sender x receiver x metabolite cat(dim(comm), \"\\n\") #> 15 15 286 cat(\"\\nCell types:\", dimnames(comm)[[1]], \"\\n\") #>  #> Cell types: Normal Epithelial T Plasma Normal Fibroblast CAF Normal Macrophage TAM B Monocyte Endothelial Pericyte SMC Mast Gliacyte Tumor Epithelial cat(\"\\nMetabolites (first 10):\", head(dimnames(comm)[[3]], 10), \"\\n\") #>  #> Metabolites (first 10): HMDB0000010 HMDB0000011 HMDB0000015 HMDB0000016 HMDB0000031 HMDB0000034 HMDB0000036 HMDB0000039 HMDB0000042 HMDB0000045"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/communication.html","id":"summarizing-by-cell-type-pairs","dir":"Articles","previous_headings":"Exploring Communication Results","what":"Summarizing by Cell Type Pairs","title":"Communication Analysis","text":"","code":"# Different aggregation methods sum_result <- summarizeCommunicationPairs(obj, aggregate_method = \"sum\") mean_result <- summarizeCommunicationPairs(obj, aggregate_method = \"mean\") count_result <- summarizeCommunicationPairs(obj, aggregate_method = \"count\")  cat(\"=== Sum of Communication Scores ===\\n\") #> === Sum of Communication Scores === head(sum_result) #>                sender          receiver communication_score #> 128  Tumor Epithelial Normal Macrophage            52.63050 #> 199  Tumor Epithelial               TAM            51.99507 #> 191 Normal Epithelial               TAM            44.71782 #> 120 Normal Epithelial Normal Macrophage            43.56831 #> 106 Normal Epithelial Normal Fibroblast            40.51663 #> 30   Tumor Epithelial               CAF            37.72378  cat(\"\\n=== Mean Communication Score ===\\n\") #>  #> === Mean Communication Score === head(mean_result) #>          sender receiver communication_score #> 59  Endothelial     Mast           0.9903007 #> 62     Monocyte     Mast           0.8563538 #> 60     Gliacyte     Mast           0.8530255 #> 66     Pericyte     Mast           0.8407588 #> 132    Gliacyte Pericyte           0.8334445 #> 52     Pericyte Gliacyte           0.8238465  cat(\"\\n=== Number of Significant Interactions ===\\n\") #>  #> === Number of Significant Interactions === head(count_result) #>                sender          receiver n_interactions #> 128  Tumor Epithelial Normal Macrophage             82 #> 199  Tumor Epithelial               TAM             80 #> 106 Normal Epithelial Normal Fibroblast             69 #> 30   Tumor Epithelial               CAF             67 #> 113  Tumor Epithelial Normal Fibroblast             65 #> 191 Normal Epithelial               TAM             63"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/communication.html","id":"get-communication-matrix","dir":"Articles","previous_headings":"Exploring Communication Results","what":"Get Communication Matrix","title":"Communication Analysis","text":"Figure 7: Cell-Cell Communication Matrix. Aggregated communication strength cell type pairs. Rows represent senders, columns represent receivers. Clustering groups cell types similar communication patterns.","code":"# Get aggregated communication matrix comm_mat <- getCommunicationMatrix(obj, aggregate_method = \"sum\")  # Visualize heatmap(comm_mat,   col = hcl.colors(50, \"Reds\"),   scale = \"none\",   main = \"Cell-Cell Communication Strength\" )"},{"path":[]},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/communication.html","id":"top-communicating-pairs","dir":"Articles","previous_headings":"Analyzing Specific Interactions","what":"Top Communicating Pairs","title":"Communication Analysis","text":"","code":"sig <- obj@significant_interactions  # Top sender-receiver pairs pair_counts <- aggregate(communication_score ~ sender + receiver, data = sig, FUN = length) names(pair_counts)[3] <- \"n_metabolites\" pair_counts <- pair_counts[order(-pair_counts$n_metabolites), ]  cat(\"Top communicating cell type pairs:\\n\") #> Top communicating cell type pairs: head(pair_counts, 10) #>                sender          receiver n_metabolites #> 128  Tumor Epithelial Normal Macrophage            82 #> 199  Tumor Epithelial               TAM            80 #> 106 Normal Epithelial Normal Fibroblast            69 #> 30   Tumor Epithelial               CAF            67 #> 113  Tumor Epithelial Normal Fibroblast            65 #> 191 Normal Epithelial               TAM            63 #> 120 Normal Epithelial Normal Macrophage            61 #> 214  Tumor Epithelial  Tumor Epithelial            58 #> 22  Normal Epithelial               CAF            57 #> 123          Pericyte Normal Macrophage            47"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/communication.html","id":"top-metabolite-mediators","dir":"Articles","previous_headings":"Analyzing Specific Interactions","what":"Top Metabolite Mediators","title":"Communication Analysis","text":"","code":"# Most frequent metabolites in significant interactions met_counts <- table(sig$metabolite_name) met_counts <- sort(met_counts, decreasing = TRUE)  cat(\"Top metabolite mediators:\\n\") #> Top metabolite mediators: head(met_counts, 15) #>  #> 11beta-Hydroxyprogesterone           5-Androstenediol  #>                         30                         23  #>                  Ornithine   7beta-Hydroxycholesterol  #>                         21                         20  #>    Adenosine monophosphate                  Cortisone  #>                         19                         19  #>                  Hydroxide                    Retinal  #>                         19                         18  #>                   L-Fucose     Uridine 5'-diphosphate  #>                         17                         17  #>                Cholesterol                   Cortisol  #>                         16                         16  #>                    Glycine             Hyocholic acid  #>                         16                         16  #>                  L-Proline  #>                         16"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/communication.html","id":"specific-pathway-focus","dir":"Articles","previous_headings":"Analyzing Specific Interactions","what":"Specific Pathway Focus","title":"Communication Analysis","text":"","code":"# Filter for specific metabolites (e.g., amino acids) amino_acids <- c(   \"L-Glutamic acid\", \"L-Glutamine\", \"L-Alanine\", \"Glycine\",   \"L-Serine\", \"L-Proline\", \"L-Aspartic acid\" )  aa_interactions <- sig[sig$metabolite_name %in% amino_acids, ] cat(\"Amino acid-mediated interactions:\", nrow(aa_interactions), \"\\n\\n\") #> Amino acid-mediated interactions: 90  if (nrow(aa_interactions) > 0) {   # Summarize   aa_summary <- aggregate(communication_score ~ sender + receiver + metabolite_name,     data = aa_interactions, FUN = sum   )   aa_summary <- aa_summary[order(-aa_summary$communication_score), ]   head(aa_summary, 10) } #>               sender          receiver metabolite_name communication_score #> 32          Gliacyte  Tumor Epithelial L-Aspartic acid           0.8443290 #> 19 Normal Macrophage Normal Macrophage       L-Alanine           0.8136641 #> 75                 T            Plasma       L-Proline           0.8016842 #> 22               TAM Normal Macrophage       L-Alanine           0.7858833 #> 3  Normal Macrophage       Endothelial         Glycine           0.7542903 #> 57 Normal Macrophage               CAF     L-Glutamine           0.7450304 #> 60               TAM               CAF     L-Glutamine           0.7300418 #> 74            Plasma            Plasma       L-Proline           0.7230354 #> 62 Normal Macrophage Normal Fibroblast     L-Glutamine           0.7166993 #> 6                TAM       Endothelial         Glycine           0.7160865"},{"path":[]},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/communication.html","id":"outgoing-communication-as-sender","dir":"Articles","previous_headings":"Advanced: Directional Analysis","what":"Outgoing Communication (as Sender)","title":"Communication Analysis","text":"Figure 4: Outgoing Communication Strength. Total communication scores cell type acting sender. Higher values indicate cell types produce metabolites intercellular signaling.","code":"# Which cell types send the most signals? outgoing <- aggregate(communication_score ~ sender, data = sig, FUN = sum) outgoing <- outgoing[order(-outgoing$communication_score), ]  barplot(outgoing$communication_score,   names.arg = outgoing$sender,   las = 2, col = \"#FF7043\",   main = \"Outgoing Communication Strength\",   ylab = \"Total Communication Score\" )"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/communication.html","id":"incoming-communication-as-receiver","dir":"Articles","previous_headings":"Advanced: Directional Analysis","what":"Incoming Communication (as Receiver)","title":"Communication Analysis","text":"Figure 5: Incoming Communication Strength. Total communication scores cell type acting receiver. Higher values indicate cell types sense/uptake metabolites cells.","code":"# Which cell types receive the most signals? incoming <- aggregate(communication_score ~ receiver, data = sig, FUN = sum) incoming <- incoming[order(-incoming$communication_score), ]  barplot(incoming$communication_score,   names.arg = incoming$receiver,   las = 2, col = \"#42A5F5\",   main = \"Incoming Communication Strength\",   ylab = \"Total Communication Score\" )"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/communication.html","id":"net-communication-flow","dir":"Articles","previous_headings":"Advanced: Directional Analysis","what":"Net Communication Flow","title":"Communication Analysis","text":"Figure 6: Net Communication Flow. Difference outgoing incoming communication cell type. Positive values (orange) indicate net senders; negative values (blue) indicate net receivers. reveals cell types drive vs receive metabolic signals tissue.","code":"# Net flow = Outgoing - Incoming cell_types <- unique(c(sig$sender, sig$receiver)) net_flow <- sapply(cell_types, function(ct) {   out <- sum(sig$communication_score[sig$sender == ct])   inc <- sum(sig$communication_score[sig$receiver == ct])   out - inc })  # Sort and plot net_flow <- sort(net_flow, decreasing = TRUE) cols <- ifelse(net_flow > 0, \"#FF7043\", \"#42A5F5\")  barplot(net_flow,   col = cols, las = 2,   main = \"Net Communication Flow\",   ylab = \"Outgoing - Incoming\" ) abline(h = 0, lty = 2) legend(\"topright\",   legend = c(\"Net Sender\", \"Net Receiver\"),   fill = c(\"#FF7043\", \"#42A5F5\") )"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/communication.html","id":"comparing-conditions-if-available","dir":"Articles","previous_headings":"","what":"Comparing Conditions (If Available)","title":"Communication Analysis","text":"","code":"# If your data has conditions (e.g., tumor vs normal) # You can run scMetaLink separately and compare  # Example workflow: obj_tumor <- runScMetaLink(expr_tumor, meta_tumor, \"cell_type\") obj_normal <- runScMetaLink(expr_normal, meta_normal, \"cell_type\")  # Compare communication strength comm_tumor <- getCommunicationMatrix(obj_tumor) comm_normal <- getCommunicationMatrix(obj_normal)  # Differential communication diff_comm <- comm_tumor - comm_normal"},{"path":[]},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/communication.html","id":"next-steps","dir":"Articles","previous_headings":"","what":"Next Steps","title":"Communication Analysis","text":"Spatial Analysis: Spatial transcriptomics support Visualization: Create publication-ready figures Applications: Real-world analysis examples","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/lactate-signaling.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"Lactate Signaling Analysis","text":"scMetaLink provides specialized module analyzing lactate-mediated cell communication. Lactate merely metabolic waste product critical signaling molecule tumor microenvironment (TME). module captures direct indirect lactate signaling pathways based rigorous scientific literature review.","code":""},{"path":[]},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/lactate-signaling.html","id":"the-dual-role-of-lactate","dir":"Articles","previous_headings":"Scientific Background","what":"The Dual Role of Lactate","title":"Lactate Signaling Analysis","text":"Lactate exerts signaling effects two distinct mechanisms: Direct Signaling: Lactate directly binds HCAR1 (GPR81), confirmed lactate GPCR Indirect Signaling: Lactate dissociation (pKa=3.86) produces H+ ions activate proton-sensing GPCRs Figure 1: Lactate Signaling Pathways. Lactate produced glycolytic cells (e.g., tumor cells) can signal direct binding HCAR1 indirectly H+ activation proton-sensing GPCRs.","code":""},{"path":[]},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/lactate-signaling.html","id":"load-data-and-run-analysis","dir":"Articles","previous_headings":"","what":"Load Data and Run Analysis","title":"Lactate Signaling Analysis","text":"","code":"library(scMetaLink) library(Matrix)  # Load built-in colorectal cancer example data data(crc_example)  # Create scMetaLink object obj <- createScMetaLink(crc_expr, crc_meta, \"cell_type\")  cat(\"Cell types in data:\\n\") #> Cell types in data: print(table(crc_meta$cell_type)) #>  #>                 B               CAF       Endothelial          Gliacyte  #>               150               200               100                20  #>              Mast          Monocyte Normal Epithelial Normal Fibroblast  #>                30               120               300               200  #> Normal Macrophage          Pericyte            Plasma               SMC  #>               150                50               250                30  #>                 T               TAM  Tumor Epithelial  #>               500               150               600"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/lactate-signaling.html","id":"gene-sets","dir":"Articles","previous_headings":"","what":"Gene Sets","title":"Lactate Signaling Analysis","text":"lactate module uses scientifically curated gene sets:","code":"# Get all gene sets genes <- getLactateGenes()  cat(\"=== PRODUCTION ===\\n\") #> === PRODUCTION === cat(\"Synthesis enzymes:\\n\") #> Synthesis enzymes: print(genes$production$synthesis) #> [1] \"LDHA\"    \"LDHC\"    \"LDHAL6A\" \"LDHAL6B\" cat(\"\\nExport transporters:\\n\") #>  #> Export transporters: print(genes$production$export) #> [1] \"SLC16A3\" \"SLC16A1\" \"SLC16A7\" \"SLC16A8\" \"AQP9\"    \"BSG\"  cat(\"\\n=== DEGRADATION ===\\n\") #>  #> === DEGRADATION === print(genes$degradation$enzymes) #> [1] \"LDHB\" \"LDHD\"  cat(\"\\n=== DIRECT SENSING ===\\n\") #>  #> === DIRECT SENSING === print(genes$direct_sensing$receptor) #> [1] \"HCAR1\"  cat(\"\\n=== INDIRECT SENSING (Proton GPCRs) ===\\n\") #>  #> === INDIRECT SENSING (Proton GPCRs) === print(genes$indirect_sensing$proton_receptors) #> [1] \"GPR4\"   \"GPR65\"  \"GPR68\"  \"GPR132\" cat(\"Weights (reflecting pH sensitivity):\\n\") #> Weights (reflecting pH sensitivity): print(genes$indirect_sensing$weights) #>   GPR4  GPR65  GPR68 GPR132  #>    1.0    1.0    1.0    0.5  cat(\"\\n=== UPTAKE ===\\n\") #>  #> === UPTAKE === print(genes$uptake$import) #> [1] \"SLC16A1\" \"SLC16A7\" \"BSG\""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/lactate-signaling.html","id":"why-these-genes","dir":"Articles","previous_headings":"Gene Sets","what":"Why These Genes?","title":"Lactate Signaling Analysis","text":"Production (Synthesis): - LDHA primary enzyme catalyzing pyruvate → lactate (Warburg effect) - LDHB excluded preferentially catalyzes reverse reaction Production (Export): - MCT4 (SLC16A3) primary exporter low affinity (Km ~22-28 mM) - BSG/CD147 essential chaperone required MCT membrane localization Direct Sensing: - HCAR1 confirmed lactate GPCR (validated cryo-EM structure 2024) Indirect Sensing: - Classic proton-sensing GPCRs detect pH via histidine protonation - GPR132 reduced weight (0.5) primarily senses oxidized fatty acids","code":""},{"path":[]},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/lactate-signaling.html","id":"check-gene-availability","dir":"Articles","previous_headings":"","what":"Check Gene Availability","title":"Lactate Signaling Analysis","text":"running analysis, check lactate genes available data: Figure 2: Lactate Gene Availability. Presence lactate-related genes dataset.","code":"# Check gene availability (returns a data.frame with category, subcategory, gene, available) gene_check <- checkLactateGenes(obj) #> Lactate Gene Availability Summary: #> ================================== #>          category    available #>       degradation   2/2 (100%) #>    direct_sensing   1/1 (100%) #>  indirect_sensing   4/4 (100%) #>        production 10/10 (100%) #>            uptake   3/3 (100%)  # Visualize gene availability by category categories <- c(\"Production\", \"Degradation\", \"Direct Sensing\", \"Indirect Sensing\", \"Uptake\") category_keys <- c(\"production\", \"degradation\", \"direct_sensing\", \"indirect_sensing\", \"uptake\")  available <- sapply(category_keys, function(cat) {   sum(gene_check$available[gene_check$category == cat]) }) total <- sapply(category_keys, function(cat) {   sum(gene_check$category == cat) })  par(mar = c(5, 8, 4, 2)) barplot(rbind(available, total - available),         beside = FALSE, horiz = TRUE,         names.arg = categories, las = 1,         col = c(\"#4CAF50\", \"#FFCDD2\"),         main = \"Lactate Gene Availability\",         xlab = \"Number of Genes\") legend(\"bottomright\", c(\"Available\", \"Missing\"), fill = c(\"#4CAF50\", \"#FFCDD2\"))"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/lactate-signaling.html","id":"run-lactate-signaling-analysis","dir":"Articles","previous_headings":"","what":"Run Lactate Signaling Analysis","title":"Lactate Signaling Analysis","text":"","code":"# Run full lactate signaling analysis obj <- inferLactateSignaling(   obj,   include_direct = TRUE,   include_indirect = TRUE,   method = \"combined\",   normalize = TRUE,   n_permutations = 100,  # Use more for real analysis   verbose = TRUE ) #>   |                                                                              |                                                                      |   0%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |===                                                                   |   4%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |========                                                              |  11%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |==========                                                            |  14%  |                                                                              |==========                                                            |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  17%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |===============                                                       |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  23%  |                                                                              |=================                                                     |  24%  |                                                                              |==================                                                    |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |====================                                                  |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |========================                                              |  34%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |===========================                                           |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  40%  |                                                                              |=============================                                         |  41%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |===============================                                       |  44%  |                                                                              |================================                                      |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |==================================                                    |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |====================================                                  |  51%  |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |======================================                                |  54%  |                                                                              |======================================                                |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  57%  |                                                                              |=========================================                             |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |===========================================                           |  61%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  63%  |                                                                              |=============================================                         |  64%  |                                                                              |==============================================                        |  65%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |==================================================                    |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |====================================================                  |  74%  |                                                                              |====================================================                  |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  77%  |                                                                              |=======================================================               |  78%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  80%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |===========================================================           |  84%  |                                                                              |============================================================          |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |==============================================================        |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================| 100% #>   |                                                                              |                                                                      |   0%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |===                                                                   |   4%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |========                                                              |  11%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |==========                                                            |  14%  |                                                                              |==========                                                            |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  17%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |===============                                                       |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  23%  |                                                                              |=================                                                     |  24%  |                                                                              |==================                                                    |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |====================                                                  |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |========================                                              |  34%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |===========================                                           |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  40%  |                                                                              |=============================                                         |  41%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |===============================                                       |  44%  |                                                                              |================================                                      |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |==================================                                    |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |====================================                                  |  51%  |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |======================================                                |  54%  |                                                                              |======================================                                |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  57%  |                                                                              |=========================================                             |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |===========================================                           |  61%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  63%  |                                                                              |=============================================                         |  64%  |                                                                              |==============================================                        |  65%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |==================================================                    |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |====================================================                  |  74%  |                                                                              |====================================================                  |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  77%  |                                                                              |=======================================================               |  78%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  80%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |===========================================================           |  84%  |                                                                              |============================================================          |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |==============================================================        |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================| 100%"},{"path":[]},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/lactate-signaling.html","id":"production-scores","dir":"Articles","previous_headings":"Visualize Results","what":"Production Scores","title":"Lactate Signaling Analysis","text":"Figure 3: Lactate Production Scores. Higher scores indicate greater lactate production potential (high LDHA, MCT4 expression).","code":"# Get lactate results lactate_results <- obj@parameters$lactate_signaling  if (!is.null(lactate_results)) {   prod_scores <- lactate_results$production      # Sort and plot   prod_sorted <- sort(prod_scores, decreasing = TRUE)      par(mar = c(5, 10, 4, 2))   barplot(prod_sorted, horiz = TRUE, las = 1,           col = \"#FF7043\", border = NA,           main = \"Lactate Production by Cell Type\",           xlab = \"Production Score\") }"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/lactate-signaling.html","id":"sensing-scores-comparison","dir":"Articles","previous_headings":"Visualize Results","what":"Sensing Scores Comparison","title":"Lactate Signaling Analysis","text":"Figure 4: Lactate Sensing Scores. Comparison direct (HCAR1) vs indirect (proton GPCRs) sensing across cell types.","code":"if (!is.null(lactate_results)) {   direct_sens <- lactate_results$direct_sensing   indirect_sens <- lactate_results$indirect_sensing      # Combine for plotting   cell_types <- names(direct_sens)      par(mar = c(5, 10, 4, 2))      # Create grouped barplot   sens_mat <- rbind(Direct = direct_sens, Indirect = indirect_sens)      barplot(sens_mat, beside = TRUE, horiz = TRUE, las = 1,           col = c(\"#1565C0\", \"#2E7D32\"), border = NA,           main = \"Lactate Sensing: Direct vs Indirect Pathways\",           xlab = \"Sensing Score\")   legend(\"bottomright\", c(\"Direct (HCAR1)\", \"Indirect (H+/GPCRs)\"),          fill = c(\"#1565C0\", \"#2E7D32\"), bty = \"n\") }"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/lactate-signaling.html","id":"communication-heatmap","dir":"Articles","previous_headings":"Visualize Results","what":"Communication Heatmap","title":"Lactate Signaling Analysis","text":"Figure 5: Lactate Communication Heatmap. Communication strength sender (rows) receiver (columns) cell types via lactate signaling.","code":"if (!is.null(lactate_results) && !is.null(lactate_results$combined_communication)) {   # Plot using the built-in function   plotLactateSignaling(obj, pathway = \"combined\") }"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/lactate-signaling.html","id":"pathway-comparison","dir":"Articles","previous_headings":"Visualize Results","what":"Pathway Comparison","title":"Lactate Signaling Analysis","text":"Figure 6: Production vs Sensing Comparison. Cell types positioned lactate production (orange) sensing (blue) capabilities.","code":"if (!is.null(lactate_results)) {   plotLactatePathwayComparison(obj, show_production = TRUE) }"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/lactate-signaling.html","id":"cell-type-roles","dir":"Articles","previous_headings":"Visualize Results","what":"Cell Type Roles","title":"Lactate Signaling Analysis","text":"Figure 7: Cell Type Metabolic Roles Lactate Signaling. Net lactate flow: positive = net producer, negative = net sensor.","code":"if (!is.null(lactate_results) && !is.null(lactate_results$combined_communication)) {   comm <- lactate_results$combined_communication      # Calculate net flow   cell_types <- rownames(comm)   net_flow <- rowSums(comm) - colSums(comm)   net_flow <- sort(net_flow)      par(mar = c(5, 10, 4, 2))   cols <- ifelse(net_flow > 0, \"#FF7043\", \"#42A5F5\")   barplot(net_flow, horiz = TRUE, las = 1,           col = cols, border = NA,           main = \"Net Lactate Communication Flow\",           xlab = \"Net Flow (Outgoing - Incoming)\")   abline(v = 0, lty = 2, col = \"gray50\")   legend(\"bottomright\", c(\"Net Producer\", \"Net Sensor\"),          fill = c(\"#FF7043\", \"#42A5F5\"), bty = \"n\") }"},{"path":[]},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/lactate-signaling.html","id":"production-scores-1","dir":"Articles","previous_headings":"Interpreting Results","what":"Production Scores","title":"Lactate Signaling Analysis","text":"High production indicates: - High expression LDHA (synthesis) - High expression MCT4/BSG (export) - Low expression LDHB (degradation)","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/lactate-signaling.html","id":"sensing-scores","dir":"Articles","previous_headings":"Interpreting Results","what":"Sensing Scores","title":"Lactate Signaling Analysis","text":"Direct pathway (HCAR1): - Indicates cells can directly respond lactate - Important anti-inflammatory signaling Indirect pathway (H+/proton GPCRs): - Indicates cells sensing acidification lactate dissociation - Critical immune cell function TME","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/lactate-signaling.html","id":"top-communicators","dir":"Articles","previous_headings":"Interpreting Results","what":"Top Communicators","title":"Lactate Signaling Analysis","text":"","code":"if (!is.null(lactate_results)) {   summary_df <- getLactateSignalingSummary(obj, pathway = \"combined\", top_n = 10)   print(summary_df) } #>               sender          receiver communication_score rank #> 1  Normal Macrophage               TAM           1.5176455    1 #> 2  Normal Macrophage Normal Macrophage           1.4345244    2 #> 3  Normal Macrophage          Pericyte           1.3311660    3 #> 4  Normal Macrophage              Mast           1.2868515    4 #> 5  Normal Macrophage               CAF           1.2522300    5 #> 6  Normal Macrophage Normal Fibroblast           1.2392587    6 #> 7  Normal Macrophage                 T           1.2179554    7 #> 8  Normal Macrophage       Endothelial           1.2001152    8 #> 9  Normal Macrophage               SMC           1.1799733    9 #> 10 Normal Macrophage                 B           0.7686704   10"},{"path":[]},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/lactate-signaling.html","id":"production-score","dir":"Articles","previous_headings":"Algorithm Details","what":"Production Score","title":"Lactate Signaling Analysis","text":"Production(c)=Synthesis¯×Export¯−α×Degradation¯\\text{Production}(c) = \\overline{\\text{Synthesis}} \\times \\overline{\\text{Export}} - \\alpha \\times \\overline{\\text{Degradation}} : - Synthesis = {LDHA, LDHC, LDHAL6A, LDHAL6B} - Export = {SLC16A3, SLC16A1, SLC16A7, SLC16A8, AQP9, BSG} - Degradation = {LDHB, LDHD} - α = 0.3 (degradation weight)","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/lactate-signaling.html","id":"direct-sensing-score","dir":"Articles","previous_headings":"Algorithm Details","what":"Direct Sensing Score","title":"Lactate Signaling Analysis","text":"DirectSensing(c)=HCAR1+β×Uptake¯\\text{DirectSensing}(c) = \\text{HCAR1} + \\beta \\times \\overline{\\text{Uptake}} : - β = 0.5 (uptake contribution) - Uptake = {SLC16A1, SLC16A7, BSG}","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/lactate-signaling.html","id":"indirect-sensing-score","dir":"Articles","previous_headings":"Algorithm Details","what":"Indirect Sensing Score","title":"Lactate Signaling Analysis","text":"IndirectSensing(c)=∑r∈Rwr×Expr(r)∑r∈Rwr\\text{IndirectSensing}(c) = \\frac{\\sum_{r \\R} w_r \\times \\text{Expr}(r)}{\\sum_{r \\R} w_r} : - R = {GPR4, GPR65, GPR68, GPR132} - Weights: GPR4=1.0, GPR65=1.0, GPR68=1.0, GPR132=0.5","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/lactate-signaling.html","id":"communication-score","dir":"Articles","previous_headings":"Algorithm Details","what":"Communication Score","title":"Lactate Signaling Analysis","text":"Comm(s→r)=Production(s)×Sensing(r)\\text{Comm}(s \\r) = \\sqrt{\\text{Production}(s) \\times \\text{Sensing}(r)}","code":""},{"path":[]},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/lactate-signaling.html","id":"tumor-immune-interactions","dir":"Articles","previous_headings":"Biological Applications","what":"Tumor-Immune Interactions","title":"Lactate Signaling Analysis","text":"indirect pathway particularly relevant tumor immunology: Tumor cells produce high lactate (Warburg effect) Lactate dissociation acidifies microenvironment Immune cells expressing GPR65/GPR68 sense acidification leads immunosuppression TME","code":""},{"path":[]},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/lactate-signaling.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"Lactate Signaling Analysis","text":"HCAR1/GPR81 Structure: PLOS Biology (2024). Cryo-EM structures HCAR1. GPR81 Function: Nature Metabolism (2024). Lactate drives cachexia via GPR81. MCT Transport: iScience (2019). Role MCT4 lactate shuttle. BSG/CD147: Nature Cell Discovery (2025). Basigin modulates MCTs. Proton GPCRs: Reactome R-HSA-444731.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/lactate-signaling.html","id":"see-also","dir":"Articles","previous_headings":"","what":"See Also","title":"Lactate Signaling Analysis","text":"Quick Start: Getting started scMetaLink Theory & Methods: Mathematical framework Spatial Analysis: Spatial transcriptomics support Visualization: Complete visualization guide","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/lactate-signaling.html","id":"session-info","dir":"Articles","previous_headings":"","what":"Session Info","title":"Lactate Signaling Analysis","text":"","code":"sessionInfo() #> R version 4.5.2 (2025-10-31) #> Platform: x86_64-pc-linux-gnu #> Running under: Ubuntu 24.04.3 LTS #>  #> Matrix products: default #> BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3  #> LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0 #>  #> locale: #>  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        #>  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    #>  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           #> [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    #>  #> time zone: UTC #> tzcode source: system (glibc) #>  #> attached base packages: #> [1] stats     graphics  grDevices utils     datasets  methods   base      #>  #> other attached packages: #> [1] Matrix_1.7-4      scMetaLink_0.99.0 #>  #> loaded via a namespace (and not attached): #>  [1] viridis_0.6.5         sass_0.4.10           generics_0.1.4        #>  [4] shape_1.4.6.1         lattice_0.22-7        digest_0.6.39         #>  [7] magrittr_2.0.4        evaluate_1.0.5        grid_4.5.2            #> [10] RColorBrewer_1.1-3    iterators_1.0.14      circlize_0.4.17       #> [13] fastmap_1.2.0         foreach_1.5.2         doParallel_1.0.17     #> [16] jsonlite_2.0.0        GlobalOptions_0.1.3   gridExtra_2.3         #> [19] ComplexHeatmap_2.26.0 viridisLite_0.4.2     scales_1.4.0          #> [22] codetools_0.2-20      textshaping_1.0.4     jquerylib_0.1.4       #> [25] cli_3.6.5             rlang_1.1.7           crayon_1.5.3          #> [28] withr_3.0.2           cachem_1.1.0          yaml_2.3.12           #> [31] otel_0.2.0            tools_4.5.2           parallel_4.5.2        #> [34] dplyr_1.1.4           colorspace_2.1-2      ggplot2_4.0.1         #> [37] BiocGenerics_0.56.0   GetoptLong_1.1.0      vctrs_0.7.0           #> [40] R6_2.6.1              png_0.1-8             stats4_4.5.2          #> [43] matrixStats_1.5.0     lifecycle_1.0.5       S4Vectors_0.48.0      #> [46] IRanges_2.44.0        fs_1.6.6              htmlwidgets_1.6.4     #> [49] clue_0.3-66           cluster_2.1.8.1       ragg_1.5.0            #> [52] pkgconfig_2.0.3       desc_1.4.3            pkgdown_2.2.0         #> [55] pillar_1.11.1         bslib_0.9.0           gtable_0.3.6          #> [58] glue_1.8.0            systemfonts_1.3.1     xfun_0.56             #> [61] tibble_3.3.1          tidyselect_1.2.1      knitr_1.51            #> [64] farver_2.1.2          rjson_0.2.23          htmltools_0.5.9       #> [67] labeling_0.4.3        rmarkdown_2.30        compiler_4.5.2        #> [70] S7_0.2.1"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/production-sensing.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"Production & Sensing Analysis","text":"tutorial provides deep dive production sensing inference steps, explaining parameter showing interpret results.","code":"library(scMetaLink) library(Matrix)  # Load example data data(crc_example)  # Create object obj <- createScMetaLink(crc_expr, crc_meta, \"cell_type\")"},{"path":[]},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/production-sensing.html","id":"understanding-production","dir":"Articles","previous_headings":"Part 1: Metabolite Production Potential","what":"Understanding Production","title":"Production & Sensing Analysis","text":"Production potential reflects cell type’s capacity : 1. Synthesize metabolites via enzymatic reactions 2. Secrete/release metabolites extracellular space","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/production-sensing.html","id":"the-inferproduction-function","dir":"Articles","previous_headings":"Part 1: Metabolite Production Potential","what":"The inferProduction() Function","title":"Production & Sensing Analysis","text":"","code":"obj <- inferProduction(   obj,   method = \"combined\", # Expression scoring method   mean_method = \"arithmetic\", # Mean calculation method   min_expression = 0, # Minimum expression threshold   min_pct = 0.1, # Minimum % of expressing cells   consider_degradation = TRUE, # Account for degradation enzymes   consider_secretion = TRUE, # Weight by extracellular localization   normalize = TRUE, # Normalize across cell types   verbose = TRUE )"},{"path":[]},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/production-sensing.html","id":"method-expression-scoring","dir":"Articles","previous_headings":"Part 1: Metabolite Production Potential > Parameter Deep Dive","what":"1. method: Expression Scoring","title":"Production & Sensing Analysis","text":"Figure 1: Expression Scoring Method Comparison. Lactate production potential across cell types using three different scoring methods. ‘mean’ uses average expression, ‘proportion’ uses percentage expressing cells, ‘combined’ multiplies balanced score. Recommendations: - combined: Best cases, balances expression level consistency - mean: trust raw expression values - proportion: dropout severe care /","code":"# Compare different scoring methods obj_mean <- inferProduction(obj, method = \"mean\", verbose = FALSE) obj_prop <- inferProduction(obj, method = \"proportion\", verbose = FALSE) obj_comb <- inferProduction(obj, method = \"combined\", verbose = FALSE)  # Compare for lactate lactate_id <- \"HMDB0000190\" par(mfrow = c(1, 3))  if (lactate_id %in% rownames(obj_mean@production_scores)) {   barplot(sort(obj_mean@production_scores[lactate_id, ], decreasing = TRUE),     las = 2, main = \"method = 'mean'\", col = \"#64B5F6\", cex.names = 0.7   )   barplot(sort(obj_prop@production_scores[lactate_id, ], decreasing = TRUE),     las = 2, main = \"method = 'proportion'\", col = \"#81C784\", cex.names = 0.7   )   barplot(sort(obj_comb@production_scores[lactate_id, ], decreasing = TRUE),     las = 2, main = \"method = 'combined'\", col = \"#FFB74D\", cex.names = 0.7   ) } par(mfrow = c(1, 1))"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/production-sensing.html","id":"mean_method-robust-mean-calculation","dir":"Articles","previous_headings":"Part 1: Metabolite Production Potential > Parameter Deep Dive","what":"2. mean_method: Robust Mean Calculation","title":"Production & Sensing Analysis","text":"single-cell data high dropout outliers, trimean provides robustness: use trimean: - High dropout rates (>50%) - Suspected outlier cells - standard mean seems unstable","code":"# Compare arithmetic vs trimean obj_arith <- inferProduction(obj, mean_method = \"arithmetic\", verbose = FALSE) obj_trim <- inferProduction(obj, mean_method = \"trimean\", verbose = FALSE)  # Correlation between methods if (nrow(obj_arith@production_scores) > 0) {   cor_val <- cor(     as.vector(obj_arith@production_scores),     as.vector(obj_trim@production_scores)   )   cat(\"Correlation between arithmetic and trimean:\", round(cor_val, 3), \"\\n\") } #> Correlation between arithmetic and trimean: 0.786"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/production-sensing.html","id":"consider_degradation-accounting-for-metabolite-turnover","dir":"Articles","previous_headings":"Part 1: Metabolite Production Potential > Parameter Deep Dive","what":"3. consider_degradation: Accounting for Metabolite Turnover","title":"Production & Sensing Analysis","text":"TRUE, production score adjusted subtracting degradation enzyme expression: Productionnet=Productionraw−0.5×Degradation\\text{Production}_{\\text{net}} = \\text{Production}_{\\text{raw}} - 0.5 \\times \\text{Degradation}","code":"obj_with_deg <- inferProduction(obj, consider_degradation = TRUE, verbose = FALSE) obj_no_deg <- inferProduction(obj, consider_degradation = FALSE, verbose = FALSE)  # See the effect cat(\"With degradation adjustment:\\n\") #> With degradation adjustment: print(head(sort(obj_with_deg@production_scores[\"HMDB0000190\", ], decreasing = TRUE))) #>          Monocyte          Gliacyte               TAM Normal Macrophage  #>         0.9375074         0.5305421         0.5021831         0.4832566  #>  Tumor Epithelial Normal Epithelial  #>         0.3845369         0.3664723 cat(\"\\nWithout degradation adjustment:\\n\") #>  #> Without degradation adjustment: print(head(sort(obj_no_deg@production_scores[\"HMDB0000190\", ], decreasing = TRUE))) #> Normal Fibroblast               CAF          Monocyte               SMC  #>         0.6240821         0.6076395         0.5739714         0.5331675  #>               TAM Normal Macrophage  #>         0.5177441         0.5003088"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/production-sensing.html","id":"consider_secretion-extracellular-localization","dir":"Articles","previous_headings":"Part 1: Metabolite Production Potential > Parameter Deep Dive","what":"4. consider_secretion: Extracellular Localization","title":"Production & Sensing Analysis","text":"TRUE, metabolites known extracellular receive full weight (1.0), intracellular metabolites downweighted (0.5):","code":"# Check extracellular metabolites db <- scMetaLink:::.load_metalinksdb() extra_mets <- unique(db$cell_location$hmdb[db$cell_location$cell_location == \"Extracellular\"]) cat(\"Number of extracellular metabolites:\", length(extra_mets), \"\\n\") #> Number of extracellular metabolites: 1128 cat(\"Sample:\", head(db$metabolites$metabolite[db$metabolites$hmdb %in% extra_mets]), \"\\n\") #> Sample: Sulfate Oxoglutaric acid Calcium Glycerol 17alpha-Estradiol Acetaldehyde"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/production-sensing.html","id":"exploring-production-results","dir":"Articles","previous_headings":"Part 1: Metabolite Production Potential","what":"Exploring Production Results","title":"Production & Sensing Analysis","text":"","code":"# Get production score matrix prod_scores <- obj@production_scores  cat(\"Production score matrix dimensions:\", dim(prod_scores), \"\\n\") #> Production score matrix dimensions: 790 15 cat(\"Metabolites:\", nrow(prod_scores), \"\\n\") #> Metabolites: 790 cat(\"Cell types:\", ncol(prod_scores), \"\\n\") #> Cell types: 15  # Top producing cell types for key metabolites cat(\"\\n=== Top Lactate Producers ===\\n\") #>  #> === Top Lactate Producers === print(getTopProducers(obj, \"L-Lactic acid\", top_n = 5)) #>           cell_type production_score rank #> 1          Monocyte        0.9375074    1 #> 2          Gliacyte        0.5305421    2 #> 3               TAM        0.5021831    3 #> 4 Normal Macrophage        0.4832566    4 #> 5  Tumor Epithelial        0.3845369    5  cat(\"\\n=== Top ATP Producers ===\\n\") #>  #> === Top ATP Producers === print(getTopProducers(obj, \"Adenosine triphosphate\", top_n = 5)) #>           cell_type production_score rank #> 1               SMC        0.6306768    1 #> 2          Pericyte        0.6202034    2 #> 3               CAF        0.5758405    3 #> 4 Normal Macrophage        0.5673444    4 #> 5               TAM        0.5539278    5"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/production-sensing.html","id":"visualizing-production-patterns","dir":"Articles","previous_headings":"Part 1: Metabolite Production Potential","what":"Visualizing Production Patterns","title":"Production & Sensing Analysis","text":"Figure 2: Production Potential Heatmap. Top 30 metabolites highest variance across cell types. Row-scaled values show relative production potential. Clustering reveals cell types similar metabolic production profiles.","code":"# Heatmap of production scores for top variable metabolites prod_var <- apply(prod_scores, 1, var) top_mets <- names(sort(prod_var, decreasing = TRUE))[1:30]  # Simple heatmap heatmap(prod_scores[top_mets, ],   scale = \"row\",   col = hcl.colors(50, \"RdYlBu\", rev = TRUE),   margins = c(10, 15),   main = \"Production Potential (Top 30 Variable Metabolites)\" )"},{"path":[]},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/production-sensing.html","id":"understanding-sensing","dir":"Articles","previous_headings":"Part 2: Metabolite Sensing Capability","what":"Understanding Sensing","title":"Production & Sensing Analysis","text":"Sensing capability reflects cell type’s capacity : 1. Detect metabolites via membrane receptors (GPCRs, ion channels, etc.) 2. Uptake metabolites via transporters","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/production-sensing.html","id":"the-infersensing-function","dir":"Articles","previous_headings":"Part 2: Metabolite Sensing Capability","what":"The inferSensing() Function","title":"Production & Sensing Analysis","text":"","code":"obj <- inferSensing(   obj,   method = \"combined\", # Expression scoring method   mean_method = \"arithmetic\", # Mean calculation method   min_expression = 0, # Minimum expression threshold   min_pct = 0.1, # Minimum % of expressing cells   weight_by_affinity = TRUE, # Weight by binding affinity   include_transporters = TRUE, # Include uptake transporters   use_hill = FALSE, # Apply Hill function transformation   hill_n = 1, # Hill coefficient   hill_Kh = 0.5, # Half-maximal threshold   normalize = TRUE,   verbose = TRUE )"},{"path":[]},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/production-sensing.html","id":"weight_by_affinity-binding-strength-weighting","dir":"Articles","previous_headings":"Part 2: Metabolite Sensing Capability > Parameter Deep Dive","what":"1. weight_by_affinity: Binding Strength Weighting","title":"Production & Sensing Analysis","text":"TRUE, receptors weighted metabolite binding affinity MetalinksDB:","code":"# Show affinity scores for a metabolite receptors <- getMetaboliteReceptors(\"Adenosine\", include_transporters = FALSE) cat(\"Adenosine receptors with affinity scores:\\n\") #> Adenosine receptors with affinity scores: print(head(receptors, 10)) #>      gene_symbol       protein_type combined_score             metabolite #> 3132       P2RY1               gpcr            999 Adenosine triphosphate #> 3135        CFTR           other_ic            999 Adenosine triphosphate #> 3104       P2RY2               gpcr            998 Adenosine triphosphate #> 3187       P2RX1               lgic            998 Adenosine triphosphate #> 3144       P2RX4               lgic            997 Adenosine triphosphate #> 3150       ABCC8        transporter            997 Adenosine triphosphate #> 3218      KCNJ11               vgic            995 Adenosine triphosphate #> 3203       P2RX2               lgic            994 Adenosine triphosphate #> 3209       ABCB1        transporter            994 Adenosine triphosphate #> 3119        EGFR catalytic_receptor            988 Adenosine triphosphate"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/production-sensing.html","id":"include_transporters-uptake-transporters","dir":"Articles","previous_headings":"Part 2: Metabolite Sensing Capability > Parameter Deep Dive","what":"2. include_transporters: Uptake Transporters","title":"Production & Sensing Analysis","text":"exclude transporters: want receptor-mediated signaling (metabolic uptake).","code":"# Compare with and without transporters obj_with_trans <- inferSensing(obj, include_transporters = TRUE, verbose = FALSE) obj_no_trans <- inferSensing(obj, include_transporters = FALSE, verbose = FALSE)  cat(\"Metabolites detected:\\n\") #> Metabolites detected: cat(\"  With transporters:\", nrow(obj_with_trans@sensing_scores), \"\\n\") #>   With transporters: 496 cat(\"  Without transporters:\", nrow(obj_no_trans@sensing_scores), \"\\n\") #>   Without transporters: 385"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/production-sensing.html","id":"use_hill-receptor-saturation-model","dir":"Articles","previous_headings":"Part 2: Metabolite Sensing Capability > Parameter Deep Dive","what":"3. use_hill: Receptor Saturation Model","title":"Production & Sensing Analysis","text":"Hill function models receptor binding saturation: Figure 3: Hill Function Effect Sensing Scores. Left: Comparison linear vs Hill-transformed sensing scores metabolite. Points diagonal indicate saturation high expression levels. Right: Different Kh values affect saturation begins - lower Kh means earlier saturation. use Hill function: - expect receptor saturation high expression - Modeling dose-response relationships - Biological realism important","code":"# Compare linear vs Hill transformation obj_linear <- inferSensing(obj, use_hill = FALSE, verbose = FALSE) obj_hill <- inferSensing(obj, use_hill = TRUE, hill_n = 1, hill_Kh = 0.5, verbose = FALSE)  par(mfrow = c(1, 2))  # Find a common metabolite common_met <- intersect(   rownames(obj_linear@sensing_scores),   rownames(obj_hill@sensing_scores) )[1]  if (!is.na(common_met)) {   plot(obj_linear@sensing_scores[common_met, ],     obj_hill@sensing_scores[common_met, ],     xlab = \"Linear Sensing Score\",     ylab = \"Hill-transformed Score\",     main = paste(\"Effect of Hill Function on\", common_met),     pch = 19, col = \"#1976D2\"   )   abline(0, 1, lty = 2, col = \"gray\") }  # Hill parameter comparison x <- seq(0, 1, 0.01) plot(x, x,   type = \"l\", lty = 2, col = \"gray\",   xlab = \"Expression\", ylab = \"Sensing Score\",   main = \"Hill Function Parameters\" ) lines(x, x^1 / (0.3^1 + x^1), col = \"blue\", lwd = 2) lines(x, x^1 / (0.5^1 + x^1), col = \"red\", lwd = 2) lines(x, x^1 / (0.7^1 + x^1), col = \"green\", lwd = 2) legend(\"bottomright\",   legend = c(\"Linear\", \"Kh=0.3\", \"Kh=0.5\", \"Kh=0.7\"),   col = c(\"gray\", \"blue\", \"red\", \"green\"),   lty = c(2, 1, 1, 1), lwd = 2 ) par(mfrow = c(1, 1))"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/production-sensing.html","id":"exploring-sensing-results","dir":"Articles","previous_headings":"Part 2: Metabolite Sensing Capability","what":"Exploring Sensing Results","title":"Production & Sensing Analysis","text":"","code":"sens_scores <- obj@sensing_scores  cat(\"Sensing score matrix dimensions:\", dim(sens_scores), \"\\n\") #> Sensing score matrix dimensions: 496 15  # Top sensing cell types cat(\"\\n=== Top Glutamate Sensors ===\\n\") #>  #> === Top Glutamate Sensors === print(getTopSensors(obj, \"L-Glutamic acid\", top_n = 5)) #>           cell_type sensing_score rank #> 1 Normal Macrophage     0.7624215    1 #> 2               TAM     0.6192208    2 #> 3  Tumor Epithelial     0.4362282    3 #> 4          Gliacyte     0.4255517    4 #> 5 Normal Fibroblast     0.4229089    5  cat(\"\\n=== Top Adenosine Sensors ===\\n\") #>  #> === Top Adenosine Sensors === print(getTopSensors(obj, \"Adenosine\", top_n = 5)) #>           cell_type sensing_score rank #> 1 Normal Macrophage     0.6479570    1 #> 2               TAM     0.5871354    2 #> 3          Pericyte     0.5663821    3 #> 4 Normal Fibroblast     0.4805927    4 #> 5               CAF     0.4760286    5"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/production-sensing.html","id":"receptor-analysis-for-a-metabolite","dir":"Articles","previous_headings":"Part 2: Metabolite Sensing Capability","what":"Receptor Analysis for a Metabolite","title":"Production & Sensing Analysis","text":"","code":"# Get all receptors for a metabolite cat(\"=== Serotonin (5-HT) Receptors ===\\n\") #> === Serotonin (5-HT) Receptors === serotonin_receptors <- getMetaboliteReceptors(\"Serotonin\", include_transporters = TRUE) print(serotonin_receptors) #>      gene_symbol protein_type combined_score metabolite #> 2284        HTR7         gpcr            999  Serotonin #> 2383       HTR1A         gpcr            999  Serotonin #> 2287       HTR1B         gpcr            998  Serotonin #> 2332       HTR2C         gpcr            998  Serotonin #> 2385       HTR2B         gpcr            997  Serotonin #> 2271        HTR4         gpcr            990  Serotonin #> 2304        DRD2         gpcr            989  Serotonin #> 2333        HTR6         gpcr            987  Serotonin #> 2398       HTR1E         gpcr            987  Serotonin #> 2273       HTR1F         gpcr            985  Serotonin #> 2326       HTR5A         gpcr            973  Serotonin #> 2359        DRD3         gpcr            964  Serotonin #> 2484      TBXA2R         gpcr            956  Serotonin #> 2265        DRD4         gpcr            950  Serotonin #> 2356       OPRM1         gpcr            948  Serotonin #> 2386       OPRD1         gpcr            940  Serotonin #> 2267        DRD5         gpcr            939  Serotonin #> 2264       PPARG          nhr            938  Serotonin #> 2350       NTSR1         gpcr            938  Serotonin #> 2502       NTSR2         gpcr            938  Serotonin #> 2354      ADRA2A         gpcr            937  Serotonin #> 2519        CNR1         gpcr            937  Serotonin #> 2390        OPN4         gpcr            936  Serotonin #> 2401        HRH2         gpcr            936  Serotonin #> 2416       MCHR1         gpcr            936  Serotonin #> 2458        MC1R         gpcr            935  Serotonin #> 2286      NPBWR2         gpcr            934  Serotonin #> 2374      ADRA1A         gpcr            934  Serotonin #> 2437      ADRA2C         gpcr            934  Serotonin #> 2516       TAAR1         gpcr            933  Serotonin #> 2266       NMUR2         gpcr            928  Serotonin #> 2269       ADRB1         gpcr            928  Serotonin #> 2270       ADRB2         gpcr            928  Serotonin #> 2276      LTB4R2         gpcr            928  Serotonin #> 2280       UTS2R         gpcr            928  Serotonin #> 2285       GNRHR         gpcr            928  Serotonin #> 2290       SSTR4         gpcr            928  Serotonin #> 2293        CCR3         gpcr            928  Serotonin #> 2297       OPRK1         gpcr            928  Serotonin #> 2298        HRH4         gpcr            928  Serotonin #> 2299      PTGER1         gpcr            928  Serotonin #> 2303       AVPR2         gpcr            928  Serotonin #> 2307        CCR5         gpcr            928  Serotonin #> 2310        CCR4         gpcr            928  Serotonin #> 2311       ACKR3         gpcr            928  Serotonin #> 2314       EDNRA         gpcr            928  Serotonin #> 2317      BDKRB1         gpcr            928  Serotonin #> 2318     ADORA2A         gpcr            928  Serotonin #> 2321       GALR3         gpcr            928  Serotonin #> 2325        GHSR         gpcr            928  Serotonin #> 2328       AGTR2         gpcr            928  Serotonin #> 2329        MLNR         gpcr            928  Serotonin #> 2330       CXCR4         gpcr            928  Serotonin #> 2338        GRPR         gpcr            928  Serotonin #> 2340      ADRA1D         gpcr            928  Serotonin #> 2341      PTGER3         gpcr            928  Serotonin #> 2343     ADORA2B         gpcr            928  Serotonin #> 2348      NPFFR2         gpcr            928  Serotonin #> 2351      ADRA1B         gpcr            928  Serotonin #> 2352      NPFFR1         gpcr            928  Serotonin #> 2355       SSTR1         gpcr            928  Serotonin #> 2358       SSTR2         gpcr            928  Serotonin #> 2362       LTB4R         gpcr            928  Serotonin #> 2363      HCRTR2         gpcr            928  Serotonin #> 2364       LPAR1         gpcr            928  Serotonin #> 2366       PTGFR         gpcr            928  Serotonin #> 2368      PROKR1         gpcr            928  Serotonin #> 2372       CCKBR         gpcr            928  Serotonin #> 2378        MC5R         gpcr            928  Serotonin #> 2380        MC2R         gpcr            928  Serotonin #> 2384      PTGER2         gpcr            928  Serotonin #> 2391      ADORA1         gpcr            928  Serotonin #> 2393       NMUR1         gpcr            928  Serotonin #> 2396       RXFP4         gpcr            928  Serotonin #> 2403      HCRTR1         gpcr            928  Serotonin #> 2405       SSTR5         gpcr            928  Serotonin #> 2407       GALR2         gpcr            928  Serotonin #> 2415       PTGDR         gpcr            928  Serotonin #> 2419       AGTR1         gpcr            928  Serotonin #> 2422       NPY2R         gpcr            928  Serotonin #> 2425       LPAR2         gpcr            928  Serotonin #> 2427       MCHR2         gpcr            928  Serotonin #> 2429        CCR9         gpcr            928  Serotonin #> 2431       NPY5R         gpcr            928  Serotonin #> 2434       NPSR1         gpcr            928  Serotonin #> 2436       OPRL1         gpcr            928  Serotonin #> 2439       APLNR         gpcr            928  Serotonin #> 2441       QRFPR         gpcr            928  Serotonin #> 2442       RXFP3         gpcr            928  Serotonin #> 2443       LPAR3         gpcr            928  Serotonin #> 2447       CCKAR         gpcr            928  Serotonin #> 2449       GALR1         gpcr            928  Serotonin #> 2452       ADRB3         gpcr            928  Serotonin #> 2454        MC4R         gpcr            928  Serotonin #> 2460        OXTR         gpcr            928  Serotonin #> 2465        MC3R         gpcr            928  Serotonin #> 2467        CCR1         gpcr            928  Serotonin #> 2470      PROKR2         gpcr            928  Serotonin #> 2474      KISS1R         gpcr            928  Serotonin #> 2479       PTGIR         gpcr            928  Serotonin #> 2483        NMBR         gpcr            928  Serotonin #> 2485      AVPR1A         gpcr            928  Serotonin #> 2492        CNR2         gpcr            928  Serotonin #> 2496        TRHR         gpcr            928  Serotonin #> 2497      PTGER4         gpcr            928  Serotonin #> 2503       GPR65         gpcr            928  Serotonin #> 2507       CXCR6         gpcr            928  Serotonin #> 2515       NPY1R         gpcr            928  Serotonin #> 2524       NPY4R         gpcr            928  Serotonin #> 2530       EDNRB         gpcr            928  Serotonin #> 2531        HRH3         gpcr            928  Serotonin #> 2370      GPR119         gpcr            393  Serotonin #> 2466         RHO         gpcr            375  Serotonin #> 2279       GPR39         gpcr            373  Serotonin #> 2347       FFAR4         gpcr            373  Serotonin #> 2305       GPR62         gpcr            367  Serotonin #> 2459        OPN5         gpcr            360  Serotonin #> 2272       GPR27         gpcr            310  Serotonin #> 2274       GPR19         gpcr            310  Serotonin #> 2277      GPR176         gpcr            310  Serotonin #> 2278       GPR61         gpcr            310  Serotonin #> 2281       TAAR5         gpcr            310  Serotonin #> 2296       GPR52         gpcr            310  Serotonin #> 2312      GPR139         gpcr            310  Serotonin #> 2315      GPR173         gpcr            310  Serotonin #> 2322       GPR83         gpcr            310  Serotonin #> 2323       GPR63         gpcr            310  Serotonin #> 2336        BRS3         gpcr            310  Serotonin #> 2344      OPN1LW         gpcr            310  Serotonin #> 2357      AVPR1B         gpcr            310  Serotonin #> 2360     GPR37L1         gpcr            310  Serotonin #> 2367       PRLHR         gpcr            310  Serotonin #> 2377      GPR142         gpcr            310  Serotonin #> 2379       GPR45         gpcr            310  Serotonin #> 2381       GPR26         gpcr            310  Serotonin #> 2394      OPN1SW         gpcr            310  Serotonin #> 2397       GPR85         gpcr            310  Serotonin #> 2408       TAAR2         gpcr            310  Serotonin #> 2410      GPR151         gpcr            310  Serotonin #> 2420      GPR148         gpcr            310  Serotonin #> 2433        GPR3         gpcr            310  Serotonin #> 2450       GPR78         gpcr            310  Serotonin #> 2451       TAAR8         gpcr            310  Serotonin #> 2463      GPR150         gpcr            310  Serotonin #> 2488       GPR22         gpcr            310  Serotonin #> 2489       GPR12         gpcr            310  Serotonin #> 2490      GPR135         gpcr            310  Serotonin #> 2498        OPN3         gpcr            310  Serotonin #> 2501       GPR88         gpcr            310  Serotonin #> 2504        GPR6         gpcr            310  Serotonin #> 2513       TAAR6         gpcr            310  Serotonin #> 2521       GPR84         gpcr            310  Serotonin #> 2532       GPR37         gpcr            310  Serotonin #> 2282       HTR3B         lgic             NA  Serotonin #> 2283     SLC36A1  transporter             NA  Serotonin #> 2292       HTR1D         gpcr             NA  Serotonin #> 2295        DRD1         gpcr             NA  Serotonin #> 2402     CYSLTR1         gpcr             NA  Serotonin #> 2468      SLC6A4  transporter             NA  Serotonin #> 2493       HTR3A         lgic             NA  Serotonin #> 2506       HTR2A         gpcr             NA  Serotonin"},{"path":[]},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/production-sensing.html","id":"which-cell-types-are-producers-vs-sensors","dir":"Articles","previous_headings":"Part 3: Comparing Production and Sensing","what":"Which Cell Types are Producers vs Sensors?","title":"Production & Sensing Analysis","text":"Figure 4: Cell Type Metabolic Roles. Scatter plot comparing average production potential (x-axis) vs sensing capability (y-axis) cell type. Cell types diagonal net sensors; net producers.","code":"# Get common metabolites common_mets <- intersect(   rownames(obj@production_scores),   rownames(obj@sensing_scores) )  if (length(common_mets) > 0) {   # Average production and sensing per cell type   avg_prod <- colMeans(obj@production_scores[common_mets, ])   avg_sens <- colMeans(obj@sensing_scores[common_mets, ])    plot(avg_prod, avg_sens,     xlab = \"Average Production Potential\",     ylab = \"Average Sensing Capability\",     main = \"Cell Type Metabolic Roles\",     pch = 19, cex = 1.5, col = \"#1976D2\"   )   text(avg_prod, avg_sens, names(avg_prod), pos = 3, cex = 0.7)   abline(0, 1, lty = 2, col = \"gray\")    # Annotate quadrants   text(max(avg_prod) * 0.9, max(avg_sens) * 0.1, \"High Production\\nLow Sensing\",     cex = 0.8, col = \"gray40\"   )   text(max(avg_prod) * 0.1, max(avg_sens) * 0.9, \"Low Production\\nHigh Sensing\",     cex = 0.8, col = \"gray40\"   ) }"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/production-sensing.html","id":"metabolite-specific-roles","dir":"Articles","previous_headings":"Part 3: Comparing Production and Sensing","what":"Metabolite-Specific Roles","title":"Production & Sensing Analysis","text":"Figure 5: Metabolite-Specific Production Sensing. Comparison lactate production (left, orange) sensing (right, blue) across cell types. reveals communication axis: producers release lactate sensors can detect uptake.","code":"# For a specific metabolite, which cells produce vs sense? met_name <- \"L-Lactic acid\" met_id <- \"HMDB0000190\"  if (met_id %in% rownames(obj@production_scores) &&   met_id %in% rownames(obj@sensing_scores)) {   prod <- obj@production_scores[met_id, ]   sens <- obj@sensing_scores[met_id, ]    par(mfrow = c(1, 2))   barplot(sort(prod, decreasing = TRUE),     las = 2,     main = paste(met_name, \"- Production\"),     col = \"#FF7043\", cex.names = 0.7   )   barplot(sort(sens, decreasing = TRUE),     las = 2,     main = paste(met_name, \"- Sensing\"),     col = \"#42A5F5\", cex.names = 0.7   )   par(mfrow = c(1, 1)) }"},{"path":[]},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/production-sensing.html","id":"next-steps","dir":"Articles","previous_headings":"","what":"Next Steps","title":"Production & Sensing Analysis","text":"Communication Analysis: combine production sensing Visualization: Advanced plotting options","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/quick-start.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Quick Start Guide","text":"scMetaLink infers metabolite-mediated cell-cell communication single-cell RNA-seq data. Unlike traditional ligand-receptor analysis, scMetaLink focuses metabolites signaling mediators, capturing crucial often overlooked layer intercellular communication. Figure 1: scMetaLink Workflow. Overview scMetaLink analysis pipeline.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/quick-start.html","id":"what-youll-learn","dir":"Articles","previous_headings":"Introduction","what":"What You’ll Learn","title":"Quick Start Guide","text":"set scMetaLink analysis basic workflow data input results interpret main outputs","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/quick-start.html","id":"installation","dir":"Articles","previous_headings":"","what":"Installation","title":"Quick Start Guide","text":"","code":"# Install from GitHub devtools::install_github(\"Zaoqu-Liu/scMetaLink\")"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/quick-start.html","id":"load-package-and-example-data","dir":"Articles","previous_headings":"","what":"Load Package and Example Data","title":"Quick Start Guide","text":"","code":"library(scMetaLink) library(Matrix)  # Load built-in colorectal cancer example data data(crc_example)  # Check the data structure cat(\"Expression matrix dimensions:\", dim(crc_expr), \"\\n\") #> Expression matrix dimensions: 4210 2850 cat(\"Genes:\", nrow(crc_expr), \"| Cells:\", ncol(crc_expr), \"\\n\") #> Genes: 4210 | Cells: 2850 cat(\"\\nCell metadata:\\n\") #>  #> Cell metadata: head(crc_meta) #>                   cell_type tumor_normal   tissue_region #> Cell_0001 Normal Epithelial       Normal Normal Adjacent #> Cell_0002 Normal Epithelial       Normal Normal Adjacent #> Cell_0003 Normal Epithelial       Normal Normal Adjacent #> Cell_0004 Normal Epithelial       Normal Normal Adjacent #> Cell_0005 Normal Epithelial       Normal Normal Adjacent #> Cell_0006 Normal Epithelial       Normal Normal Adjacent cat(\"\\nCell type distribution:\\n\") #>  #> Cell type distribution: print(table(crc_meta$cell_type)) #>  #>                 B               CAF       Endothelial          Gliacyte  #>               150               200               100                20  #>              Mast          Monocyte Normal Epithelial Normal Fibroblast  #>                30               120               300               200  #> Normal Macrophage          Pericyte            Plasma               SMC  #>               150                50               250                30  #>                 T               TAM  Tumor Epithelial  #>               500               150               600"},{"path":[]},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/quick-start.html","id":"step-1-create-scmetalink-object","dir":"Articles","previous_headings":"The 5-Minute Workflow","what":"Step 1: Create scMetaLink Object","title":"Quick Start Guide","text":"","code":"# Create the analysis object obj <- createScMetaLink(   expression_data = crc_expr,   cell_meta = crc_meta,   cell_type_column = \"cell_type\" )  # Check the object obj #> scMetaLink Object #> ================= #> Genes: 4210 #> Cells: 2850 #> Cell types: 15 (Normal Epithelial, T, Plasma, ...)"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/quick-start.html","id":"step-2-infer-metabolite-production","dir":"Articles","previous_headings":"The 5-Minute Workflow","what":"Step 2: Infer Metabolite Production","title":"Quick Start Guide","text":"Production potential reflects capable cell type synthesizing secreting specific metabolites.","code":"obj <- inferProduction(   obj,   method = \"combined\", # Use mean expression x proportion expressing   consider_degradation = TRUE, # Subtract degradation enzyme expression   consider_secretion = TRUE, # Weight by secretion potential   verbose = TRUE )  # View top lactate producers getTopProducers(obj, \"L-Lactic acid\", top_n = 5) #>           cell_type production_score rank #> 1          Monocyte        0.9375074    1 #> 2          Gliacyte        0.5305421    2 #> 3               TAM        0.5021831    3 #> 4 Normal Macrophage        0.4832566    4 #> 5  Tumor Epithelial        0.3845369    5"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/quick-start.html","id":"step-3-infer-metabolite-sensing","dir":"Articles","previous_headings":"The 5-Minute Workflow","what":"Step 3: Infer Metabolite Sensing","title":"Quick Start Guide","text":"Sensing capability reflects capable cell type detecting responding specific metabolites.","code":"obj <- inferSensing(   obj,   method = \"combined\",   weight_by_affinity = TRUE, # Weight by receptor-metabolite affinity   include_transporters = TRUE, # Include uptake transporters   verbose = TRUE )  # View top glutamate sensors getTopSensors(obj, \"L-Glutamic acid\", top_n = 5) #>           cell_type sensing_score rank #> 1 Normal Macrophage     0.7624215    1 #> 2               TAM     0.6192208    2 #> 3  Tumor Epithelial     0.4362282    3 #> 4          Gliacyte     0.4255517    4 #> 5 Normal Fibroblast     0.4229089    5"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/quick-start.html","id":"step-4-compute-communication","dir":"Articles","previous_headings":"The 5-Minute Workflow","what":"Step 4: Compute Communication","title":"Quick Start Guide","text":"Communication scores quantify potential signal flow sender (producer) receiver (sensor) cells.","code":"obj <- computeCommunication(   obj,   method = \"geometric\", # sqrt(production x sensing)   min_production = 0.1, # Filter weak producers   min_sensing = 0.1, # Filter weak sensors   n_permutations = 100, # Permutation test for significance   verbose = TRUE ) #>   |                                                                              |                                                                      |   0%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |===                                                                   |   4%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |========                                                              |  11%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |==========                                                            |  14%  |                                                                              |==========                                                            |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  17%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |===============                                                       |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  23%  |                                                                              |=================                                                     |  24%  |                                                                              |==================                                                    |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |====================                                                  |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |========================                                              |  34%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |===========================                                           |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  40%  |                                                                              |=============================                                         |  41%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |===============================                                       |  44%  |                                                                              |================================                                      |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |==================================                                    |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |====================================                                  |  51%  |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |======================================                                |  54%  |                                                                              |======================================                                |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  57%  |                                                                              |=========================================                             |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |===========================================                           |  61%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  63%  |                                                                              |=============================================                         |  64%  |                                                                              |==============================================                        |  65%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |==================================================                    |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |====================================================                  |  74%  |                                                                              |====================================================                  |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  77%  |                                                                              |=======================================================               |  78%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  80%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |===========================================================           |  84%  |                                                                              |============================================================          |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |==============================================================        |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================| 100%"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/quick-start.html","id":"step-5-filter-significant-interactions","dir":"Articles","previous_headings":"The 5-Minute Workflow","what":"Step 5: Filter Significant Interactions","title":"Quick Start Guide","text":"","code":"# For this quick tutorial with limited permutations, we use no adjustment # In real analysis with more permutations, use adjust_method = \"BH\" obj <- filterSignificantInteractions(   obj,   pvalue_threshold = 0.05,   adjust_method = \"none\" # Use \"BH\" for real analysis )  # View top significant interactions head(obj@significant_interactions, 10) #>    metabolite_id            sender receiver communication_score     pvalue #> 1    HMDB0000068          Monocyte     Mast           0.9999641 0.00990099 #> 2    HMDB0003818 Normal Epithelial   Plasma           0.9992733 0.00990099 #> 3    HMDB0002685       Endothelial     Mast           0.9903007 0.00990099 #> 4    HMDB0004234          Gliacyte        B           0.9862472 0.00990099 #> 5    HMDB0000153            Plasma   Plasma           0.9822572 0.00990099 #> 6    HMDB0000653 Normal Macrophage        T           0.9768051 0.00990099 #> 7    HMDB0013078  Tumor Epithelial        B           0.9747729 0.00990099 #> 8    HMDB0000190          Monocyte        B           0.9679184 0.00990099 #> 9    HMDB0001139       Endothelial      CAF           0.9659777 0.00990099 #> 10   HMDB0000335  Tumor Epithelial   Plasma           0.9555982 0.00990099 #>    pvalue_adjusted        metabolite_name #> 1       0.00990099            Epinephrine #> 2       0.00990099       5-Androstenediol #> 3       0.00990099      Prostaglandin F1a #> 4       0.00990099 12-Keto-leukotriene B4 #> 5       0.00990099                Estriol #> 6       0.00990099    Cholesterol sulfate #> 7       0.00990099   Stearoylethanolamide #> 8       0.00990099          L-Lactic acid #> 9       0.00990099      Prostaglandin F2a #> 10      0.00990099     16a-Hydroxyestrone"},{"path":[]},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/quick-start.html","id":"communication-heatmap","dir":"Articles","previous_headings":"Quick Visualization","what":"Communication Heatmap","title":"Quick Start Guide","text":"heatmap shows pairwise communication strength cell types, aggregated across significant metabolites. Figure 1: Communication Heatmap. cell shows total communication score sender (rows) receiver (columns) cell types. Darker colors indicate stronger communication.","code":"plotCommunicationHeatmap(obj)"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/quick-start.html","id":"chord-diagram","dir":"Articles","previous_headings":"Quick Visualization","what":"Chord Diagram","title":"Quick Start Guide","text":"chord diagram provides intuitive view communication flow cell types. Figure 2: Communication Chord Diagram. Ribbons connect sender receiver cell types, width proportional communication strength. Colors represent sender cell types.","code":"plotCommunicationCircle(obj, top_n = 50)"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/quick-start.html","id":"one-line-workflow","dir":"Articles","previous_headings":"","what":"One-Line Workflow","title":"Quick Start Guide","text":"convenience, can run entire analysis single function:","code":"# Complete analysis in one line obj <- runScMetaLink(   expression_data = crc_expr,   cell_meta = crc_meta,   cell_type_column = \"cell_type\",   n_permutations = 100 )"},{"path":[]},{"path":[]},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/quick-start.html","id":"accessing-results","dir":"Articles","previous_headings":"Understanding the Output","what":"Accessing Results","title":"Quick Start Guide","text":"","code":"# Production scores (first 5 metabolites, first 5 cell types) obj@production_scores[1:5, 1:5] #>             Normal Epithelial         T    Plasma Normal Fibroblast       CAF #> HMDB0000008         0.3844017 0.3124838 0.4670759         0.3124838 0.3124838 #> HMDB0000010         0.2708579 0.2465175 0.2391890         0.5269140 0.5625056 #> HMDB0000011         0.2804398 0.3580385 0.3628140         0.5658166 0.4273138 #> HMDB0000012         0.4768788 0.4473201 0.4021738         0.3852586 0.4177708 #> HMDB0000014         0.3271932 0.4098426 0.4522973         0.3559737 0.3869064  # Significant interactions summary cat(\"Total significant interactions:\", nrow(obj@significant_interactions), \"\\n\") #> Total significant interactions: 2754 cat(\"\\nTop metabolites involved:\\n\") #>  #> Top metabolites involved: print(head(sort(table(obj@significant_interactions$metabolite_name), decreasing = TRUE), 10)) #>  #> 11beta-Hydroxyprogesterone           5-Androstenediol  #>                         30                         23  #>                  Ornithine   7beta-Hydroxycholesterol  #>                         21                         20  #>    Adenosine monophosphate                  Cortisone  #>                         19                         19  #>                  Hydroxide                    Retinal  #>                         19                         18  #>                   L-Fucose     Uridine 5'-diphosphate  #>                         17                         17"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/quick-start.html","id":"export-results","dir":"Articles","previous_headings":"","what":"Export Results","title":"Quick Start Guide","text":"","code":"# Export all results to files exportResults(obj, output_dir = \"scMetaLink_results\")"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/quick-start.html","id":"next-steps","dir":"Articles","previous_headings":"","what":"Next Steps","title":"Quick Start Guide","text":"Theory & Methods: Understand mathematical framework Production & Sensing: Deep dive inference Communication Analysis: Advanced communication analysis Spatial Analysis: Spatial transcriptomics support Visualization: Complete visualization guide Applications: Real-world analysis examples","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/quick-start.html","id":"session-info","dir":"Articles","previous_headings":"","what":"Session Info","title":"Quick Start Guide","text":"","code":"sessionInfo() #> R version 4.5.2 (2025-10-31) #> Platform: x86_64-pc-linux-gnu #> Running under: Ubuntu 24.04.3 LTS #>  #> Matrix products: default #> BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3  #> LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0 #>  #> locale: #>  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        #>  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    #>  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           #> [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    #>  #> time zone: UTC #> tzcode source: system (glibc) #>  #> attached base packages: #> [1] stats     graphics  grDevices utils     datasets  methods   base      #>  #> other attached packages: #> [1] Matrix_1.7-4      scMetaLink_0.99.0 #>  #> loaded via a namespace (and not attached): #>  [1] viridis_0.6.5         sass_0.4.10           generics_0.1.4        #>  [4] shape_1.4.6.1         lattice_0.22-7        digest_0.6.39         #>  [7] magrittr_2.0.4        evaluate_1.0.5        grid_4.5.2            #> [10] RColorBrewer_1.1-3    iterators_1.0.14      circlize_0.4.17       #> [13] fastmap_1.2.0         foreach_1.5.2         doParallel_1.0.17     #> [16] jsonlite_2.0.0        GlobalOptions_0.1.3   gridExtra_2.3         #> [19] ComplexHeatmap_2.26.0 viridisLite_0.4.2     scales_1.4.0          #> [22] codetools_0.2-20      textshaping_1.0.4     jquerylib_0.1.4       #> [25] cli_3.6.5             rlang_1.1.7           crayon_1.5.3          #> [28] cachem_1.1.0          yaml_2.3.12           otel_0.2.0            #> [31] tools_4.5.2           parallel_4.5.2        dplyr_1.1.4           #> [34] colorspace_2.1-2      ggplot2_4.0.1         BiocGenerics_0.56.0   #> [37] GetoptLong_1.1.0      vctrs_0.7.0           R6_2.6.1              #> [40] png_0.1-8             stats4_4.5.2          matrixStats_1.5.0     #> [43] lifecycle_1.0.5       S4Vectors_0.48.0      IRanges_2.44.0        #> [46] fs_1.6.6              htmlwidgets_1.6.4     clue_0.3-66           #> [49] cluster_2.1.8.1       ragg_1.5.0            pkgconfig_2.0.3       #> [52] desc_1.4.3            pkgdown_2.2.0         pillar_1.11.1         #> [55] bslib_0.9.0           gtable_0.3.6          glue_1.8.0            #> [58] systemfonts_1.3.1     xfun_0.56             tibble_3.3.1          #> [61] tidyselect_1.2.1      knitr_1.51            farver_2.1.2          #> [64] rjson_0.2.23          htmltools_0.5.9       rmarkdown_2.30        #> [67] compiler_4.5.2        S7_0.2.1"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/spatial-analysis.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"Spatial Transcriptomics Analysis","text":"scMetaLink supports spatial transcriptomics data, enabling analysis metabolite-mediated cell communication spatial context. vignette demonstrates : Create spatial scMetaLink object Compute spatially-weighted communication Visualize communication patterns tissue coordinates Identify communication hotspots","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/spatial-analysis.html","id":"spatial-analysis-workflow","dir":"Articles","previous_headings":"","what":"Spatial Analysis Workflow","title":"Spatial Transcriptomics Analysis","text":"following diagram illustrates complete spatial transcriptomics analysis workflow scMetaLink: Figure 1: Spatial scMetaLink Workflow. Overview spatial transcriptomics analysis pipeline, data input spatially-weighted communication inference visualization.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/spatial-analysis.html","id":"spatial-communication-algorithm","dir":"Articles","previous_headings":"","what":"Spatial Communication Algorithm","title":"Spatial Transcriptomics Analysis","text":"scMetaLink incorporates spatial distance weight cell-cell communication. computational framework illustrated : Figure 2: Spatial Communication Algorithm. Mathematical framework showing spatial distances incorporated metabolite production, sensing, communication score calculations.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/spatial-analysis.html","id":"why-spatial-analysis","dir":"Articles","previous_headings":"","what":"Why Spatial Analysis?","title":"Spatial Transcriptomics Analysis","text":"Traditional single-cell analysis treats cells independent units, ignoring physical locations. However, metabolite signaling fundamentally spatial: Metabolites diffuse tissue distance-dependent decay Nearby cells likely communicate via metabolites Spatial organization cell types affects signaling patterns scMetaLink’s spatial module incorporates biological realities.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/spatial-analysis.html","id":"load-example-data","dir":"Articles","previous_headings":"","what":"Load Example Data","title":"Spatial Transcriptomics Analysis","text":"scMetaLink includes colon spatial transcriptomics dataset demonstration.","code":"library(scMetaLink) library(Matrix)  # Load spatial colon data data(st_expr) data(st_meta) data(st_scalefactors)  # Check the data cat(\"=== Spatial Transcriptomics Data ===\\n\") #> === Spatial Transcriptomics Data === cat(\"Expression matrix:\", dim(st_expr)[1], \"genes x\", dim(st_expr)[2], \"spots\\n\") #> Expression matrix: 4284 genes x 1000 spots cat(\"\\nSpot metadata:\\n\") #>  #> Spot metadata: head(st_meta) #>                        x     y array_row array_col   cell_type #> TAGTCCCGGAGACCAC-1  6642 13195        66        48 Endothelial #> GTGCGTGTATATGAGC-1 10097  8796        41        83     Stromal #> CCGGTATCTGGCGACT-1 10371 15069        77        85  Fibroblast #> CCCAAGAATGCACGGT-1 10519  1993         2        88      Immune #> CGAAACATAGATGGCA-1  9435  3574        11        77      Immune #> TTCTTATCCGCTGGGT-1 11917 10169        49       101  Fibroblast  cat(\"\\nCell type distribution:\\n\") #>  #> Cell type distribution: print(table(st_meta$cell_type)) #>  #> Endothelial  Epithelial  Fibroblast      Immune     Stromal       Tumor  #>         174         189         232         145         133         127  cat(\"\\nScale factors:\\n\") #>  #> Scale factors: print(st_scalefactors) #> $spot_diameter_fullres #> [1] 130.2321 #>  #> $tissue_hires_scalef #> [1] 0.1220703 #>  #> $tissue_lowres_scalef #> [1] 0.03662109 #>  #> $spot_diameter_um #> [1] 55 #>  #> $pixels_per_um #> [1] 2.367856"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/spatial-analysis.html","id":"create-spatial-scmetalink-object","dir":"Articles","previous_headings":"","what":"Create Spatial scMetaLink Object","title":"Spatial Transcriptomics Analysis","text":"Use createScMetaLinkFromSpatial() create object spatial coordinates.","code":"# Create spatial scMetaLink object obj <- createScMetaLinkFromSpatial(   expression_data = st_expr,   spatial_coords = st_meta[, c(\"x\", \"y\")],   cell_meta = st_meta,   cell_type_column = \"cell_type\",   scale_factors = st_scalefactors,  # Important for correct distance calculation!   min_cells = 5 )  # Check the object obj #> scMetaLink Object #> ================= #> Genes: 4284 #> Cells: 1000 #> Cell types: 6 (Endothelial, Stromal, Fibroblast, ...)"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/spatial-analysis.html","id":"important-coordinate-units","dir":"Articles","previous_headings":"Create Spatial scMetaLink Object","what":"Important: Coordinate Units","title":"Spatial Transcriptomics Analysis","text":"10x Visium data: Raw coordinates pixels, micrometers must provide scale_factors pixels_per_um correct distance calculations Without proper scaling, distance parameters (sigma, threshold) interpreted pixels!","code":"# Check spatial distance statistics dist_stats <- getSpatialDistanceStats(obj)  cat(\"=== Spatial Distance Statistics ===\\n\") #> === Spatial Distance Statistics === cat(\"Number of spots:\", dist_stats$n_spots, \"\\n\") #> Number of spots: 1000 cat(\"Min distance:\", round(dist_stats$min_distance_um, 1), \"um\\n\") #> Min distance: 84.5 um cat(\"Median distance:\", round(dist_stats$median_distance_um, 1), \"um\\n\") #> Median distance: 2558.5 um cat(\"Max distance:\", round(dist_stats$max_distance_um, 1), \"um\\n\") #> Max distance: 6864.2 um cat(\"Coordinate unit:\", dist_stats$coord_unit, \"\\n\") #> Coordinate unit: converted to micrometers"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/spatial-analysis.html","id":"working-with-seurat-objects","dir":"Articles","previous_headings":"Create Spatial scMetaLink Object","what":"Working with Seurat Objects","title":"Spatial Transcriptomics Analysis","text":"Seurat spatial object, use createScMetaLinkFromSeuratSpatial():","code":"# From Seurat spatial object obj <- createScMetaLinkFromSeuratSpatial(   seurat_obj = seurat_spatial,   cell_type_column = \"cell_type\",  # Column with deconvolution results   assay = \"Spatial\",   image = \"slice1\"  # Name of the spatial image )"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/spatial-analysis.html","id":"visualize-spatial-cell-types","dir":"Articles","previous_headings":"","what":"Visualize Spatial Cell Types","title":"Spatial Transcriptomics Analysis","text":"analysis, visualize spatial distribution cell types. Figure 3: Spatial Cell Type Distribution. spot colored assigned cell type. Visium data, cell types typically come deconvolution methods (RCTD, cell2location, etc.).","code":"plotSpatialCellTypes(obj, point_size = 2, alpha = 0.8)"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/spatial-analysis.html","id":"infer-production-and-sensing","dir":"Articles","previous_headings":"","what":"Infer Production and Sensing","title":"Spatial Transcriptomics Analysis","text":"Run standard production sensing inference.","code":"# Infer metabolite production obj <- inferProduction(   obj,   method = \"combined\",   consider_degradation = TRUE,   consider_secretion = TRUE,   verbose = TRUE )  # Infer metabolite sensing obj <- inferSensing(   obj,   method = \"combined\",   weight_by_affinity = TRUE,   include_transporters = TRUE,   verbose = TRUE )"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/spatial-analysis.html","id":"visualize-spatial-metabolite-patterns","dir":"Articles","previous_headings":"","what":"Visualize Spatial Metabolite Patterns","title":"Spatial Transcriptomics Analysis","text":"Visualize production sensing scores spatial coordinates. Figure 4: Lactate Production Potential. Spots colored lactate production score based cell type. Warmer colors indicate higher production potential. Figure 5: Lactate Sensing Capability. Spots colored lactate sensing score. shows regions can detect respond lactate signaling.","code":"plotSpatialFeature(   obj,   metabolite = \"L-Lactic acid\",   type = \"production\",   point_size = 2 ) plotSpatialFeature(   obj,   metabolite = \"L-Lactic acid\",   type = \"sensing\",   point_size = 2,   low_color = \"#EBF5FB\",   high_color = \"#1A5276\" )"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/spatial-analysis.html","id":"compare-multiple-metabolites","dir":"Articles","previous_headings":"Visualize Spatial Metabolite Patterns","what":"Compare Multiple Metabolites","title":"Spatial Transcriptomics Analysis","text":"Figure 6: Spatial Comparison Key Metabolites. Production patterns multiple metabolites shown side side, revealing distinct spatial organization metabolic activities.","code":"plotSpatialComparison(   obj,   metabolites = c(\"L-Lactic acid\", \"L-Glutamic acid\", \"Adenosine\", \"L-Alanine\"),   type = \"production\",   ncol = 2,   point_size = 1.5 )"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/spatial-analysis.html","id":"compute-spatial-communication","dir":"Articles","previous_headings":"","what":"Compute Spatial Communication","title":"Spatial Transcriptomics Analysis","text":"key innovation spatially-weighted communication. Nearby cell type pairs receive higher communication scores.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/spatial-analysis.html","id":"spatial-weighting-methods","dir":"Articles","previous_headings":"Compute Spatial Communication","what":"Spatial Weighting Methods","title":"Spatial Transcriptomics Analysis","text":"scMetaLink offers several spatial weighting methods: Figure 7: Spatial Weighting Functions. Different methods model decay communication potential distance. KNN (shown) uses binary approach based nearest neighbors.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/spatial-analysis.html","id":"run-spatial-communication-analysis","dir":"Articles","previous_headings":"Compute Spatial Communication","what":"Run Spatial Communication Analysis","title":"Spatial Transcriptomics Analysis","text":"Visium data, recommend knn method k=6 (hexagonal grid neighbors):","code":"# Compute spatially-weighted communication obj <- computeSpatialCommunication(   obj,   method = \"knn\",           # K-nearest neighbors (recommended for Visium)   k_neighbors = 6,          # 6 neighbors for hexagonal grid   symmetric = TRUE,         # Bidirectional communication potential   comm_method = \"geometric\", # sqrt(production x sensing)   min_production = 0.1,   min_sensing = 0.1,   n_permutations = 100,     # Use >=1000 for publication   n_cores = 1,   seed = 42,   verbose = TRUE ) #>   |                                                                              |                                                                      |   0%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |===                                                                   |   4%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |========                                                              |  11%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |==========                                                            |  14%  |                                                                              |==========                                                            |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  17%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |===============                                                       |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  23%  |                                                                              |=================                                                     |  24%  |                                                                              |==================                                                    |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |====================                                                  |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |========================                                              |  34%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |===========================                                           |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  40%  |                                                                              |=============================                                         |  41%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |===============================                                       |  44%  |                                                                              |================================                                      |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |==================================                                    |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |====================================                                  |  51%  |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |======================================                                |  54%  |                                                                              |======================================                                |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  57%  |                                                                              |=========================================                             |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |===========================================                           |  61%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  63%  |                                                                              |=============================================                         |  64%  |                                                                              |==============================================                        |  65%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |==================================================                    |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |====================================================                  |  74%  |                                                                              |====================================================                  |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  77%  |                                                                              |=======================================================               |  78%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  80%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |===========================================================           |  84%  |                                                                              |============================================================          |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |==============================================================        |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================| 100%"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/spatial-analysis.html","id":"alternative-gaussian-decay","dir":"Articles","previous_headings":"Compute Spatial Communication","what":"Alternative: Gaussian Decay","title":"Spatial Transcriptomics Analysis","text":"continuous distance weighting:","code":"obj <- computeSpatialCommunication(   obj,   method = \"gaussian\",   sigma = 50,               # 50 um characteristic decay   distance_threshold = 150, # Max communication distance   n_permutations = 100,   verbose = TRUE )"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/spatial-analysis.html","id":"filter-significant-interactions","dir":"Articles","previous_headings":"","what":"Filter Significant Interactions","title":"Spatial Transcriptomics Analysis","text":"","code":"# Filter significant spatial interactions obj <- filterSignificantInteractions(   obj,   pvalue_threshold = 0.05,   adjust_method = \"none\"  # Use \"BH\" for real analysis with more permutations )  # View results cat(\"Significant spatial interactions:\", nrow(obj@significant_interactions), \"\\n\\n\") #> Significant spatial interactions: 442 head(obj@significant_interactions[, c(\"sender\", \"receiver\", \"metabolite_name\",                                        \"communication_score\", \"pvalue_adjusted\")]) #>       sender   receiver                 metabolite_name communication_score #> 1    Stromal Fibroblast               Prostaglandin F1a           0.9781756 #> 2    Stromal    Stromal 20-Hydroxyeicosatetraenoic acid           0.9716861 #> 3 Fibroblast    Stromal       DG(18:0/18:2(9Z,12Z)/0:0)           0.9605915 #> 4    Stromal    Stromal                Prostaglandin I2           0.9602908 #> 5 Fibroblast    Stromal                         Retinal           0.9583222 #> 6 Fibroblast    Stromal               DG(18:0/18:0/0:0)           0.9579443 #>   pvalue_adjusted #> 1      0.00990099 #> 2      0.00990099 #> 3      0.00990099 #> 4      0.01980198 #> 5      0.00990099 #> 6      0.00990099"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/spatial-analysis.html","id":"visualize-spatial-communication-network","dir":"Articles","previous_headings":"","what":"Visualize Spatial Communication Network","title":"Spatial Transcriptomics Analysis","text":"Figure 8: Spatial Communication Network. Arrows connect cell type centroids, width proportional communication strength. Background spots show tissue context.","code":"plotSpatialCommunicationNetwork(   obj,   metabolite = NULL,  # Aggregate all metabolites   top_n = 15,   arrow_scale = 1.5,   point_size = 6,   show_labels = TRUE )"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/spatial-analysis.html","id":"metabolite-specific-network","dir":"Articles","previous_headings":"Visualize Spatial Communication Network","what":"Metabolite-Specific Network","title":"Spatial Transcriptomics Analysis","text":"Figure 9: Lactate Communication Network. Spatial communication pattern lactate specifically, showing cell types communicate via metabolite.","code":"plotSpatialCommunicationNetwork(   obj,   metabolite = \"L-Lactic acid\",   top_n = 10,   arrow_scale = 2,   point_size = 6 )"},{"path":[]},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/spatial-analysis.html","id":"top-spatial-interactions","dir":"Articles","previous_headings":"Analyze Communication Patterns","what":"Top Spatial Interactions","title":"Spatial Transcriptomics Analysis","text":"","code":"sig <- obj@significant_interactions  # Top metabolites in spatial communication cat(\"=== Top Metabolite Mediators (Spatial) ===\\n\") #> === Top Metabolite Mediators (Spatial) === met_counts <- table(sig$metabolite_name) print(head(sort(met_counts, decreasing = TRUE), 15)) #>  #>                          24-Hydroxycholesterol  #>                                              5  #>               DG(18:0/20:4(5Z,8Z,11Z,14Z)/0:0)  #>                                              5  #>                                    Epinephrine  #>                                              5  #>                                L-Aspartic acid  #>                                              5  #>                               Prostaglandin D2  #>                                              5  #>                               Prostaglandin E2  #>                                              5  #>                                      Adenosine  #>                                              4  #>                             Pentadecanoic acid  #>                                              4  #>                           13-cis-Retinoic acid  #>                                              3  #>                                        13-HODE  #>                                              3  #>                 17-Hydroxypregnenolone sulfate  #>                                              3  #>                        17a-Hydroxypregnenolone  #>                                              3  #> 3 alpha,7 alpha,26-Trihydroxy-5beta-cholestane  #>                                              3  #>                          3-Hydroxybutyric acid  #>                                              3  #>                                         5-HETE  #>                                              3"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/spatial-analysis.html","id":"cell-type-communication-summary","dir":"Articles","previous_headings":"Analyze Communication Patterns","what":"Cell Type Communication Summary","title":"Spatial Transcriptomics Analysis","text":"","code":"par(mfrow = c(1, 2))  # Outgoing (sender) strength outgoing <- aggregate(communication_score ~ sender, data = sig, FUN = sum) outgoing <- outgoing[order(-outgoing$communication_score), ] barplot(outgoing$communication_score, names.arg = outgoing$sender,         las = 2, col = \"#E64B35\", main = \"Outgoing Spatial Communication\")  # Incoming (receiver) strength incoming <- aggregate(communication_score ~ receiver, data = sig, FUN = sum) incoming <- incoming[order(-incoming$communication_score), ] barplot(incoming$communication_score, names.arg = incoming$receiver,         las = 2, col = \"#4DBBD5\", main = \"Incoming Spatial Communication\") par(mfrow = c(1, 1))"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/spatial-analysis.html","id":"communication-hotspot-identification","dir":"Articles","previous_headings":"","what":"Communication Hotspot Identification","title":"Spatial Transcriptomics Analysis","text":"spot-level analysis, scMetaLink can identify spatial hotspots communication activity.","code":"# Note: Requires running computeSpatialCommunication with analysis_level=\"spot\" obj_spot <- computeSpatialCommunication(   obj,   method = \"knn\",   k_neighbors = 6,   analysis_level = \"spot\",  # Spot-level analysis   n_permutations = 0,       # Skip permutation for speed   verbose = TRUE )  # Identify hotspots hotspots <- identifyCommunicationHotspots(   obj_spot,   metabolite = \"L-Lactic acid\",   type = \"sender\",   n_hotspots = 5 )  print(hotspots)  # Visualize hotspots plotSpatialHotspots(obj_spot, metabolite = \"L-Lactic acid\", type = \"sender\")"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/spatial-analysis.html","id":"spatial-distance-distribution","dir":"Articles","previous_headings":"","what":"Spatial Distance Distribution","title":"Spatial Transcriptomics Analysis","text":"Understand spatial relationships data: Figure 10: Spatial Distance Distribution. Histogram showing distribution pairwise distances spots. Red lines mark common distance thresholds (100, 200, 500 um).","code":"plotSpatialDistanceDistribution(obj, max_distance = 1000, bins = 50)"},{"path":[]},{"path":[]},{"path":[]},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/spatial-analysis.html","id":"complete-workflow-example","dir":"Articles","previous_headings":"","what":"Complete Workflow Example","title":"Spatial Transcriptomics Analysis","text":"","code":"# Complete spatial analysis workflow library(scMetaLink)  # 1. Load data data(st_expr) data(st_meta) data(st_scalefactors)  # 2. Create spatial object obj <- createScMetaLinkFromSpatial(   expression_data = st_expr,   spatial_coords = st_meta[, c(\"x\", \"y\")],   cell_meta = st_meta,   cell_type_column = \"cell_type\",   scale_factors = st_scalefactors )  # 3. Infer production and sensing obj <- inferProduction(obj) obj <- inferSensing(obj)  # 4. Compute spatial communication obj <- computeSpatialCommunication(   obj,   method = \"knn\",   k_neighbors = 6,   n_permutations = 1000  # More permutations for publication )  # 5. Filter significant interactions obj <- filterSignificantInteractions(obj, adjust_method = \"BH\")  # 6. Visualize results plotSpatialCellTypes(obj) plotSpatialCommunicationNetwork(obj)  # 7. Export results exportResults(obj, output_dir = \"spatial_results\")"},{"path":[]},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/spatial-analysis.html","id":"limitations-and-considerations","dir":"Articles","previous_headings":"","what":"Limitations and Considerations","title":"Spatial Transcriptomics Analysis","text":"Resolution: Visium spots contain multiple cells; cell type assignments approximations Deconvolution: Use proper deconvolution methods (RCTD, cell2location) cell type assignment Diffusion assumptions: Metabolite diffusion simplified distance-dependent decay 3D tissue: Current analysis 2D; vertical diffusion modeled","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/spatial-analysis.html","id":"session-info","dir":"Articles","previous_headings":"","what":"Session Info","title":"Spatial Transcriptomics Analysis","text":"","code":"sessionInfo() #> R version 4.5.2 (2025-10-31) #> Platform: x86_64-pc-linux-gnu #> Running under: Ubuntu 24.04.3 LTS #>  #> Matrix products: default #> BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3  #> LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0 #>  #> locale: #>  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        #>  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    #>  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           #> [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    #>  #> time zone: UTC #> tzcode source: system (glibc) #>  #> attached base packages: #> [1] stats     graphics  grDevices utils     datasets  methods   base      #>  #> other attached packages: #> [1] Matrix_1.7-4      scMetaLink_0.99.0 #>  #> loaded via a namespace (and not attached): #>  [1] gtable_0.3.6       jsonlite_2.0.0     dplyr_1.1.4        compiler_4.5.2     #>  [5] tidyselect_1.2.1   jquerylib_0.1.4    systemfonts_1.3.1  scales_1.4.0       #>  [9] textshaping_1.0.4  yaml_2.3.12        fastmap_1.2.0      lattice_0.22-7     #> [13] ggplot2_4.0.1      R6_2.6.1           labeling_0.4.3     generics_0.1.4     #> [17] knitr_1.51         htmlwidgets_1.6.4  tibble_3.3.1       desc_1.4.3         #> [21] bslib_0.9.0        pillar_1.11.1      RColorBrewer_1.1-3 rlang_1.1.7        #> [25] cachem_1.1.0       xfun_0.56          fs_1.6.6           sass_0.4.10        #> [29] S7_0.2.1           otel_0.2.0         cli_3.6.5          withr_3.0.2        #> [33] pkgdown_2.2.0      magrittr_2.0.4     digest_0.6.39      grid_4.5.2         #> [37] lifecycle_1.0.5    vctrs_0.7.0        evaluate_1.0.5     glue_1.8.0         #> [41] farver_2.1.2       ragg_1.5.0         rmarkdown_2.30     tools_4.5.2        #> [45] pkgconfig_2.0.3    htmltools_0.5.9"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/theory.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"Theory & Methods","text":"scMetaLink models metabolite-mediated cell communication two-step process: Figure 1: scMetaLink Workflow. Schematic overview analysis pipeline inferring metabolite-mediated cell-cell communication.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/theory.html","id":"the-metalinksdb-knowledge-base","dir":"Articles","previous_headings":"","what":"The MetalinksDB Knowledge Base","title":"Theory & Methods","text":"scMetaLink uses MetalinksDB, comprehensive database metabolite-protein interactions.","code":"library(scMetaLink)  # Load and explore the database db <- scMetaLink:::.load_metalinksdb()  cat(\"=== MetalinksDB Statistics ===\\n\") #> === MetalinksDB Statistics === cat(\"Metabolites:\", nrow(db$metabolites), \"\\n\") #> Metabolites: 1128 cat(\"Proteins:\", nrow(db$proteins), \"\\n\") #> Proteins: 4374 cat(\"Interactions:\", nrow(db$edges), \"\\n\") #> Interactions: 41894 cat(\"Pathways:\", length(unique(db$pathway$pathway)), \"\\n\") #> Pathways: 36806"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/theory.html","id":"interaction-types","dir":"Articles","previous_headings":"The MetalinksDB Knowledge Base","what":"Interaction Types","title":"Theory & Methods","text":"","code":"# Two main interaction types cat(\"=== Interaction Types ===\\n\") #> === Interaction Types === print(table(db$edges$type)) #>  #>    lr    pd  #> 11869 30025  cat(\"\\n- lr (ligand-receptor): Direct metabolite-receptor binding\\n\") #>  #> - lr (ligand-receptor): Direct metabolite-receptor binding cat(\"- pd (produce-degrade): Enzymatic production/degradation\\n\") #> - pd (produce-degrade): Enzymatic production/degradation"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/theory.html","id":"mode-of-regulation-mor","dir":"Articles","previous_headings":"The MetalinksDB Knowledge Base","what":"Mode of Regulation (MOR)","title":"Theory & Methods","text":"pd type interactions, MOR indicates direction:","code":"pd_edges <- db$edges[db$edges$type == \"pd\", ] cat(\"=== Mode of Regulation for pd interactions ===\\n\") #> === Mode of Regulation for pd interactions === print(table(pd_edges$mor)) #>  #>    -1     1  #> 13144 16881  cat(\"\\n- mor = 1: Enzyme produces/secretes the metabolite\\n\") #>  #> - mor = 1: Enzyme produces/secretes the metabolite cat(\"- mor = -1: Enzyme degrades/consumes the metabolite\\n\") #> - mor = -1: Enzyme degrades/consumes the metabolite cat(\"- mor = 0: Enzyme binds without direction change\\n\") #> - mor = 0: Enzyme binds without direction change"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/theory.html","id":"protein-types","dir":"Articles","previous_headings":"The MetalinksDB Knowledge Base","what":"Protein Types","title":"Theory & Methods","text":"","code":"cat(\"=== Protein Classifications ===\\n\") #> === Protein Classifications === print(table(db$proteins$protein_type, useNA = \"ifany\")) #>  #> catalytic_receptor             enzyme               gpcr               lgic  #>                179                918                306                 71  #>                nhr           other_ic      other_protein        transporter  #>                 43                 39                 28                393  #>               vgic               <NA>  #>                 73               2324  cat(\"\\n\") cat(\"Receptors: gpcr, lgic, nhr, vgic, catalytic_receptor, other_ic\\n\") #> Receptors: gpcr, lgic, nhr, vgic, catalytic_receptor, other_ic cat(\"Enzymes: enzyme (or NA in protein_type)\\n\") #> Enzymes: enzyme (or NA in protein_type) cat(\"Transporters: transporter\\n\") #> Transporters: transporter"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/theory.html","id":"mathematical-framework","dir":"Articles","previous_headings":"","what":"Mathematical Framework","title":"Theory & Methods","text":"Figure 2: Computational Algorithm. Schematic illustration mathematical framework computing metabolite production, sensing, communication scores.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/theory.html","id":"metabolite-production-potential-mpp","dir":"Articles","previous_headings":"Mathematical Framework","what":"1. Metabolite Production Potential (MPP)","title":"Theory & Methods","text":"production potential metabolite mm cell type cc : MPPm,c=1|Em|∑e∈EmScore(e,c)−α⋅1|Dm|∑d∈DmScore(d,c)\\text{MPP}_{m,c} = \\frac{1}{|E_m|} \\sum_{e \\E_m} \\text{Score}(e, c) - \\alpha \\cdot \\frac{1}{|D_m|} \\sum_{d \\D_m} \\text{Score}(d, c) : - EmE_m: Set enzymes produce metabolite mm - DmD_m: Set enzymes degrade metabolite mm - α=0.5\\alpha = 0.5: Degradation weight factor - Score(g,c)\\text{Score}(g, c): Gene expression score gene gg cell type cc","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/theory.html","id":"gene-expression-scoring","dir":"Articles","previous_headings":"Mathematical Framework > 1. Metabolite Production Potential (MPP)","what":"Gene Expression Scoring","title":"Theory & Methods","text":"Three methods available:","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/theory.html","id":"trimean-option","dir":"Articles","previous_headings":"Mathematical Framework > 1. Metabolite Production Potential (MPP)","what":"Trimean Option","title":"Theory & Methods","text":"single-cell data high dropout, trimean provides robust alternative: Trimean=Q1+2Q2+Q34\\text{Trimean} = \\frac{Q_1 + 2Q_2 + Q_3}{4}","code":"# Example: Trimean vs Arithmetic Mean expr_with_outlier <- c(0, 0, 0, 1, 2, 3, 100) # Outlier = 100  cat(\"Data:\", paste(expr_with_outlier, collapse = \", \"), \"\\n\") #> Data: 0, 0, 0, 1, 2, 3, 100 cat(\"Arithmetic mean:\", round(mean(expr_with_outlier), 2), \"\\n\") #> Arithmetic mean: 15.14 cat(\"Median:\", median(expr_with_outlier), \"\\n\") #> Median: 1  # Trimean calculation q <- quantile(expr_with_outlier, c(0.25, 0.5, 0.75)) trimean <- (q[1] + 2 * q[2] + q[3]) / 4 cat(\"Trimean:\", round(trimean, 2), \"\\n\") #> Trimean: 1.12 cat(\"\\nTrimean is robust to the outlier!\\n\") #>  #> Trimean is robust to the outlier!"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/theory.html","id":"metabolite-sensing-capability-msc","dir":"Articles","previous_headings":"Mathematical Framework","what":"2. Metabolite Sensing Capability (MSC)","title":"Theory & Methods","text":"sensing capability metabolite mm cell type cc : MSCm,c=1|Rm|∑r∈Rmwr⋅Score(r,c)\\text{MSC}_{m,c} = \\frac{1}{|R_m|} \\sum_{r \\R_m} w_r \\cdot \\text{Score}(r, c) : - RmR_m: Set receptors/transporters metabolite mm - wrw_r: Affinity weight based interaction confidence score","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/theory.html","id":"affinity-weighting","dir":"Articles","previous_headings":"Mathematical Framework > 2. Metabolite Sensing Capability (MSC)","what":"Affinity Weighting","title":"Theory & Methods","text":"Receptor-metabolite binding affinities MetalinksDB used weights:","code":"lr_edges <- db$edges[db$edges$type == \"lr\", ] cat(\"Affinity score distribution (0-1000):\\n\") #> Affinity score distribution (0-1000): summary(lr_edges$combined_score) #>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's  #>   202.0   287.0   413.0   553.5   921.0   999.0     470"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/theory.html","id":"hill-function-optional","dir":"Articles","previous_headings":"Mathematical Framework > 2. Metabolite Sensing Capability (MSC)","what":"Hill Function (Optional)","title":"Theory & Methods","text":"model receptor saturation kinetics, optional Hill transformation can applied: P=EnKhn+EnP = \\frac{E^n}{K_h^n + E^n} : - EE: Expression level (normalized) - nn: Hill coefficient (cooperativity) - KhK_h: Half-maximal threshold Figure 1: Hill Function Transformation. Different Hill coefficients (n) produce different response curves. n=1 gives standard Michaelis-Menten kinetics. n>1 indicates positive cooperativity (steeper curve). half-maximal response occurs x=Kh.","code":"# Hill function visualization x <- seq(0, 1, 0.01) hill <- function(x, n, Kh) x^n / (Kh^n + x^n)  plot(x, x,   type = \"l\", lty = 2, col = \"gray\",   xlab = \"Expression (normalized)\", ylab = \"Response\",   main = \"Hill Function Transformation\" ) lines(x, hill(x, n = 1, Kh = 0.5), col = \"blue\", lwd = 2) lines(x, hill(x, n = 2, Kh = 0.5), col = \"red\", lwd = 2) lines(x, hill(x, n = 0.5, Kh = 0.5), col = \"green\", lwd = 2) legend(\"bottomright\",   legend = c(\"Linear\", \"n=1 (Michaelis-Menten)\", \"n=2 (Cooperative)\", \"n=0.5\"),   col = c(\"gray\", \"blue\", \"red\", \"green\"),   lty = c(2, 1, 1, 1), lwd = 2 ) abline(h = 0.5, v = 0.5, lty = 3, col = \"gray\")"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/theory.html","id":"communication-score","dir":"Articles","previous_headings":"Mathematical Framework","what":"3. Communication Score","title":"Theory & Methods","text":"communication score sender ss receiver rr via metabolite mm: Comms→rm=f(MPPm,s,MSCm,r)\\text{Comm}_{s \\r}^m = f(\\text{MPP}_{m,s}, \\text{MSC}_{m,r}) Three aggregation methods available: Figure 2: Communication Score Methods. Heat maps showing different methods combine production (x-axis) sensing (y-axis) scores. Geometric mean (left) provides balanced weighting. Product (center) emphasizes strong bilateral signals. Harmonic mean (right) penalizes imbalanced communication.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/theory.html","id":"population-size-correction-optional","dir":"Articles","previous_headings":"Mathematical Framework","what":"4. Population Size Correction (Optional)","title":"Theory & Methods","text":"population.size = TRUE, communication weighted cell type abundance: Comms→rweighted=Comms→r×nsN×nrN\\text{Comm}_{s \\r}^{\\text{weighted}} = \\text{Comm}_{s \\r} \\times \\sqrt{\\frac{n_s}{N} \\times \\frac{n_r}{N}} ns,nrn_s, n_r cell counts NN total cells. Rationale: Larger cell populations contribute tissue-level signaling.","code":""},{"path":[]},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/theory.html","id":"permutation-test","dir":"Articles","previous_headings":"Statistical Framework","what":"Permutation Test","title":"Theory & Methods","text":"assess significance, cell type labels randomly shuffled: Shuffle cell type labels BB times (default: 100-1000) Recalculate production, sensing, communication permutation Compute empirical p-value: p=1+∑b=1B𝟙[Commb≥Commobs]B+1p = \\frac{1 + \\sum_{b=1}^{B} \\mathbb{1}[\\text{Comm}_b \\geq \\text{Comm}_{\\text{obs}}]}{B + 1}","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/theory.html","id":"multiple-testing-correction","dir":"Articles","previous_headings":"Statistical Framework","what":"Multiple Testing Correction","title":"Theory & Methods","text":"Three strategies handling multiple comparisons: metabolite_stratified? Metabolites independent biological signals Global correction overly conservative Per-metabolite correction preserves biological interpretability","code":""},{"path":[]},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/theory.html","id":"key-assumptions","dir":"Articles","previous_headings":"","what":"Key Assumptions","title":"Theory & Methods","text":"Gene expression correlates protein activity: Enzyme/receptor expression levels reflect functional activity Metabolites can diffuse cells: Produced metabolites available sensing neighboring cells Cell type labels accurate: Incorrect annotations affect results Adequate cell sampling: cell type needs sufficient cells robust estimation","code":""},{"path":[]},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/theory.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"Theory & Methods","text":"Schafer, S., et al. (2023). MetalinksDB: knowledgebase metabolite-centric signaling. Nature Communications. Xiao, Z., et al. (2022). Metabolite-mediated intercellular communication tumor microenvironment. Frontiers Cell Developmental Biology.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/theory.html","id":"next","dir":"Articles","previous_headings":"","what":"Next","title":"Theory & Methods","text":"Production & Sensing Analysis: Detailed parameter tuning Communication Analysis: Advanced communication analysis Spatial Analysis: Spatial transcriptomics support","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/visualization.html","id":"setup","dir":"Articles","previous_headings":"","what":"Setup","title":"Visualization Gallery","text":"","code":"library(scMetaLink) library(Matrix)  # Run complete analysis data(crc_example) obj <- createScMetaLink(crc_expr, crc_meta, \"cell_type\") obj <- inferProduction(obj, verbose = FALSE) obj <- inferSensing(obj, verbose = FALSE) obj <- computeCommunication(obj, n_permutations = 100, verbose = FALSE) obj <- filterSignificantInteractions(obj, adjust_method = \"none\") # For demo"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/visualization.html","id":"communication-heatmap","dir":"Articles","previous_headings":"","what":"1. Communication Heatmap","title":"Visualization Gallery","text":"heatmap shows communication strength cell type pairs, rows representing sender cells columns representing receiver cells.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/visualization.html","id":"basic-heatmap","dir":"Articles","previous_headings":"1. Communication Heatmap","what":"Basic Heatmap","title":"Visualization Gallery","text":"Figure 1: Basic Communication Heatmap. Pairwise communication scores aggregated across significant metabolite interactions. Darker colors indicate stronger communication potential.","code":"plotCommunicationHeatmap(obj)"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/visualization.html","id":"customized-heatmap","dir":"Articles","previous_headings":"1. Communication Heatmap","what":"Customized Heatmap","title":"Visualization Gallery","text":"Figure 2: Customized Heatmap Clustering. Hierarchical clustering reveals cell type groups similar communication patterns.","code":"plotCommunicationHeatmap(   obj,   cluster_rows = TRUE, # Cluster senders   cluster_cols = TRUE, # Cluster receivers   show_values = FALSE # Show score values )"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/visualization.html","id":"metabolite-specific-heatmap","dir":"Articles","previous_headings":"1. Communication Heatmap","what":"Metabolite-Specific Heatmap","title":"Visualization Gallery","text":"","code":"# Create heatmap for specific metabolites sig <- obj@significant_interactions lactate_sig <- sig[sig$metabolite_name == \"L-Lactic acid\", ]  if (nrow(lactate_sig) > 0) {   # Build matrix   cell_types <- unique(c(lactate_sig$sender, lactate_sig$receiver))   mat <- matrix(0, length(cell_types), length(cell_types),     dimnames = list(cell_types, cell_types)   )   for (i in 1:nrow(lactate_sig)) {     mat[lactate_sig$sender[i], lactate_sig$receiver[i]] <- lactate_sig$communication_score[i]   }    heatmap(mat,     col = hcl.colors(50, \"Reds\"), scale = \"none\",     main = \"Lactate-Mediated Communication\"   ) }"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/visualization.html","id":"chord-diagram-circle-plot","dir":"Articles","previous_headings":"","what":"2. Chord Diagram (Circle Plot)","title":"Visualization Gallery","text":"Chord diagrams elegantly show flow communication cell types. width ribbon represents strength communication.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/visualization.html","id":"basic-chord","dir":"Articles","previous_headings":"2. Chord Diagram (Circle Plot)","what":"Basic Chord","title":"Visualization Gallery","text":"Figure 3: Communication Chord Diagram. Ribbons connect sender receiver cell types. Ribbon width proportional communication strength, colors represent sender cell type.","code":"plotCommunicationCircle(obj)"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/visualization.html","id":"customized-chord","dir":"Articles","previous_headings":"2. Chord Diagram (Circle Plot)","what":"Customized Chord","title":"Visualization Gallery","text":"Figure 4: Customized Chord Diagram. Enhanced visualization adjusted transparency showing top 30 interactions.","code":"plotCommunicationCircle(   obj,   top_n = 30, # Top interactions   transparency = 0.4, # Link opacity (0-1)   title = \"Top 30 Metabolic Communications\" )"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/visualization.html","id":"network-visualization","dir":"Articles","previous_headings":"","what":"3. Network Visualization","title":"Visualization Gallery","text":"Network plots show communication graph structure.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/visualization.html","id":"basic-network","dir":"Articles","previous_headings":"3. Network Visualization","what":"Basic Network","title":"Visualization Gallery","text":"","code":"plotCommunicationNetwork(obj)"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/visualization.html","id":"customized-network","dir":"Articles","previous_headings":"3. Network Visualization","what":"Customized Network","title":"Visualization Gallery","text":"","code":"plotCommunicationNetwork(   obj,   layout = \"circle\", # Layout algorithm: \"fr\", \"circle\", \"kk\", etc.   node_size_by = \"degree\", # Size by: \"degree\" or \"centrality\"   edge_width_scale = 3, # Scale factor for edge widths   min_score = 0.1 # Minimum score threshold )"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/visualization.html","id":"metabolite-profile-visualization","dir":"Articles","previous_headings":"","what":"4. Metabolite Profile Visualization","title":"Visualization Gallery","text":"Visualize production sensing profiles specific metabolites.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/visualization.html","id":"single-metabolite-profile","dir":"Articles","previous_headings":"4. Metabolite Profile Visualization","what":"Single Metabolite Profile","title":"Visualization Gallery","text":"Figure 5: Metabolite Profile. Production (left) sensing (right) scores across cell types specific metabolite.","code":"# Find a metabolite that exists in the data sig <- obj@significant_interactions if (nrow(sig) > 0) {   top_met <- names(sort(table(sig$metabolite_name), decreasing = TRUE))[1]   plotMetaboliteProfile(obj, metabolite = top_met) }"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/visualization.html","id":"production-vs-sensing-comparison","dir":"Articles","previous_headings":"4. Metabolite Profile Visualization","what":"Production vs Sensing Comparison","title":"Visualization Gallery","text":"","code":"# Compare profiles for multiple metabolites par(mfrow = c(2, 2)) top_mets <- names(sort(table(sig$metabolite_name), decreasing = TRUE))[1:4] for (met in top_mets) {   tryCatch(     {       plotMetaboliteProfile(obj, metabolite = met)       title(sub = met)     },     error = function(e) {       plot.new()       text(0.5, 0.5, paste(met, \"\\nNot found\"), cex = 1.2)     }   ) } par(mfrow = c(1, 1))"},{"path":[]},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/visualization.html","id":"cell-type-roles-producers-vs-sensors","dir":"Articles","previous_headings":"5. Production-Sensing Comparison","what":"Cell Type Roles: Producers vs Sensors","title":"Visualization Gallery","text":"Figure 6: Cell Type Metabolic Roles. point represents cell type. Position shows average production (x-axis) vs sensing (y-axis) potential. Cell types diagonal net sensors; net producers.","code":"# Get common metabolites prod_scores <- obj@production_scores sens_scores <- obj@sensing_scores common_mets <- intersect(rownames(prod_scores), rownames(sens_scores))  if (length(common_mets) > 0) {   avg_prod <- colMeans(prod_scores[common_mets, ])   avg_sens <- colMeans(sens_scores[common_mets, ])    plot(avg_prod, avg_sens,     xlab = \"Average Production Potential\",     ylab = \"Average Sensing Capability\",     main = \"Cell Type Metabolic Roles\",     pch = 19, cex = 1.5, col = \"#1976D2\"   )   text(avg_prod, avg_sens, names(avg_prod), pos = 3, cex = 0.7)   abline(0, 1, lty = 2, col = \"gray\") }"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/visualization.html","id":"specific-metabolite-production-vs-sensing","dir":"Articles","previous_headings":"5. Production-Sensing Comparison","what":"Specific Metabolite: Production vs Sensing","title":"Visualization Gallery","text":"Figure 7: Lactate Production Sensing. Comparison lactate production (orange) vs sensing (blue) across cell types, revealing communication axis.","code":"# Compare for a specific metabolite lactate_id <- \"HMDB0000190\"  if (lactate_id %in% rownames(prod_scores) && lactate_id %in% rownames(sens_scores)) {   prod <- prod_scores[lactate_id, ]   sens <- sens_scores[lactate_id, ]    par(mfrow = c(1, 2))   barplot(sort(prod, decreasing = TRUE),     las = 2, col = \"#FF7043\",     main = \"Lactate Production\", ylab = \"Score\", cex.names = 0.7   )   barplot(sort(sens, decreasing = TRUE),     las = 2, col = \"#42A5F5\",     main = \"Lactate Sensing\", ylab = \"Score\", cex.names = 0.7   )   par(mfrow = c(1, 1)) }"},{"path":[]},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/visualization.html","id":"cell-type-communication-summary","dir":"Articles","previous_headings":"6. Summary Statistics Plots","what":"Cell Type Communication Summary","title":"Visualization Gallery","text":"","code":"sig <- obj@significant_interactions  par(mfrow = c(1, 2))  # Outgoing outgoing <- aggregate(communication_score ~ sender, data = sig, FUN = sum) outgoing <- outgoing[order(-outgoing$communication_score), ] barplot(outgoing$communication_score,   names.arg = outgoing$sender,   las = 2, col = \"#FF7043\", main = \"Outgoing Signals\",   ylab = \"Total Communication\" )  # Incoming incoming <- aggregate(communication_score ~ receiver, data = sig, FUN = sum) incoming <- incoming[order(-incoming$communication_score), ] barplot(incoming$communication_score,   names.arg = incoming$receiver,   las = 2, col = \"#42A5F5\", main = \"Incoming Signals\",   ylab = \"Total Communication\" ) par(mfrow = c(1, 1))"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/visualization.html","id":"metabolite-distribution","dir":"Articles","previous_headings":"6. Summary Statistics Plots","what":"Metabolite Distribution","title":"Visualization Gallery","text":"","code":"met_counts <- table(sig$metabolite_name) met_counts <- sort(met_counts, decreasing = TRUE)  barplot(head(met_counts, 20),   las = 2, col = \"#9575CD\",   main = \"Top 20 Metabolite Mediators\",   ylab = \"Number of Significant Interactions\" )"},{"path":[]},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/visualization.html","id":"communication-matrix-with-ggplot2","dir":"Articles","previous_headings":"7. Custom Visualizations","what":"Communication Matrix with ggplot2","title":"Visualization Gallery","text":"","code":"library(ggplot2)  # Get communication matrix comm_mat <- getCommunicationMatrix(obj, aggregate_method = \"sum\")  # Convert to long format comm_df <- reshape2::melt(comm_mat) names(comm_df) <- c(\"Sender\", \"Receiver\", \"Score\")  ggplot(comm_df, aes(x = Receiver, y = Sender, fill = Score)) +   geom_tile(color = \"white\") +   scale_fill_gradient2(     low = \"white\", mid = \"#FFCDD2\", high = \"#C62828\",     midpoint = median(comm_df$Score[comm_df$Score > 0])   ) +   theme_minimal() +   theme(     axis.text.x = element_text(angle = 45, hjust = 1, size = 8),     axis.text.y = element_text(size = 8)   ) +   labs(     title = \"Cell-Cell Communication via Metabolites\",     fill = \"Score\"   )"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/visualization.html","id":"interaction-dot-plot","dir":"Articles","previous_headings":"7. Custom Visualizations","what":"Interaction Dot Plot","title":"Visualization Gallery","text":"","code":"# Top interactions as dot plot top_int <- head(sig[order(-sig$communication_score), ], 30) top_int$interaction <- paste(top_int$sender, \"->\", top_int$receiver)  ggplot(top_int, aes(x = metabolite_name, y = interaction)) +   geom_point(aes(size = communication_score, color = -log10(pvalue_adjusted))) +   scale_color_gradient(low = \"gray70\", high = \"red\") +   scale_size_continuous(range = c(2, 8)) +   theme_minimal() +   theme(     axis.text.x = element_text(angle = 45, hjust = 1, size = 8),     axis.text.y = element_text(size = 8)   ) +   labs(     title = \"Top Metabolite-Mediated Interactions\",     x = \"Metabolite\", y = \"Sender -> Receiver\",     size = \"Score\", color = \"-log10(p)\"   )"},{"path":[]},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/visualization.html","id":"combined-figure-panel","dir":"Articles","previous_headings":"8. Publication-Ready Figures","what":"Combined Figure Panel","title":"Visualization Gallery","text":"","code":"layout(matrix(c(1, 1, 2, 3, 3, 4), nrow = 2, byrow = TRUE),   widths = c(2, 2, 2), heights = c(1, 1) )  # Panel A: Heatmap comm_mat <- getCommunicationMatrix(obj) heatmap(comm_mat,   col = hcl.colors(50, \"Reds\"), scale = \"none\",   main = \"A. Communication Heatmap\", margins = c(8, 8) ) # Panel B: Top metabolites par(mar = c(8, 4, 4, 2)) met_counts <- head(sort(table(sig$metabolite_name), decreasing = TRUE), 10) barplot(met_counts,   las = 2, col = \"#7E57C2\",   main = \"B. Top Metabolites\" )  # Panel C: Chord par(mar = c(2, 2, 4, 2)) plotCommunicationCircle(obj, top_n = 20, title = \"C. Communication Network\")  # Panel D: Sender/Receiver summary par(mar = c(8, 4, 4, 2)) net_flow <- sapply(unique(c(sig$sender, sig$receiver)), function(ct) {   sum(sig$communication_score[sig$sender == ct]) -     sum(sig$communication_score[sig$receiver == ct]) }) net_flow <- sort(net_flow) cols <- ifelse(net_flow > 0, \"#FF7043\", \"#42A5F5\") barplot(net_flow, col = cols, las = 2, main = \"D. Net Communication Flow\") abline(h = 0)"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/visualization.html","id":"exporting-figures","dir":"Articles","previous_headings":"","what":"9. Exporting Figures","title":"Visualization Gallery","text":"","code":"# Save as PDF pdf(\"communication_heatmap.pdf\", width = 10, height = 8) plotCommunicationHeatmap(obj) dev.off()  # Save as PNG (high resolution) png(\"communication_chord.png\", width = 3000, height = 3000, res = 300) plotCommunicationCircle(obj) dev.off()  # Save as SVG (vector format) svg(\"communication_network.svg\", width = 10, height = 8) plotCommunicationNetwork(obj) dev.off()"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/visualization.html","id":"color-palettes-reference","dir":"Articles","previous_headings":"","what":"Color Palettes Reference","title":"Visualization Gallery","text":"","code":"# Available color palettes palettes <- c(\"RdYlBu\", \"Reds\", \"Blues\", \"Greens\", \"YlOrRd\", \"PuBuGn\", \"Spectral\")  par(mfrow = c(1, length(palettes))) for (pal in palettes) {   image(matrix(1:50, nrow = 1),     col = hcl.colors(50, pal),     axes = FALSE, main = pal   ) } par(mfrow = c(1, 1))"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/articles/visualization.html","id":"next-steps","dir":"Articles","previous_headings":"","what":"Next Steps","title":"Visualization Gallery","text":"Spatial Analysis: Spatial transcriptomics visualization Applications: Real-world analysis examples Explore parameter tuning optimal visualizations","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Zaoqu Liu. Author, maintainer.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Liu Z (2026). scMetaLink: Inferring metabolite-mediated cell-cell communication single-cell spatial transcriptomics data. R package version 0.99.0. https://github.com/Zaoqu-Liu/scMetaLink","code":"@Article{,   title = {scMetaLink: Inferring metabolite-mediated cell-cell communication from single-cell and spatial transcriptomics data},   author = {Zaoqu Liu},   journal = {Bioinformatics},   year = {2026},   note = {R package version 0.99.0},   url = {https://github.com/Zaoqu-Liu/scMetaLink}, }"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/index.html","id":"scmetalink","dir":"","previous_headings":"","what":"scMetaLink - Single-Cell Metabolite-Mediated Cell Communication","title":"scMetaLink - Single-Cell Metabolite-Mediated Cell Communication","text":"scMetaLink R package inferring metabolite-mediated cell-cell communication single-cell spatial transcriptomics data. 📖 Documentation: https://Zaoqu-Liu.github.io/scMetaLink/","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/index.html","id":"background","dir":"","previous_headings":"","what":"Background","title":"scMetaLink - Single-Cell Metabolite-Mediated Cell Communication","text":"Metabolites serve critical signaling molecules cellular microenvironment. tools like CellChat CellPhoneDB advanced understanding ligand-receptor interactions, metabolic dimension intercellular communication remains underexplored. scMetaLink addresses gap integrating enzyme expression, transporter activity, receptor-metabolite interactions reconstruct metabolite-mediated communication networks.","code":""},{"path":[]},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/index.html","id":"features","dir":"","previous_headings":"","what":"Features","title":"scMetaLink - Single-Cell Metabolite-Mediated Cell Communication","text":"Metabolite Production Inference: Estimate metabolite production potential based biosynthetic enzyme expression Metabolite Sensing Analysis: Quantify sensing capability via receptors (GPCRs, nuclear receptors) transporters Statistical Framework: Permutation-based significance testing multiple hypothesis correction Pathway Integration: Aggregate communication patterns pathway level Spatial Transcriptomics: Distance-weighted communication analysis spatial data Visualization: Heatmaps, chord diagrams, network plots, spatial maps","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/index.html","id":"database","dir":"","previous_headings":"","what":"Database","title":"scMetaLink - Single-Cell Metabolite-Mediated Cell Communication","text":"scMetaLink utilizes MetalinksDB, containing: 41,894 metabolite-protein interactions 1,128 metabolites 4,374 proteins/genes 157,741 pathway associations","code":""},{"path":[]},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/index.html","id":"from-r-universe-recommended","dir":"","previous_headings":"Installation","what":"From r-universe (Recommended)","title":"scMetaLink - Single-Cell Metabolite-Mediated Cell Communication","text":"","code":"install.packages(\"scMetaLink\", repos = \"https://zaoqu-liu.r-universe.dev\")"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/index.html","id":"from-github","dir":"","previous_headings":"Installation","what":"From GitHub","title":"scMetaLink - Single-Cell Metabolite-Mediated Cell Communication","text":"","code":"# Install devtools if needed if (!require(\"devtools\")) install.packages(\"devtools\")  devtools::install_github(\"Zaoqu-Liu/scMetaLink\")"},{"path":[]},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/index.html","id":"single-cell-analysis","dir":"","previous_headings":"Quick Start","what":"Single-Cell Analysis","title":"scMetaLink - Single-Cell Metabolite-Mediated Cell Communication","text":"Seurat users:","code":"library(scMetaLink)  # Create scMetaLink object obj <- createScMetaLink(   expression_data = expr_matrix,   cell_meta = cell_metadata,   cell_type_column = \"cell_type\" )  # Infer metabolite production and sensing obj <- inferProduction(obj) obj <- inferSensing(obj)  # Compute communication with significance testing obj <- computeCommunication(obj, n_permutations = 1000) obj <- filterSignificantInteractions(obj, pvalue_threshold = 0.05)  # Visualize results plotCommunicationHeatmap(obj) plotCommunicationCircle(obj) result <- runScMetaLinkSeurat(seurat_obj, cell_type_column = \"cell_type\")"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/index.html","id":"spatial-transcriptomics-analysis","dir":"","previous_headings":"","what":"Spatial Transcriptomics Analysis","title":"scMetaLink - Single-Cell Metabolite-Mediated Cell Communication","text":"scMetaLink supports spatial transcriptomics data distance-weighted communication analysis.","code":""},{"path":[]},{"path":[]},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/index.html","id":"spatial-quick-start","dir":"","previous_headings":"Spatial Transcriptomics Analysis","what":"Spatial Quick Start","title":"scMetaLink - Single-Cell Metabolite-Mediated Cell Communication","text":"","code":"library(scMetaLink)  # Load spatial data data(st_expr) data(st_meta) data(st_scalefactors)  # Create spatial scMetaLink object obj <- createScMetaLinkFromSpatial(   expression_data = st_expr,   spatial_coords = st_meta[, c(\"x\", \"y\")],   cell_meta = st_meta,   cell_type_column = \"cell_type\",   scale_factors = st_scalefactors )  # Infer production and sensing obj <- inferProduction(obj) obj <- inferSensing(obj)  # Compute spatially-weighted communication obj <- computeSpatialCommunication(   obj,   method = \"knn\",        # K-nearest neighbors (recommended for Visium)   k_neighbors = 6,       # Hexagonal grid neighbors   n_permutations = 1000 )  # Filter and visualize obj <- filterSignificantInteractions(obj) plotSpatialCellTypes(obj) plotSpatialCommunicationNetwork(obj) plotSpatialFeature(obj, metabolite = \"L-Lactic acid\", type = \"production\")"},{"path":[]},{"path":[]},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/index.html","id":"metabolite-production-potential-mpp","dir":"","previous_headings":"Methodology","what":"Metabolite Production Potential (MPP)","title":"scMetaLink - Single-Cell Metabolite-Mediated Cell Communication","text":"MPP(m,c)=∑e∈Em+⋅expr(e,c)|Em+|⋅S(m)MPP(m, c) = \\frac{\\sum_{e \\E_m^+} w_e \\cdot \\text{expr}(e, c)}{|E_m^+|} \\cdot S(m) Em+E_m^+ denotes biosynthetic enzymes metabolite mm, wew_e evidence weight, S(m)S(m) represents secretion potential.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/index.html","id":"metabolite-sensing-capability-msc","dir":"","previous_headings":"Methodology","what":"Metabolite Sensing Capability (MSC)","title":"scMetaLink - Single-Cell Metabolite-Mediated Cell Communication","text":"MSC(m,c)=∑r∈Rmwr⋅τ(r)⋅expr(r,c)MSC(m, c) = \\sum_{r \\R_m} w_r \\cdot \\tau(r) \\cdot \\text{expr}(r, c) RmR_m includes receptors transporters metabolite mm, τ(r)\\tau(r) receptor type weight.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/index.html","id":"communication-score","dir":"","previous_headings":"Methodology","what":"Communication Score","title":"scMetaLink - Single-Cell Metabolite-Mediated Cell Communication","text":"C(s→r,m)=MPP(m,s)×MSC(m,r)C(s \\rightarrow r, m) = \\sqrt{MPP(m, s) \\times MSC(m, r)}","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/index.html","id":"spatial-communication-score","dir":"","previous_headings":"Methodology","what":"Spatial Communication Score","title":"scMetaLink - Single-Cell Metabolite-Mediated Cell Communication","text":"Cspatial(s→r,m)=MPP(m,s)×MSC(m,r)×w(dsr)C_{spatial}(s \\rightarrow r, m) = \\sqrt{MPP(m, s) \\times MSC(m, r)} \\times w(d_{sr}) w(d)w(d) spatial weight function (e.g., Gaussian decay). Statistical significance assessed via permutation testing FDR correction.","code":""},{"path":[]},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/index.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"scMetaLink - Single-Cell Metabolite-Mediated Cell Communication","text":"use scMetaLink research, please cite:","code":"Liu Z, et al. (2026). scMetaLink: Inferring metabolite-mediated cell-cell communication from single-cell and spatial transcriptomics data."},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/index.html","id":"contact","dir":"","previous_headings":"","what":"Contact","title":"scMetaLink - Single-Cell Metabolite-Mediated Cell Communication","text":"Author: Zaoqu Liu Email: liuzaoqu@163.com GitHub: https://github.com/Zaoqu-Liu/scMetaLink","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/accessors.html","id":null,"dir":"Reference","previous_headings":"","what":"Accessor Functions for scMetaLink Objects — accessors","title":"Accessor Functions for scMetaLink Objects — accessors","text":"Functions extract data scMetaLink objects.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/accessors.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Accessor Functions for scMetaLink Objects — accessors","text":"","code":"getProductionScores(object)  # S4 method for class 'scMetaLink' getProductionScores(object)  getSensingScores(object)  # S4 method for class 'scMetaLink' getSensingScores(object)  getCommunicationScores(object)  # S4 method for class 'scMetaLink' getCommunicationScores(object)  getSignificantInteractions(object)  # S4 method for class 'scMetaLink' getSignificantInteractions(object)  getPathwayAggregated(object)  # S4 method for class 'scMetaLink' getPathwayAggregated(object)  getParameters(object)  # S4 method for class 'scMetaLink' getParameters(object)"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/accessors.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Accessor Functions for scMetaLink Objects — accessors","text":"object scMetaLink object","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/accessors.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Accessor Functions for scMetaLink Objects — accessors","text":"requested data scMetaLink object: getProductionScores: Matrix metabolite production scores getSensingScores: Matrix metabolite sensing scores getCommunicationScores: 3D array communication scores getSignificantInteractions: data.frame significant interactions getPathwayAggregated: data.frame pathway-aggregated results getParameters: list analysis parameters","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/accessors.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Accessor Functions for scMetaLink Objects — accessors","text":"","code":"# \\donttest{ data(crc_example) obj <- createScMetaLink(crc_expr, crc_meta, \"cell_type\") #> Created scMetaLink object with 4210 genes, 2850 cells, 15 cell types obj <- inferProduction(obj) #> Inferring production potential for 15 cell types... #>   Calculating cell type expression profiles... #>   Building metabolite-gene mapping... #>   Found 15606 production enzyme-metabolite pairs #>   Computing production scores (matrix multiplication)... #>   Adjusting for degradation... #>   Applying secretion potential weights... #>   Normalizing scores... #>   Computed production scores for 790 metabolites #> Done! prod_scores <- getProductionScores(obj) # }"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/aggregateByPathway.html","id":null,"dir":"Reference","previous_headings":"","what":"Aggregate Communication by Pathway — aggregateByPathway","title":"Aggregate Communication by Pathway — aggregateByPathway","text":"Aggregate metabolite-mediated communication pathway level.   Due large number pathway associations, function uses   simplified approach focusing top pathways.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/aggregateByPathway.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Aggregate Communication by Pathway — aggregateByPathway","text":"","code":"aggregateByPathway(object, top_pathways = 50, min_metabolites = 3)"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/aggregateByPathway.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Aggregate Communication by Pathway — aggregateByPathway","text":"object scMetaLink object significant interactions top_pathways Integer. Number top pathways analyze (default: 50) min_metabolites Integer. Minimum metabolites per pathway (default: 3)","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/aggregateByPathway.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Aggregate Communication by Pathway — aggregateByPathway","text":"Updated scMetaLink object pathway_aggregated slot filled","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/checkLactateGenes.html","id":null,"dir":"Reference","previous_headings":"","what":"Check Lactate Gene Availability — checkLactateGenes","title":"Check Lactate Gene Availability — checkLactateGenes","text":"Checks lactate signaling genes available expression data. Useful quality control running analysis.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/checkLactateGenes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check Lactate Gene Availability — checkLactateGenes","text":"","code":"checkLactateGenes(object)"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/checkLactateGenes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check Lactate Gene Availability — checkLactateGenes","text":"object scMetaLink object","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/checkLactateGenes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check Lactate Gene Availability — checkLactateGenes","text":"data.frame showing gene availability category","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/checkLactateGenes.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Check Lactate Gene Availability — checkLactateGenes","text":"","code":"# \\donttest{ data(crc_example) obj <- createScMetaLink(crc_expr, crc_meta, \"cell_type\") #> Created scMetaLink object with 4210 genes, 2850 cells, 15 cell types checkLactateGenes(obj) #> Lactate Gene Availability Summary: #> ================================== #>          category    available #>       degradation   2/2 (100%) #>    direct_sensing   1/1 (100%) #>  indirect_sensing   4/4 (100%) #>        production 10/10 (100%) #>            uptake   3/3 (100%) #>  # }"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/citationScMetaLink.html","id":null,"dir":"Reference","previous_headings":"","what":"Show Package Citation — citationScMetaLink","title":"Show Package Citation — citationScMetaLink","text":"Display recommended citation scMetaLink","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/citationScMetaLink.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Show Package Citation — citationScMetaLink","text":"","code":"citationScMetaLink()"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/citationScMetaLink.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Show Package Citation — citationScMetaLink","text":"Invisibly returns NULL, prints citation information","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/citationScMetaLink.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Show Package Citation — citationScMetaLink","text":"","code":"citationScMetaLink() #>  #> To cite scMetaLink in publications, please use: #>  #>   Liu Z (2026). scMetaLink: Inferring metabolite-mediated cell-cell #>   communication from single-cell transcriptomic data. #>   R package version 0.99.0. #>   https://github.com/Zaoqu-Liu/scMetaLink #>  #> A BibTeX entry for LaTeX users is: #>  #>   @Manual{, #>     title = {scMetaLink: Single-Cell Metabolite-Mediated Cell Communication Analysis}, #>     author = {Zaoqu Liu}, #>     year = {2026}, #>     note = {R package version 0.99.0}, #>     url = {https://github.com/Zaoqu-Liu/scMetaLink}, #>   } #>"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/compareCommunication.html","id":null,"dir":"Reference","previous_headings":"","what":"Compare Two Conditions — compareCommunication","title":"Compare Two Conditions — compareCommunication","text":"Compare metabolite-mediated communication two conditions","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/compareCommunication.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compare Two Conditions — compareCommunication","text":"","code":"compareCommunication(   object1,   object2,   condition_names = c(\"Condition1\", \"Condition2\"),   method = \"log2fc\" )"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/compareCommunication.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compare Two Conditions — compareCommunication","text":"object1 scMetaLink object condition 1 object2 scMetaLink object condition 2 condition_names Character vector length 2 condition names method Character. Comparison method: \"difference\", \"ratio\", \"log2fc\"","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/compareCommunication.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compare Two Conditions — compareCommunication","text":"data.frame differential communication results","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/compareCommunication.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compare Two Conditions — compareCommunication","text":"","code":"# \\donttest{ # Compare tumor vs normal diff <- compareCommunication(tumor_obj, normal_obj,   condition_names = c(\"Tumor\", \"Normal\") ) #> Error: object 'tumor_obj' not found # }"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/computeCommunication.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute Metabolite-Mediated Cell Communication — computeCommunication","title":"Compute Metabolite-Mediated Cell Communication — computeCommunication","text":"Calculate communication scores cell type pairs   mediated metabolites. Communication strength represents potential   signal transmission sender receiver cells via metabolites.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/computeCommunication.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute Metabolite-Mediated Cell Communication — computeCommunication","text":"","code":"computeCommunication(   object,   method = \"geometric\",   min_production = 0.1,   min_sensing = 0.1,   population.size = FALSE,   n_permutations = 100,   n_cores = 1,   seed = 42,   verbose = TRUE )"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/computeCommunication.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute Metabolite-Mediated Cell Communication — computeCommunication","text":"object scMetaLink object production sensing scores method Character. Communication score method: \"geometric\" (default), \"product\", \"harmonic\" min_production Numeric. Minimum production score threshold (0-1) min_sensing Numeric. Minimum sensing score threshold (0-1) population.size Logical. Whether weight communication cell type population sizes. TRUE, communication strength scaled relative abundance sender receiver cell types, reflecting biological reality larger populations contribute overall tissue signaling. n_permutations Integer. Number permutations significance testing (0 skip) n_cores Integer. Number cores parallel computing seed Integer. Random seed reproducibility verbose Logical. Print progress messages","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/computeCommunication.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute Metabolite-Mediated Cell Communication — computeCommunication","text":"Updated scMetaLink object communication_scores p-values","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/computeCommunication.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compute Metabolite-Mediated Cell Communication — computeCommunication","text":"communication score combines production sensing capabilities: geometric: sqrt(production * sensing) - balanced measure product: production * sensing - emphasizes strong bilateral signals harmonic: 2*production*sensing/(production+sensing) - penalizes imbalance population.size = TRUE, scores multiplied : sqrt(n_sender/n_total * n_receiver/n_total), accounts relative contribution cell type tissue-level communication.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/computeSpatialCommunication.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute Spatial Communication — computeSpatialCommunication","title":"Compute Spatial Communication — computeSpatialCommunication","text":"Calculate spatially-weighted metabolite-mediated communication.   function incorporates spatial distance spots weight   communication strength.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/computeSpatialCommunication.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute Spatial Communication — computeSpatialCommunication","text":"","code":"computeSpatialCommunication(   object,   method = \"knn\",   k_neighbors = 6,   symmetric = TRUE,   distance_threshold = 150,   sigma = 50,   lambda = 50,   comm_method = \"geometric\",   min_production = 0.1,   min_sensing = 0.1,   analysis_level = \"region\",   n_permutations = 1000,   n_cores = 1,   seed = 42,   verbose = TRUE )"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/computeSpatialCommunication.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute Spatial Communication — computeSpatialCommunication","text":"object scMetaLink object spatial information production/sensing scores method Character. Spatial weighting method: \"knn\": K-nearest neighbors (recommended Visium, honest     given resolution limitations) \"gaussian\": Gaussian decay exp(-d^2/2*sigma^2) \"exponential\": Exponential decay exp(-d/lambda) \"linear\": Linear decay max(0, 1 - d/d_max) \"threshold\": Binary cutoff (1 d <= threshold, 0 otherwise) k_neighbors Integer. Number nearest neighbors knn method. Default: 6. Visium hexagonal grid, 6 corresponds immediate neighbors. **Note**: weight matrix symmetrized, actual neighbor count per spot may exceed k (typically k 2k). symmetric Logical. Whether symmetrize KNN weight matrix (default: TRUE). TRUE, spot neighbor B, B also considered neighbor . ensures bidirectional communication potential. distance_threshold Numeric. Maximum distance communication micrometers. Spot pairs beyond distance considered non-interacting. Default: 150 um. Note: metabolites effective diffusion ranges 10-200 um tissue. Visium data (100 um spot spacing), values >200 um rarely meaningful. sigma Numeric. Sigma parameter Gaussian decay (um). Default: 50 um. Represents characteristic decay distance. Literature suggests: Fast-turnover metabolites (adenosine, ATP): 20-30 um Medium-range metabolites (lactate): 50-80 um Stable metabolites (amino acids): 80-120 um lambda Numeric. Lambda parameter exponential decay (um). Default: 50 um. comm_method Character. Communication score method: \"geometric\", \"product\", \"harmonic\" min_production Numeric. Minimum production score threshold (0-1). Cell types production score considered non-producers. min_sensing Numeric. Minimum sensing score threshold (0-1). Cell types sensing score considered non-sensors. analysis_level Character. Level analysis: \"region\": Aggregate cell type (default, recommended).     Uses full inferProduction/inferSensing logic. \"spot\": Compute spot--spot communication.     **WARNING**: simplified implementation exploratory analysis.     include: degradation adjustment, secretion weighting,     Hill transformation, full normalization. Use hotspot identification . n_permutations Integer. Number permutations significance testing. Default: 1000. publication, recommend >= 1000 permutations. permutation test shuffles cell type labels preserving spatial structure, **recalculates production sensing scores** scratch (consistent non-spatial version), scientifically correct null model testing whether communication patterns associated cell type identity. n_cores Integer. Number cores parallel computing seed Integer. Random seed reproducibility verbose Logical. Print progress messages","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/computeSpatialCommunication.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute Spatial Communication — computeSpatialCommunication","text":"Updated scMetaLink object spatial_communication slot","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/computeSpatialCommunication.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compute Spatial Communication — computeSpatialCommunication","text":"**Important Notes Spatial Resolution:** Visium data (55 um spots, ~100 um spacing), spot contains 1-10 cells. means: Cell type annotations ideally come deconvolution methods     (e.g., RCTD, cell2location, SPOTlight) \"knn\" method (k=6) recommended considers immediate     neighbors, honest given resolution limitations Distance-weighted methods (gaussian, exponential) may provide     \"false precision\" spot spacing similar metabolite diffusion distance **Permutation Test Design:** permutation test shuffles cell type labels (spatial positions) **recalculates production/sensing scores expression data**. consistent non-spatial version tests whether observed communication pattern associated cell type identity beyond expected chance. **Spatial communication modeled :** $$C_{spatial}(-> j, m) = MPP(m, ) * MSC(m, j) * w(d_{ij})$$ w(d) spatial weight function: Gaussian: w(d) = exp(-d^2 / 2*sigma^2) Exponential: w(d) = exp(-d / lambda) Linear: w(d) = max(0, 1 - d/d_max) Threshold: w(d) = (d <= d_threshold)","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/computeSpatialCommunication.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute Spatial Communication — computeSpatialCommunication","text":"","code":"# \\donttest{ data(st_expr) data(st_meta) data(st_scalefactors)  # Create object and run analysis obj <- createScMetaLinkFromSpatial(st_expr, st_meta[,c(\"x\",\"y\")],                                    st_meta, \"cell_type\", st_scalefactors) #> Created spatial scMetaLink object with 4284 genes, 1000 spots, 6 cell types obj <- inferProduction(obj) #> Inferring production potential for 6 cell types... #>   Calculating cell type expression profiles... #>   Building metabolite-gene mapping... #>   Found 15699 production enzyme-metabolite pairs #>   Computing production scores (matrix multiplication)... #>   Adjusting for degradation... #>   Applying secretion potential weights... #>   Normalizing scores... #>   Computed production scores for 796 metabolites #> Done! obj <- inferSensing(obj) #> Inferring sensing capability for 6 cell types... #>   Calculating cell type expression profiles... #>   Building metabolite-receptor mapping... #>   Found 12959 receptor-metabolite pairs #>   Computing sensing scores (matrix multiplication)... #>   Normalizing scores... #>   Computed sensing scores for 499 metabolites #> Done!  # Compute spatial communication (knn method recommended for Visium) obj <- computeSpatialCommunication(obj, method = \"knn\", k_neighbors = 6) #> Computing spatial communication (region level)... #>   Method: knn, threshold: 150 um, 1000 spots #>   Computing distance matrix... #>   Computing spatial weights... #>   Metabolites: 288, Cell types: 6 #>   Running 1000 spatial permutations... #>    |                                                                               |                                                                      |   0%   |                                                                               |                                                                      |   1%   |                                                                               |=                                                                     |   1%   |                                                                               |=                                                                     |   2%   |                                                                               |==                                                                    |   2%   |                                                                               |==                                                                    |   3%   |                                                                               |==                                                                    |   4%   |                                                                               |===                                                                   |   4%   |                                                                               |===                                                                   |   5%   |                                                                               |====                                                                  |   5%   |                                                                               |====                                                                  |   6%   |                                                                               |=====                                                                 |   6%   |                                                                               |=====                                                                 |   7%   |                                                                               |=====                                                                 |   8%   |                                                                               |======                                                                |   8%   |                                                                               |======                                                                |   9%   |                                                                               |=======                                                               |   9%   |                                                                               |=======                                                               |  10%   |                                                                               |=======                                                               |  11%   |                                                                               |========                                                              |  11%   |                                                                               |========                                                              |  12%   |                                                                               |=========                                                             |  12%   |                                                                               |=========                                                             |  13%   |                                                                               |=========                                                             |  14%   |                                                                               |==========                                                            |  14%   |                                                                               |==========                                                            |  15%   |                                                                               |===========                                                           |  15%   |                                                                               |===========                                                           |  16%   |                                                                               |============                                                          |  16%   |                                                                               |============                                                          |  17%   |                                                                               |============                                                          |  18%   |                                                                               |=============                                                         |  18%   |                                                                               |=============                                                         |  19%   |                                                                               |==============                                                        |  19%   |                                                                               |==============                                                        |  20%   |                                                                               |==============                                                        |  21%   |                                                                               |===============                                                       |  21%   |                                                                               |===============                                                       |  22%   |                                                                               |================                                                      |  22%   |                                                                               |================                                                      |  23%   |                                                                               |================                                                      |  24%   |                                                                               |=================                                                     |  24%   |                                                                               |=================                                                     |  25%   |                                                                               |==================                                                    |  25%   |                                                                               |==================                                                    |  26%   |                                                                               |===================                                                   |  26%   |                                                                               |===================                                                   |  27%   |                                                                               |===================                                                   |  28%   |                                                                               |====================                                                  |  28%   |                                                                               |====================                                                  |  29%   |                                                                               |=====================                                                 |  29%   |                                                                               |=====================                                                 |  30%   |                                                                               |=====================                                                 |  31%   |                                                                               |======================                                                |  31%   |                                                                               |======================                                                |  32%   |                                                                               |=======================                                               |  32%   |                                                                               |=======================                                               |  33%   |                                                                               |=======================                                               |  34%   |                                                                               |========================                                              |  34%   |                                                                               |========================                                              |  35%   |                                                                               |=========================                                             |  35%   |                                                                               |=========================                                             |  36%   |                                                                               |==========================                                            |  36%   |                                                                               |==========================                                            |  37%   |                                                                               |==========================                                            |  38%   |                                                                               |===========================                                           |  38%   |                                                                               |===========================                                           |  39%   |                                                                               |============================                                          |  39%   |                                                                               |============================                                          |  40%   |                                                                               |============================                                          |  41%   |                                                                               |=============================                                         |  41%   |                                                                               |=============================                                         |  42%   |                                                                               |==============================                                        |  42%   |                                                                               |==============================                                        |  43%   |                                                                               |==============================                                        |  44%   |                                                                               |===============================                                       |  44%   |                                                                               |===============================                                       |  45%   |                                                                               |================================                                      |  45%   |                                                                               |================================                                      |  46%   |                                                                               |=================================                                     |  46%   |                                                                               |=================================                                     |  47%   |                                                                               |=================================                                     |  48%   |                                                                               |==================================                                    |  48%   |                                                                               |==================================                                    |  49%   |                                                                               |===================================                                   |  49%   |                                                                               |===================================                                   |  50%   |                                                                               |===================================                                   |  51%   |                                                                               |====================================                                  |  51%   |                                                                               |====================================                                  |  52%   |                                                                               |=====================================                                 |  52%   |                                                                               |=====================================                                 |  53%   |                                                                               |=====================================                                 |  54%   |                                                                               |======================================                                |  54%   |                                                                               |======================================                                |  55%   |                                                                               |=======================================                               |  55%   |                                                                               |=======================================                               |  56%   |                                                                               |========================================                              |  56%   |                                                                               |========================================                              |  57%   |                                                                               |========================================                              |  58%   |                                                                               |=========================================                             |  58%   |                                                                               |=========================================                             |  59%   |                                                                               |==========================================                            |  59%   |                                                                               |==========================================                            |  60%   |                                                                               |==========================================                            |  61%   |                                                                               |===========================================                           |  61%   |                                                                               |===========================================                           |  62%   |                                                                               |============================================                          |  62%   |                                                                               |============================================                          |  63%   |                                                                               |============================================                          |  64%   |                                                                               |=============================================                         |  64%   |                                                                               |=============================================                         |  65%   |                                                                               |==============================================                        |  65%   |                                                                               |==============================================                        |  66%   |                                                                               |===============================================                       |  66%   |                                                                               |===============================================                       |  67%   |                                                                               |===============================================                       |  68%   |                                                                               |================================================                      |  68%   |                                                                               |================================================                      |  69%   |                                                                               |=================================================                     |  69%   |                                                                               |=================================================                     |  70%   |                                                                               |=================================================                     |  71%   |                                                                               |==================================================                    |  71%   |                                                                               |==================================================                    |  72%   |                                                                               |===================================================                   |  72%   |                                                                               |===================================================                   |  73%   |                                                                               |===================================================                   |  74%   |                                                                               |====================================================                  |  74%   |                                                                               |====================================================                  |  75%   |                                                                               |=====================================================                 |  75%   |                                                                               |=====================================================                 |  76%   |                                                                               |======================================================                |  76%   |                                                                               |======================================================                |  77%   |                                                                               |======================================================                |  78%   |                                                                               |=======================================================               |  78%   |                                                                               |=======================================================               |  79%   |                                                                               |========================================================              |  79%   |                                                                               |========================================================              |  80%   |                                                                               |========================================================              |  81%   |                                                                               |=========================================================             |  81%   |                                                                               |=========================================================             |  82%   |                                                                               |==========================================================            |  82%   |                                                                               |==========================================================            |  83%   |                                                                               |==========================================================            |  84%   |                                                                               |===========================================================           |  84%   |                                                                               |===========================================================           |  85%   |                                                                               |============================================================          |  85%   |                                                                               |============================================================          |  86%   |                                                                               |=============================================================         |  86%   |                                                                               |=============================================================         |  87%   |                                                                               |=============================================================         |  88%   |                                                                               |==============================================================        |  88%   |                                                                               |==============================================================        |  89%   |                                                                               |===============================================================       |  89%   |                                                                               |===============================================================       |  90%   |                                                                               |===============================================================       |  91%   |                                                                               |================================================================      |  91%   |                                                                               |================================================================      |  92%   |                                                                               |=================================================================     |  92%   |                                                                               |=================================================================     |  93%   |                                                                               |=================================================================     |  94%   |                                                                               |==================================================================    |  94%   |                                                                               |==================================================================    |  95%   |                                                                               |===================================================================   |  95%   |                                                                               |===================================================================   |  96%   |                                                                               |====================================================================  |  96%   |                                                                               |====================================================================  |  97%   |                                                                               |====================================================================  |  98%   |                                                                               |===================================================================== |  98%   |                                                                               |===================================================================== |  99%   |                                                                               |======================================================================|  99%   |                                                                               |======================================================================| 100% #> Done!  # Alternative: Gaussian decay with conservative parameters obj <- computeSpatialCommunication(obj, method = \"gaussian\",                                    sigma = 50,  # 50 um decay                                    distance_threshold = 150)  # max 150 um #> Computing spatial communication (region level)... #>   Method: gaussian, threshold: 150 um, 1000 spots #>   Computing distance matrix... #>   Computing spatial weights... #>   Metabolites: 288, Cell types: 6 #>   Running 1000 spatial permutations... #>    |                                                                               |                                                                      |   0%   |                                                                               |                                                                      |   1%   |                                                                               |=                                                                     |   1%   |                                                                               |=                                                                     |   2%   |                                                                               |==                                                                    |   2%   |                                                                               |==                                                                    |   3%   |                                                                               |==                                                                    |   4%   |                                                                               |===                                                                   |   4%   |                                                                               |===                                                                   |   5%   |                                                                               |====                                                                  |   5%   |                                                                               |====                                                                  |   6%   |                                                                               |=====                                                                 |   6%   |                                                                               |=====                                                                 |   7%   |                                                                               |=====                                                                 |   8%   |                                                                               |======                                                                |   8%   |                                                                               |======                                                                |   9%   |                                                                               |=======                                                               |   9%   |                                                                               |=======                                                               |  10%   |                                                                               |=======                                                               |  11%   |                                                                               |========                                                              |  11%   |                                                                               |========                                                              |  12%   |                                                                               |=========                                                             |  12%   |                                                                               |=========                                                             |  13%   |                                                                               |=========                                                             |  14%   |                                                                               |==========                                                            |  14%   |                                                                               |==========                                                            |  15%   |                                                                               |===========                                                           |  15%   |                                                                               |===========                                                           |  16%   |                                                                               |============                                                          |  16%   |                                                                               |============                                                          |  17%   |                                                                               |============                                                          |  18%   |                                                                               |=============                                                         |  18%   |                                                                               |=============                                                         |  19%   |                                                                               |==============                                                        |  19%   |                                                                               |==============                                                        |  20%   |                                                                               |==============                                                        |  21%   |                                                                               |===============                                                       |  21%   |                                                                               |===============                                                       |  22%   |                                                                               |================                                                      |  22%   |                                                                               |================                                                      |  23%   |                                                                               |================                                                      |  24%   |                                                                               |=================                                                     |  24%   |                                                                               |=================                                                     |  25%   |                                                                               |==================                                                    |  25%   |                                                                               |==================                                                    |  26%   |                                                                               |===================                                                   |  26%   |                                                                               |===================                                                   |  27%   |                                                                               |===================                                                   |  28%   |                                                                               |====================                                                  |  28%   |                                                                               |====================                                                  |  29%   |                                                                               |=====================                                                 |  29%   |                                                                               |=====================                                                 |  30%   |                                                                               |=====================                                                 |  31%   |                                                                               |======================                                                |  31%   |                                                                               |======================                                                |  32%   |                                                                               |=======================                                               |  32%   |                                                                               |=======================                                               |  33%   |                                                                               |=======================                                               |  34%   |                                                                               |========================                                              |  34%   |                                                                               |========================                                              |  35%   |                                                                               |=========================                                             |  35%   |                                                                               |=========================                                             |  36%   |                                                                               |==========================                                            |  36%   |                                                                               |==========================                                            |  37%   |                                                                               |==========================                                            |  38%   |                                                                               |===========================                                           |  38%   |                                                                               |===========================                                           |  39%   |                                                                               |============================                                          |  39%   |                                                                               |============================                                          |  40%   |                                                                               |============================                                          |  41%   |                                                                               |=============================                                         |  41%   |                                                                               |=============================                                         |  42%   |                                                                               |==============================                                        |  42%   |                                                                               |==============================                                        |  43%   |                                                                               |==============================                                        |  44%   |                                                                               |===============================                                       |  44%   |                                                                               |===============================                                       |  45%   |                                                                               |================================                                      |  45%   |                                                                               |================================                                      |  46%   |                                                                               |=================================                                     |  46%   |                                                                               |=================================                                     |  47%   |                                                                               |=================================                                     |  48%   |                                                                               |==================================                                    |  48%   |                                                                               |==================================                                    |  49%   |                                                                               |===================================                                   |  49%   |                                                                               |===================================                                   |  50%   |                                                                               |===================================                                   |  51%   |                                                                               |====================================                                  |  51%   |                                                                               |====================================                                  |  52%   |                                                                               |=====================================                                 |  52%   |                                                                               |=====================================                                 |  53%   |                                                                               |=====================================                                 |  54%   |                                                                               |======================================                                |  54%   |                                                                               |======================================                                |  55%   |                                                                               |=======================================                               |  55%   |                                                                               |=======================================                               |  56%   |                                                                               |========================================                              |  56%   |                                                                               |========================================                              |  57%   |                                                                               |========================================                              |  58%   |                                                                               |=========================================                             |  58%   |                                                                               |=========================================                             |  59%   |                                                                               |==========================================                            |  59%   |                                                                               |==========================================                            |  60%   |                                                                               |==========================================                            |  61%   |                                                                               |===========================================                           |  61%   |                                                                               |===========================================                           |  62%   |                                                                               |============================================                          |  62%   |                                                                               |============================================                          |  63%   |                                                                               |============================================                          |  64%   |                                                                               |=============================================                         |  64%   |                                                                               |=============================================                         |  65%   |                                                                               |==============================================                        |  65%   |                                                                               |==============================================                        |  66%   |                                                                               |===============================================                       |  66%   |                                                                               |===============================================                       |  67%   |                                                                               |===============================================                       |  68%   |                                                                               |================================================                      |  68%   |                                                                               |================================================                      |  69%   |                                                                               |=================================================                     |  69%   |                                                                               |=================================================                     |  70%   |                                                                               |=================================================                     |  71%   |                                                                               |==================================================                    |  71%   |                                                                               |==================================================                    |  72%   |                                                                               |===================================================                   |  72%   |                                                                               |===================================================                   |  73%   |                                                                               |===================================================                   |  74%   |                                                                               |====================================================                  |  74%   |                                                                               |====================================================                  |  75%   |                                                                               |=====================================================                 |  75%   |                                                                               |=====================================================                 |  76%   |                                                                               |======================================================                |  76%   |                                                                               |======================================================                |  77%   |                                                                               |======================================================                |  78%   |                                                                               |=======================================================               |  78%   |                                                                               |=======================================================               |  79%   |                                                                               |========================================================              |  79%   |                                                                               |========================================================              |  80%   |                                                                               |========================================================              |  81%   |                                                                               |=========================================================             |  81%   |                                                                               |=========================================================             |  82%   |                                                                               |==========================================================            |  82%   |                                                                               |==========================================================            |  83%   |                                                                               |==========================================================            |  84%   |                                                                               |===========================================================           |  84%   |                                                                               |===========================================================           |  85%   |                                                                               |============================================================          |  85%   |                                                                               |============================================================          |  86%   |                                                                               |=============================================================         |  86%   |                                                                               |=============================================================         |  87%   |                                                                               |=============================================================         |  88%   |                                                                               |==============================================================        |  88%   |                                                                               |==============================================================        |  89%   |                                                                               |===============================================================       |  89%   |                                                                               |===============================================================       |  90%   |                                                                               |===============================================================       |  91%   |                                                                               |================================================================      |  91%   |                                                                               |================================================================      |  92%   |                                                                               |=================================================================     |  92%   |                                                                               |=================================================================     |  93%   |                                                                               |=================================================================     |  94%   |                                                                               |==================================================================    |  94%   |                                                                               |==================================================================    |  95%   |                                                                               |===================================================================   |  95%   |                                                                               |===================================================================   |  96%   |                                                                               |====================================================================  |  96%   |                                                                               |====================================================================  |  97%   |                                                                               |====================================================================  |  98%   |                                                                               |===================================================================== |  98%   |                                                                               |===================================================================== |  99%   |                                                                               |======================================================================|  99%   |                                                                               |======================================================================| 100% #> Done! # }"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/crc_expr.html","id":null,"dir":"Reference","previous_headings":"","what":"CRC Example Expression Data — crc_expr","title":"CRC Example Expression Data — crc_expr","text":"Example single-cell RNA-seq expression matrix colorectal cancer","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/crc_expr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"CRC Example Expression Data — crc_expr","text":"","code":"crc_expr"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/crc_expr.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"CRC Example Expression Data — crc_expr","text":"sparse dgCMatrix 4,210 genes (rows) x 2,850 cells (columns).   genes present MetalinksDB included reduce file size.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/crc_expr.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"CRC Example Expression Data — crc_expr","text":"CellScope package example data","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/crc_expr.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"CRC Example Expression Data — crc_expr","text":"subset colorectal cancer single-cell data containing: Tumor cells: Tumor Epithelial (600 cells) Immune cells: T (500), Plasma (250), B (150), TAM (150), Monocyte (120),         Normal Macrophage (150), Mast (30) Stromal cells: CAF (200), Normal Fibroblast (200), Endothelial (100),         Pericyte (50), SMC (30) Epithelial: Normal Epithelial (300) : Gliacyte (20)","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/crc_expr.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"CRC Example Expression Data — crc_expr","text":"","code":"# \\donttest{ data(crc_expr) #> Warning: data set ‘crc_expr’ not found data(crc_meta) #> Warning: data set ‘crc_meta’ not found  # Run scMetaLink analysis obj <- createScMetaLink(crc_expr, crc_meta, \"cell_type\") #> Created scMetaLink object with 4210 genes, 2850 cells, 15 cell types # }"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/crc_meta.html","id":null,"dir":"Reference","previous_headings":"","what":"CRC Example Cell Metadata — crc_meta","title":"CRC Example Cell Metadata — crc_meta","text":"Cell metadata CRC example dataset","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/crc_meta.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"CRC Example Cell Metadata — crc_meta","text":"","code":"crc_meta"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/crc_meta.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"CRC Example Cell Metadata — crc_meta","text":"data.frame 2,850 rows (cells) 3 columns: cell_type Cell type annotation (15 types) tumor_normal Tumor Normal tissue origin tissue_region Tissue region","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/crc_meta.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"CRC Example Cell Metadata — crc_meta","text":"","code":"# \\donttest{ data(crc_meta) #> Warning: data set ‘crc_meta’ not found table(crc_meta$cell_type) #>  #>                 B               CAF       Endothelial          Gliacyte  #>               150               200               100                20  #>              Mast          Monocyte Normal Epithelial Normal Fibroblast  #>                30               120               300               200  #> Normal Macrophage          Pericyte            Plasma               SMC  #>               150                50               250                30  #>                 T               TAM  Tumor Epithelial  #>               500               150               600  # }"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/createScMetaLink.html","id":null,"dir":"Reference","previous_headings":"","what":"Create scMetaLink Object — createScMetaLink","title":"Create scMetaLink Object — createScMetaLink","text":"Initialize scMetaLink object expression data cell metadata","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/createScMetaLink.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create scMetaLink Object — createScMetaLink","text":"","code":"createScMetaLink(   expression_data,   cell_meta,   cell_type_column = \"cell_type\",   min_cells = 10,   min_genes = 200 )"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/createScMetaLink.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create scMetaLink Object — createScMetaLink","text":"expression_data matrix dgCMatrix normalized expression values (genes x cells) cell_meta data.frame containing cell metadata cell_type_column Character. Column name cell_meta containing cell type annotations min_cells Integer. Minimum number cells per cell type (default: 10) min_genes Integer. Minimum number genes detected per cell (default: 200)","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/createScMetaLink.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create scMetaLink Object — createScMetaLink","text":"scMetaLink object","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/createScMetaLink.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create scMetaLink Object — createScMetaLink","text":"","code":"# \\donttest{ # Create from expression matrix expr_mat <- matrix(rpois(1000, 5), nrow = 100, ncol = 10) rownames(expr_mat) <- paste0(\"Gene\", 1:100) colnames(expr_mat) <- paste0(\"Cell\", 1:10) meta <- data.frame(cell_type = rep(c(\"TypeA\", \"TypeB\"), each = 5)) rownames(meta) <- colnames(expr_mat) obj <- createScMetaLink(expr_mat, meta, \"cell_type\") #> Error in createScMetaLink(expr_mat, meta, \"cell_type\"): No cell types with at least 10 cells # }"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/createScMetaLinkFromSeurat.html","id":null,"dir":"Reference","previous_headings":"","what":"Create scMetaLink from Seurat Object — createScMetaLinkFromSeurat","title":"Create scMetaLink from Seurat Object — createScMetaLinkFromSeurat","text":"Initialize scMetaLink object Seurat object","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/createScMetaLinkFromSeurat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create scMetaLink from Seurat Object — createScMetaLinkFromSeurat","text":"","code":"createScMetaLinkFromSeurat(   seurat_obj,   cell_type_column = \"cell_type\",   assay = \"RNA\",   slot = \"data\",   min_cells = 10 )"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/createScMetaLinkFromSeurat.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create scMetaLink from Seurat Object — createScMetaLinkFromSeurat","text":"seurat_obj Seurat object cell_type_column Character. Column name meta.data cell type assay Character. Assay use (default: \"RNA\") slot Character. Slot use (default: \"data\" normalized data) min_cells Integer. Minimum cells per cell type","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/createScMetaLinkFromSeurat.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create scMetaLink from Seurat Object — createScMetaLinkFromSeurat","text":"scMetaLink object","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/createScMetaLinkFromSeuratSpatial.html","id":null,"dir":"Reference","previous_headings":"","what":"Create scMetaLink from Seurat Spatial Object — createScMetaLinkFromSeuratSpatial","title":"Create scMetaLink from Seurat Spatial Object — createScMetaLinkFromSeuratSpatial","text":"Initialize scMetaLink object Seurat object spatial data","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/createScMetaLinkFromSeuratSpatial.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create scMetaLink from Seurat Spatial Object — createScMetaLinkFromSeuratSpatial","text":"","code":"createScMetaLinkFromSeuratSpatial(   seurat_obj,   cell_type_column = \"cell_type\",   assay = \"Spatial\",   slot = \"data\",   image = NULL,   min_cells = 5 )"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/createScMetaLinkFromSeuratSpatial.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create scMetaLink from Seurat Spatial Object — createScMetaLinkFromSeuratSpatial","text":"seurat_obj Seurat object spatial assay coordinates cell_type_column Character. Column name meta.data cell type assay Character. Assay use (default: \"Spatial\") slot Character. Slot use (default: \"data\" normalized data) image Character. Name spatial image use (default: first available) min_cells Integer. Minimum spots per cell type","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/createScMetaLinkFromSeuratSpatial.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create scMetaLink from Seurat Spatial Object — createScMetaLinkFromSeuratSpatial","text":"scMetaLink object spatial information","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/createScMetaLinkFromSpatial.html","id":null,"dir":"Reference","previous_headings":"","what":"Create scMetaLink Object from Spatial Data — createScMetaLinkFromSpatial","title":"Create scMetaLink Object from Spatial Data — createScMetaLinkFromSpatial","text":"Initialize scMetaLink object spatial transcriptomics data   spatial coordinate information.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/createScMetaLinkFromSpatial.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create scMetaLink Object from Spatial Data — createScMetaLinkFromSpatial","text":"","code":"createScMetaLinkFromSpatial(   expression_data,   spatial_coords,   cell_meta,   cell_type_column = \"cell_type\",   scale_factors = NULL,   min_cells = 5 )"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/createScMetaLinkFromSpatial.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create scMetaLink Object from Spatial Data — createScMetaLinkFromSpatial","text":"expression_data matrix dgCMatrix normalized expression values (genes x spots) spatial_coords data.frame matrix spatial coordinates (spots x 2). Must row names matching column names expression_data. cell_meta data.frame containing spot metadata (e.g., cell type deconvolution) cell_type_column Character. Column name cell_meta containing cell type annotations scale_factors List. Optional scale factors coordinate conversion. contain 'pixels_per_um' distance calculations. **IMPORTANT**: Visium data, coordinates pixels, micrometers. Without correct scale_factors, distance-based parameters wrong. min_cells Integer. Minimum number spots per cell type (default: 5)","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/createScMetaLinkFromSpatial.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create scMetaLink Object from Spatial Data — createScMetaLinkFromSpatial","text":"scMetaLink object spatial information","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/createScMetaLinkFromSpatial.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Create scMetaLink Object from Spatial Data — createScMetaLinkFromSpatial","text":"function creates scMetaLink object spatial information stored additional slots. spatial coordinates used distance-weighted communication analysis. **Important: Cell Type Annotation Visium Data** 10x Visium data, spot (55 micrometer diameter) typically contains 1-10 cells potentially different types. Therefore, cell type annotations ideally come deconvolution methods : RCTD (spacexr package) cell2location SPOTlight CARD using dominant cell type assignment per spot, aware simplification may miss important cell type heterogeneity within spots. **Important: Coordinate Units** 10x Visium data, coordinates typically pixels. MUST provide scale_factors 'pixels_per_um' convert micrometers biologically meaningful distance calculations. Without , sigma=50 interpreted 50 pixels instead 50 micrometers.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/createScMetaLinkFromSpatial.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create scMetaLink Object from Spatial Data — createScMetaLinkFromSpatial","text":"","code":"# \\donttest{ data(st_expr) data(st_meta) data(st_scalefactors)  obj <- createScMetaLinkFromSpatial(   expression_data = st_expr,   spatial_coords = st_meta[, c(\"x\", \"y\")],   cell_meta = st_meta,   cell_type_column = \"cell_type\",   scale_factors = st_scalefactors ) #> Created spatial scMetaLink object with 4284 genes, 1000 spots, 6 cell types # }"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-calc_direct_sensing.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate Direct Lactate Sensing Score (HCAR1) — .calc_direct_sensing","title":"Calculate Direct Lactate Sensing Score (HCAR1) — .calc_direct_sensing","text":"Calculates direct lactate sensing capability based HCAR1 expression, optionally weighted uptake transporter expression. DirectSensing = HCAR1_expression + beta * mean(Uptake_transporters)","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-calc_direct_sensing.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Direct Lactate Sensing Score (HCAR1) — .calc_direct_sensing","text":"","code":".calc_direct_sensing(   gene_scores,   gene_sets,   include_uptake = TRUE,   uptake_weight = 0.5 )"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-calc_direct_sensing.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Direct Lactate Sensing Score (HCAR1) — .calc_direct_sensing","text":"gene_scores Matrix gene scores (genes x cell_types) gene_sets Lactate gene sets .get_lactate_gene_sets() include_uptake Logical. Include MCT uptake transporters uptake_weight Numeric. Weight uptake contribution (default 0.5)","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-calc_direct_sensing.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate Direct Lactate Sensing Score (HCAR1) — .calc_direct_sensing","text":"Named numeric vector direct sensing scores per cell type","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-calc_lactate_communication.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate Lactate Communication Scores — .calc_lactate_communication","title":"Calculate Lactate Communication Scores — .calc_lactate_communication","text":"Combines production sensing scores cell-cell communication scores.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-calc_lactate_communication.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Lactate Communication Scores — .calc_lactate_communication","text":"","code":".calc_lactate_communication(   production_scores,   sensing_scores,   method = \"geometric\",   min_production = 0,   min_sensing = 0 )"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-calc_lactate_communication.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Lactate Communication Scores — .calc_lactate_communication","text":"production_scores Named numeric vector production scores sensing_scores Named numeric vector sensing scores method Character. Communication method: \"geometric\", \"product\", \"harmonic\" min_production Numeric. Minimum production threshold min_sensing Numeric. Minimum sensing threshold","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-calc_lactate_communication.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate Lactate Communication Scores — .calc_lactate_communication","text":"Matrix communication scores (sender x receiver)","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-calc_lactate_gene_scores.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate Cell Type Expression Profiles for Lactate Genes — .calc_lactate_gene_scores","title":"Calculate Cell Type Expression Profiles for Lactate Genes — .calc_lactate_gene_scores","text":"Calculates mean expression percentage expressing cells lactate-related genes across cell types.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-calc_lactate_gene_scores.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Cell Type Expression Profiles for Lactate Genes — .calc_lactate_gene_scores","text":"","code":".calc_lactate_gene_scores(   expr_data,   cell_meta,   cell_type_col,   genes,   min_expression = 0,   method = \"combined\" )"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-calc_lactate_gene_scores.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Cell Type Expression Profiles for Lactate Genes — .calc_lactate_gene_scores","text":"expr_data Expression matrix (genes x cells) cell_meta Cell metadata data.frame cell_type_col Column name cell type annotation genes Character vector genes analyze min_expression Minimum expression threshold method Scoring method: \"combined\", \"mean\", \"proportion\"","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-calc_lactate_gene_scores.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate Cell Type Expression Profiles for Lactate Genes — .calc_lactate_gene_scores","text":"Matrix gene scores (genes x cell_types)","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-calc_lactate_production.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate Lactate Production Score — .calc_lactate_production","title":"Calculate Lactate Production Score — .calc_lactate_production","text":"Calculates lactate production potential cell type based : Production = mean(Synthesis) * mean(Export) - alpha * mean(Degradation)","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-calc_lactate_production.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Lactate Production Score — .calc_lactate_production","text":"","code":".calc_lactate_production(   gene_scores,   gene_sets,   consider_export = TRUE,   consider_degradation = TRUE,   degradation_weight = 0.3 )"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-calc_lactate_production.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Lactate Production Score — .calc_lactate_production","text":"gene_scores Matrix gene scores (genes x cell_types) gene_sets Lactate gene sets .get_lactate_gene_sets() consider_export Logical. Weight export potential consider_degradation Logical. Subtract degradation degradation_weight Numeric. Weight degradation subtraction (default 0.3)","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-calc_lactate_production.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate Lactate Production Score — .calc_lactate_production","text":"Named numeric vector production scores per cell type","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-calc_proton_sensing.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate Indirect Proton Sensing Score (GPR4/65/68/132) — .calc_proton_sensing","title":"Calculate Indirect Proton Sensing Score (GPR4/65/68/132) — .calc_proton_sensing","text":"Calculates indirect lactate sensing capability proton-sensing GPCRs. Uses weighted mean based pH sensitivity strength receptor.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-calc_proton_sensing.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Indirect Proton Sensing Score (GPR4/65/68/132) — .calc_proton_sensing","text":"","code":".calc_proton_sensing(gene_scores, gene_sets, use_weights = TRUE)"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-calc_proton_sensing.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Indirect Proton Sensing Score (GPR4/65/68/132) — .calc_proton_sensing","text":"gene_scores Matrix gene scores (genes x cell_types) gene_sets Lactate gene sets .get_lactate_gene_sets() use_weights Logical. Use receptor-specific weights","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-calc_proton_sensing.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate Indirect Proton Sensing Score (GPR4/65/68/132) — .calc_proton_sensing","text":"Named numeric vector indirect sensing scores per cell type","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-calculate_celltype_expression_fast.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate Cell Type Expression Profiles — .calculate_celltype_expression_fast","title":"Calculate Cell Type Expression Profiles — .calculate_celltype_expression_fast","text":"Efficiently calculate mean expression percentage expressing   cells gene across cell types using vectorized operations.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-calculate_celltype_expression_fast.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Cell Type Expression Profiles — .calculate_celltype_expression_fast","text":"","code":".calculate_celltype_expression_fast(   expr_data,   cell_meta,   cell_type_col,   min_expression = 0,   mean_method = \"arithmetic\" )"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-calculate_celltype_expression_fast.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Cell Type Expression Profiles — .calculate_celltype_expression_fast","text":"expr_data Expression matrix (genes x cells) cell_meta Cell metadata data.frame cell_type_col Column name cell type annotation min_expression Minimum expression threshold mean_method Method calculating mean: \"arithmetic\" \"trimean\"","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-calculate_celltype_expression_fast.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate Cell Type Expression Profiles — .calculate_celltype_expression_fast","text":"List mean_expr pct_expr matrices","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-calculate_celltype_expression_fast.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate Cell Type Expression Profiles — .calculate_celltype_expression_fast","text":"trimean defined : (Q1 + 2*Q2 + Q3) / 4, Q1, Q2, Q3 25th, 50th, 75th percentiles respectively. provides robust estimate central tendency less sensitive outliers high dropout rates common single-cell RNA-seq data.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-clean_protein_type.html","id":null,"dir":"Reference","previous_headings":"","what":"Clean protein_type field (remove extra quotes) — .clean_protein_type","title":"Clean protein_type field (remove extra quotes) — .clean_protein_type","text":"Clean protein_type field (remove extra quotes)","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-clean_protein_type.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Clean protein_type field (remove extra quotes) — .clean_protein_type","text":"","code":".clean_protein_type(type_str)"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-compute_communication_scores.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute Communication Scores (Vectorized) — .compute_communication_scores","title":"Compute Communication Scores (Vectorized) — .compute_communication_scores","text":"Compute Communication Scores (Vectorized)","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-compute_communication_scores.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute Communication Scores (Vectorized) — .compute_communication_scores","text":"","code":".compute_communication_scores(   prod_scores,   sens_scores,   method,   min_production,   min_sensing,   pop_weights = NULL )"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-compute_communication_scores.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute Communication Scores (Vectorized) — .compute_communication_scores","text":"prod_scores Production score matrix (metabolites x cell_types) sens_scores Sensing score matrix (metabolites x cell_types) method Communication method min_production Minimum production threshold min_sensing Minimum sensing threshold pop_weights Optional population weight matrix (cell_types x cell_types)","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-compute_communication_scores.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute Communication Scores (Vectorized) — .compute_communication_scores","text":"3D array communication scores (sender x receiver x metabolite)","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-compute_spatial_communication_region.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute Region-Level Spatial Communication — .compute_spatial_communication_region","title":"Compute Region-Level Spatial Communication — .compute_spatial_communication_region","text":"Compute Region-Level Spatial Communication","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-compute_spatial_communication_region.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute Region-Level Spatial Communication — .compute_spatial_communication_region","text":"","code":".compute_spatial_communication_region(   prod_scores,   sens_scores,   weight_matrix,   cell_meta,   cell_type_col,   cell_types,   common_mets,   comm_method,   min_production,   min_sensing,   verbose )"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-compute_spatial_communication_spot.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute Spot-Level Spatial Communication (Simplified) — .compute_spatial_communication_spot","title":"Compute Spot-Level Spatial Communication (Simplified) — .compute_spatial_communication_spot","text":"Simplified spot-level communication exploratory analysis.   include: degradation adjustment, secretion weighting,   Hill transformation, full normalization.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-compute_spatial_communication_spot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute Spot-Level Spatial Communication (Simplified) — .compute_spatial_communication_spot","text":"","code":".compute_spatial_communication_spot(   object,   weight_matrix,   common_mets,   comm_method,   min_production,   min_sensing,   verbose )"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-compute_spatial_weights.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute Spatial Weight Matrix — .compute_spatial_weights","title":"Compute Spatial Weight Matrix — .compute_spatial_weights","text":"Compute Spatial Weight Matrix","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-compute_spatial_weights.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute Spatial Weight Matrix — .compute_spatial_weights","text":"","code":".compute_spatial_weights(   dist_matrix,   method,   threshold,   sigma,   lambda,   k = 6,   symmetric = TRUE )"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-compute_spatial_weights.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute Spatial Weight Matrix — .compute_spatial_weights","text":"dist_matrix Distance matrix (spots x spots) method Spatial weighting method threshold Distance threshold micrometers sigma Sigma parameter Gaussian decay lambda Lambda parameter exponential decay k Number nearest neighbors knn method symmetric Whether symmetrize KNN weight matrix","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-format_number.html","id":null,"dir":"Reference","previous_headings":"","what":"Format Number with Commas — .format_number","title":"Format Number with Commas — .format_number","text":"Format Number Commas","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-format_number.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Format Number with Commas — .format_number","text":"","code":".format_number(x)"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-get_colors.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Color Palette — .get_colors","title":"Get Color Palette — .get_colors","text":"Get Color Palette","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-get_colors.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Color Palette — .get_colors","text":"","code":".get_colors(n, palette = \"default\")"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-get_colors.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Color Palette — .get_colors","text":"n Number colors palette Character. Palette name","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-get_db_stats.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Database Statistics — .get_db_stats","title":"Get Database Statistics — .get_db_stats","text":"Get Database Statistics","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-get_db_stats.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Database Statistics — .get_db_stats","text":"","code":".get_db_stats(db)"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-get_degradation_enzymes.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Degradation Enzymes for Metabolites — .get_degradation_enzymes","title":"Get Degradation Enzymes for Metabolites — .get_degradation_enzymes","text":"Get Degradation Enzymes Metabolites","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-get_degradation_enzymes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Degradation Enzymes for Metabolites — .get_degradation_enzymes","text":"","code":".get_degradation_enzymes(db)"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-get_degradation_enzymes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Degradation Enzymes for Metabolites — .get_degradation_enzymes","text":"db MetalinksDB database list","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-get_degradation_enzymes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Degradation Enzymes for Metabolites — .get_degradation_enzymes","text":"data.frame degradation relationships","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-get_extracellular_metabolites.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Extracellular Metabolites — .get_extracellular_metabolites","title":"Get Extracellular Metabolites — .get_extracellular_metabolites","text":"Get Extracellular Metabolites","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-get_extracellular_metabolites.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Extracellular Metabolites — .get_extracellular_metabolites","text":"","code":".get_extracellular_metabolites(db)"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-get_extracellular_metabolites.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Extracellular Metabolites — .get_extracellular_metabolites","text":"db MetalinksDB database list","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-get_extracellular_metabolites.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Extracellular Metabolites — .get_extracellular_metabolites","text":"Character vector HMDB IDs extracellular metabolites","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-get_gene_contributions.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Gene Contributions for Lactate Signaling — .get_gene_contributions","title":"Get Gene Contributions for Lactate Signaling — .get_gene_contributions","text":"Returns contribution gene production sensing scores.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-get_gene_contributions.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Gene Contributions for Lactate Signaling — .get_gene_contributions","text":"","code":".get_gene_contributions(gene_scores, gene_sets)"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-get_gene_contributions.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Gene Contributions for Lactate Signaling — .get_gene_contributions","text":"gene_scores Matrix gene scores gene_sets Lactate gene sets","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-get_gene_contributions.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Gene Contributions for Lactate Signaling — .get_gene_contributions","text":"List production sensing gene contributions","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-get_lactate_gene_sets.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Curated Lactate Gene Sets — .get_lactate_gene_sets","title":"Get Curated Lactate Gene Sets — .get_lactate_gene_sets","text":"Returns literature-validated gene sets lactate signaling analysis. Gene selection based rigorous scientific review 2024 literature.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-get_lactate_gene_sets.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Curated Lactate Gene Sets — .get_lactate_gene_sets","text":"","code":".get_lactate_gene_sets()"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-get_lactate_gene_sets.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Curated Lactate Gene Sets — .get_lactate_gene_sets","text":"named list containing gene sets category","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-get_metabolite_pathways.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Pathway Information for Metabolites — .get_metabolite_pathways","title":"Get Pathway Information for Metabolites — .get_metabolite_pathways","text":"Get Pathway Information Metabolites","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-get_metabolite_pathways.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Pathway Information for Metabolites — .get_metabolite_pathways","text":"","code":".get_metabolite_pathways(db, hmdb_ids = NULL)"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-get_metabolite_pathways.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Pathway Information for Metabolites — .get_metabolite_pathways","text":"db MetalinksDB database list hmdb_ids Character vector HMDB IDs","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-get_metabolite_pathways.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Pathway Information for Metabolites — .get_metabolite_pathways","text":"data.frame pathway associations","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-get_production_enzymes.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Production Enzymes for Metabolites — .get_production_enzymes","title":"Get Production Enzymes for Metabolites — .get_production_enzymes","text":"Extract enzymes secretion transporters involved metabolite   production release. function filters proteins contribute   making metabolites available intercellular communication.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-get_production_enzymes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Production Enzymes for Metabolites — .get_production_enzymes","text":"","code":".get_production_enzymes(db)"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-get_production_enzymes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Production Enzymes for Metabolites — .get_production_enzymes","text":"db MetalinksDB database list","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-get_production_enzymes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Production Enzymes for Metabolites — .get_production_enzymes","text":"data.frame production relationships","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-get_production_enzymes.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Get Production Enzymes for Metabolites — .get_production_enzymes","text":"production potential consists two components: Synthesis enzymes: Proteins catalyze metabolite biosynthesis Secretion transporters: Membrane transporters release metabolites     extracellular space (transport_direction = \"\") Uptake transporters (transport_direction = \"\") excluded production represent metabolite sensing/uptake rather production/release.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-get_sensing_proteins.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Receptor/Sensing Proteins for Metabolites — .get_sensing_proteins","title":"Get Receptor/Sensing Proteins for Metabolites — .get_sensing_proteins","text":"Get Receptor/Sensing Proteins Metabolites","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-get_sensing_proteins.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Receptor/Sensing Proteins for Metabolites — .get_sensing_proteins","text":"","code":".get_sensing_proteins(db)"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-get_sensing_proteins.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Receptor/Sensing Proteins for Metabolites — .get_sensing_proteins","text":"db MetalinksDB database list","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-get_sensing_proteins.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Receptor/Sensing Proteins for Metabolites — .get_sensing_proteins","text":"data.frame sensing relationships","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-get_transporters.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Transporter Proteins — .get_transporters","title":"Get Transporter Proteins — .get_transporters","text":"Get Transporter Proteins","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-get_transporters.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Transporter Proteins — .get_transporters","text":"","code":".get_transporters(db, direction = \"out\")"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-get_transporters.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Transporter Proteins — .get_transporters","text":"db MetalinksDB database list direction Character. \"\" secretion, \"\" uptake","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-get_transporters.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Transporter Proteins — .get_transporters","text":"data.frame transporter relationships","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-hill_transform.html","id":null,"dir":"Reference","previous_headings":"","what":"Hill Function Transformation — .hill_transform","title":"Hill Function Transformation — .hill_transform","text":"Apply Hill function model receptor-ligand binding saturation.   Hill function captures sigmoidal relationship expression   biological response, reflecting receptor saturation high concentrations.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-hill_transform.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Hill Function Transformation — .hill_transform","text":"","code":".hill_transform(x, n = 1, Kh = 0.5)"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-hill_transform.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Hill Function Transformation — .hill_transform","text":"x Numeric matrix vector expression values (0-1 scaled) n Hill coefficient (cooperativity parameter). n=1 gives standard Michaelis-Menten kinetics; n>1 indicates positive cooperativity. Kh Half-maximal response threshold. value x response = 0.5.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-hill_transform.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Hill Function Transformation — .hill_transform","text":"Transformed values structure input","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-is_interactive.html","id":null,"dir":"Reference","previous_headings":"","what":"Check if Running in Interactive Mode — .is_interactive","title":"Check if Running in Interactive Mode — .is_interactive","text":"Check Running Interactive Mode","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-is_interactive.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check if Running in Interactive Mode — .is_interactive","text":"","code":".is_interactive()"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-is_spatial.html","id":null,"dir":"Reference","previous_headings":"","what":"Check if object has spatial information — .is_spatial","title":"Check if object has spatial information — .is_spatial","text":"Check object spatial information","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-is_spatial.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check if object has spatial information — .is_spatial","text":"","code":".is_spatial(object)"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-load_metalinksdb.html","id":null,"dir":"Reference","previous_headings":"","what":"Load MetalinksDB Database — .load_metalinksdb","title":"Load MetalinksDB Database — .load_metalinksdb","text":"Load MetalinksDB Database","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-load_metalinksdb.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Load MetalinksDB Database — .load_metalinksdb","text":"","code":".load_metalinksdb()"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-load_metalinksdb.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Load MetalinksDB Database — .load_metalinksdb","text":"list containing MetalinksDB data","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-normalize_lactate_scores.html","id":null,"dir":"Reference","previous_headings":"","what":"Normalize Scores — .normalize_lactate_scores","title":"Normalize Scores — .normalize_lactate_scores","text":"Z-score normalization followed min-max scaling 0-1.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-normalize_lactate_scores.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Normalize Scores — .normalize_lactate_scores","text":"","code":".normalize_lactate_scores(scores)"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-normalize_lactate_scores.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Normalize Scores — .normalize_lactate_scores","text":"scores Numeric vector matrix scores","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-normalize_lactate_scores.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Normalize Scores — .normalize_lactate_scores","text":"Normalized scores structure input","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-normalize_scores_permutation.html","id":null,"dir":"Reference","previous_headings":"","what":"Normalize Scores for Permutation (same logic as inferProduction/inferSensing) — .normalize_scores_permutation","title":"Normalize Scores for Permutation (same logic as inferProduction/inferSensing) — .normalize_scores_permutation","text":"Normalize Scores Permutation (logic inferProduction/inferSensing) Normalize Scores Permutation (logic inferProduction/inferSensing)","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-normalize_scores_permutation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Normalize Scores for Permutation (same logic as inferProduction/inferSensing) — .normalize_scores_permutation","text":"","code":".normalize_scores_permutation(scores)  .normalize_scores_permutation(scores)"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-print_progress.html","id":null,"dir":"Reference","previous_headings":"","what":"Print Progress — .print_progress","title":"Print Progress — .print_progress","text":"Print Progress","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-print_progress.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print Progress — .print_progress","text":"","code":".print_progress(current, total, prefix = \"Progress\")"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-print_progress.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print Progress — .print_progress","text":"current Current iteration total Total iterations prefix Prefix message","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-row_trimean.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate Row-wise Trimean — .row_trimean","title":"Calculate Row-wise Trimean — .row_trimean","text":"Calculate trimean row matrix.   Trimean = (Q1 + 2*Q2 + Q3) / 4, providing robust central tendency estimate.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-row_trimean.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Row-wise Trimean — .row_trimean","text":"","code":".row_trimean(mat)"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-row_trimean.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Row-wise Trimean — .row_trimean","text":"mat Matrix (genes x cells), can sparse dense","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-row_trimean.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate Row-wise Trimean — .row_trimean","text":"Numeric vector trimean values row","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-run_lactate_permutation.html","id":null,"dir":"Reference","previous_headings":"","what":"Run Permutation Test for Lactate Communication — .run_lactate_permutation","title":"Run Permutation Test for Lactate Communication — .run_lactate_permutation","text":"Performs permutation testing shuffling cell type labels.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-run_lactate_permutation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run Permutation Test for Lactate Communication — .run_lactate_permutation","text":"","code":".run_lactate_permutation(   object,   comm_scores,   pathway = \"direct\",   n_permutations = 100,   method = \"combined\",   comm_method = \"geometric\",   min_production = 0,   min_sensing = 0,   include_uptake = TRUE,   use_weights = TRUE,   verbose = TRUE )"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-run_lactate_permutation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run Permutation Test for Lactate Communication — .run_lactate_permutation","text":"object scMetaLink object comm_scores Communication score matrix pathway Character. \"direct\" \"indirect\" n_permutations Number permutations method Scoring method min_production Minimum production threshold min_sensing Minimum sensing threshold include_uptake Include uptake direct sensing use_weights Use weights indirect sensing verbose Print progress","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-run_lactate_permutation.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run Permutation Test for Lactate Communication — .run_lactate_permutation","text":"Matrix p-values","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-run_permutation_test_consistent.html","id":null,"dir":"Reference","previous_headings":"","what":"Permutation Test - Consistent with inferProduction/inferSensing — .run_permutation_test_consistent","title":"Permutation Test - Consistent with inferProduction/inferSensing — .run_permutation_test_consistent","text":"function replicates EXACTLY computation   inferProduction inferSensing ensure statistical validity","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-run_permutation_test_consistent.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Permutation Test - Consistent with inferProduction/inferSensing — .run_permutation_test_consistent","text":"","code":".run_permutation_test_consistent(   object,   comm_scores,   common_mets,   n_permutations,   n_cores,   method,   min_production,   min_sensing,   population.size = FALSE,   verbose )"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-run_spatial_permutation_consistent.html","id":null,"dir":"Reference","previous_headings":"","what":"Spatial Permutation Test - Consistent with Non-Spatial Version — .run_spatial_permutation_consistent","title":"Spatial Permutation Test - Consistent with Non-Spatial Version — .run_spatial_permutation_consistent","text":"Permutation test spatial communication significance.   version RECALCULATES production/sensing scores permutation,   consistent non-spatial version communication.R.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-run_spatial_permutation_consistent.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Spatial Permutation Test - Consistent with Non-Spatial Version — .run_spatial_permutation_consistent","text":"","code":".run_spatial_permutation_consistent(   object,   comm_scores,   weight_matrix,   common_mets,   n_permutations,   n_cores,   comm_method,   min_production,   min_sensing,   verbose )"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-run_spatial_permutation_consistent.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Spatial Permutation Test - Consistent with Non-Spatial Version — .run_spatial_permutation_consistent","text":"null hypothesis : \"observed communication pattern cell types associated actual cell type labels.\" tested : 1. Shuffling cell type labels 2. Recalculating expression profiles cell type 3. Recalculating production sensing scores (adjustments) 4. Computing spatial communication new scores 5. Keeping spatial weight matrix UNCHANGED (preserving spatial structure) approach scientifically correct consistent non-spatial permutation test communication.R.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-safe_log.html","id":null,"dir":"Reference","previous_headings":"","what":"Safe Log Transform — .safe_log","title":"Safe Log Transform — .safe_log","text":"Safe Log Transform","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-safe_log.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Safe Log Transform — .safe_log","text":"","code":".safe_log(x, base = 2, offset = 1)"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-safe_log.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Safe Log Transform — .safe_log","text":"x Numeric vector base Log base offset Offset avoid log(0)","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-scale_01.html","id":null,"dir":"Reference","previous_headings":"","what":"Scale Matrix to 0-1 — .scale_01","title":"Scale Matrix to 0-1 — .scale_01","text":"Scale Matrix 0-1","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-scale_01.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Scale Matrix to 0-1 — .scale_01","text":"","code":".scale_01(mat, by_row = TRUE)"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-scale_01.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Scale Matrix to 0-1 — .scale_01","text":"mat Matrix by_row Logical. Scale row","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-validate_input.html","id":null,"dir":"Reference","previous_headings":"","what":"Validate Input Data — .validate_input","title":"Validate Input Data — .validate_input","text":"Validate Input Data","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-validate_input.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Validate Input Data — .validate_input","text":"","code":".validate_input(expr_data, cell_meta)"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-validate_input.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Validate Input Data — .validate_input","text":"expr_data Expression matrix cell_meta Cell metadata","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-zscore.html","id":null,"dir":"Reference","previous_headings":"","what":"Z-score Normalization — .zscore","title":"Z-score Normalization — .zscore","text":"Z-score Normalization","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-zscore.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Z-score Normalization — .zscore","text":"","code":".zscore(mat, by_row = TRUE)"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/dot-zscore.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Z-score Normalization — .zscore","text":"mat Matrix by_row Logical. Normalize row","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/enrichPathways.html","id":null,"dir":"Reference","previous_headings":"","what":"Pathway Enrichment Analysis — enrichPathways","title":"Pathway Enrichment Analysis — enrichPathways","text":"Perform hypergeometric test identify enriched pathways   among significant metabolite-mediated interactions","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/enrichPathways.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pathway Enrichment Analysis — enrichPathways","text":"","code":"enrichPathways(   object,   pvalue_threshold = 0.05,   min_overlap = 2,   adjust_method = \"BH\" )"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/enrichPathways.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Pathway Enrichment Analysis — enrichPathways","text":"object scMetaLink object significant interactions pvalue_threshold Numeric. P-value cutoff enrichment (default: 0.05) min_overlap Integer. Minimum overlap significant metabolites pathway (default: 2) adjust_method Character. P-value adjustment method (default: \"BH\")","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/enrichPathways.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Pathway Enrichment Analysis — enrichPathways","text":"data.frame enriched pathways statistics","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/enrichPathways.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Pathway Enrichment Analysis — enrichPathways","text":"","code":"# \\donttest{ # Perform pathway enrichment enriched <- enrichPathways(result) #> Error: object 'result' not found head(enriched) #> Error: object 'enriched' not found # }"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/exportResults.html","id":null,"dir":"Reference","previous_headings":"","what":"Export Results to CSV — exportResults","title":"Export Results to CSV — exportResults","text":"Export Results CSV","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/exportResults.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Export Results to CSV — exportResults","text":"","code":"exportResults(object, output_dir = \".\", prefix = \"scMetaLink\")"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/exportResults.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Export Results to CSV — exportResults","text":"object scMetaLink object output_dir Character. Output directory prefix Character. File prefix","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/exportResults.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Export Results to CSV — exportResults","text":"Invisibly returns file paths","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/filterSignificantInteractions.html","id":null,"dir":"Reference","previous_headings":"","what":"Filter Significant Interactions — filterSignificantInteractions","title":"Filter Significant Interactions — filterSignificantInteractions","text":"Filter Significant Interactions","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/filterSignificantInteractions.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Filter Significant Interactions — filterSignificantInteractions","text":"","code":"filterSignificantInteractions(   object,   pvalue_threshold = 0.05,   adjust_method = \"metabolite_stratified\",   min_score = 0 )"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/filterSignificantInteractions.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Filter Significant Interactions — filterSignificantInteractions","text":"object scMetaLink object pvalue_threshold Numeric. P-value threshold (default: 0.05) adjust_method Character. Multiple testing correction method: \"BH\", \"bonferroni\", \"holm\", \"none\", \"metabolite_stratified\" (recommended, performs BH within metabolite) min_score Numeric. Minimum communication score (default: 0)","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/filterSignificantInteractions.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Filter Significant Interactions — filterSignificantInteractions","text":"Updated scMetaLink object","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/filterSignificantInteractions.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Filter Significant Interactions — filterSignificantInteractions","text":"adjust_method parameter controls p-values corrected multiple testing: \"metabolite_stratified\" (recommended): Performs BH correction within metabolite,     combines results. less conservative global correction     biologically meaningful since metabolites independent biological signals. \"BH\", \"bonferroni\", \"holm\": Standard global correction methods. Can     conservative testing many interactions. \"none\": correction, uses raw p-values. Use caution.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/getCommunicationMatrix.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Communication Summary Matrix — getCommunicationMatrix","title":"Get Communication Summary Matrix — getCommunicationMatrix","text":"Get Communication Summary Matrix","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/getCommunicationMatrix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Communication Summary Matrix — getCommunicationMatrix","text":"","code":"getCommunicationMatrix(object, aggregate_method = \"sum\")"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/getCommunicationMatrix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Communication Summary Matrix — getCommunicationMatrix","text":"object scMetaLink object aggregate_method Character. aggregate metabolites","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/getCommunicationMatrix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Communication Summary Matrix — getCommunicationMatrix","text":"Matrix aggregated communication scores","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/getDatabaseInfo.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Database Information — getDatabaseInfo","title":"Get Database Information — getDatabaseInfo","text":"Get Database Information","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/getDatabaseInfo.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Database Information — getDatabaseInfo","text":"","code":"getDatabaseInfo()"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/getDatabaseInfo.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Database Information — getDatabaseInfo","text":"data.frame database statistics","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/getLactateGenes.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Lactate Signaling Gene Sets — getLactateGenes","title":"Get Lactate Signaling Gene Sets — getLactateGenes","text":"Returns curated, literature-validated gene sets involved lactate signaling pathways. Useful pathway analysis, visualization, validation. Gene selection criteria: Synthesis: LDHA family (excludes LDHB prefers reverse reaction) Export: MCT4 (SLC16A3) primary exporter, plus MCTs BSG chaperone Direct sensing: HCAR1 (sole confirmed lactate GPCR) Indirect sensing: Classic proton-sensing GPCRs (GPR4, GPR65, GPR68, GPR132) Uptake: MCT1 (SLC16A1) primary importer, plus BSG chaperone","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/getLactateGenes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Lactate Signaling Gene Sets — getLactateGenes","text":"","code":"getLactateGenes(category = \"all\")"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/getLactateGenes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Lactate Signaling Gene Sets — getLactateGenes","text":"category Character. Gene category return: \"\" (default): gene sets \"production\": Synthesis export genes \"degradation\": Lactate consumption enzymes \"direct_sensing\": HCAR1 receptor \"indirect_sensing\": Proton-sensing GPCRs \"uptake\": Import transporters","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/getLactateGenes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Lactate Signaling Gene Sets — getLactateGenes","text":"named list gene vectors. category \"\", returns complete   nested list structure. Otherwise, returns specific category.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/getLactateGenes.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get Lactate Signaling Gene Sets — getLactateGenes","text":"","code":"# Get all gene sets genes <- getLactateGenes() names(genes) #> [1] \"production\"       \"degradation\"      \"direct_sensing\"   \"indirect_sensing\" #> [5] \"uptake\"            # Get synthesis enzymes genes$production$synthesis #> [1] \"LDHA\"    \"LDHC\"    \"LDHAL6A\" \"LDHAL6B\" # [1] \"LDHA\" \"LDHC\" \"LDHAL6A\" \"LDHAL6B\"  # Get proton-sensing receptors genes$indirect_sensing$proton_receptors #> [1] \"GPR4\"   \"GPR65\"  \"GPR68\"  \"GPR132\" # [1] \"GPR4\" \"GPR65\" \"GPR68\" \"GPR132\"  # Get only production genes prod_genes <- getLactateGenes(\"production\")  # Get direct sensing receptor getLactateGenes(\"direct_sensing\")$receptor #> [1] \"HCAR1\" # [1] \"HCAR1\""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/getLactateSignalingSummary.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Lactate Signaling Summary — getLactateSignalingSummary","title":"Get Lactate Signaling Summary — getLactateSignalingSummary","text":"Returns summary lactate-mediated communication cell types.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/getLactateSignalingSummary.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Lactate Signaling Summary — getLactateSignalingSummary","text":"","code":"getLactateSignalingSummary(object, pathway = \"combined\", top_n = 10)"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/getLactateSignalingSummary.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Lactate Signaling Summary — getLactateSignalingSummary","text":"object scMetaLink object lactate signaling results pathway Character. \"direct\", \"indirect\", \"combined\". Default \"combined\". top_n Integer. Number top interactions return. Default 10.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/getLactateSignalingSummary.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Lactate Signaling Summary — getLactateSignalingSummary","text":"data.frame summarizing top cell-cell communications","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/getLactateSignalingSummary.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get Lactate Signaling Summary — getLactateSignalingSummary","text":"","code":"# \\donttest{ data(crc_example) obj <- createScMetaLink(crc_expr, crc_meta, \"cell_type\") #> Created scMetaLink object with 4210 genes, 2850 cells, 15 cell types obj <- inferLactateSignaling(obj) #> Inferring lactate-mediated cell communication... #>   Cell types: 15 #>   Direct pathway: TRUE #>   Indirect pathway: TRUE #>   Available lactate genes: 17/17 #>   Calculating gene expression scores... #>   Calculating lactate production scores... #>   Calculating direct sensing scores (HCAR1)... #>   Calculating indirect sensing scores (GPR4/65/68/132)... #>   Normalizing scores... #>   Calculating direct communication scores... #>   Calculating indirect communication scores... #>   Running permutation test for direct pathway (100 permutations)... #>    |                                                                               |                                                                      |   0%   |                                                                               |=                                                                     |   1%   |                                                                               |=                                                                     |   2%   |                                                                               |==                                                                    |   3%   |                                                                               |===                                                                   |   4%   |                                                                               |====                                                                  |   5%   |                                                                               |====                                                                  |   6%   |                                                                               |=====                                                                 |   7%   |                                                                               |======                                                                |   8%   |                                                                               |======                                                                |   9%   |                                                                               |=======                                                               |  10%   |                                                                               |========                                                              |  11%   |                                                                               |========                                                              |  12%   |                                                                               |=========                                                             |  13%   |                                                                               |==========                                                            |  14%   |                                                                               |==========                                                            |  15%   |                                                                               |===========                                                           |  16%   |                                                                               |============                                                          |  17%   |                                                                               |=============                                                         |  18%   |                                                                               |=============                                                         |  19%   |                                                                               |==============                                                        |  20%   |                                                                               |===============                                                       |  21%   |                                                                               |===============                                                       |  22%   |                                                                               |================                                                      |  23%   |                                                                               |=================                                                     |  24%   |                                                                               |==================                                                    |  25%   |                                                                               |==================                                                    |  26%   |                                                                               |===================                                                   |  27%   |                                                                               |====================                                                  |  28%   |                                                                               |====================                                                  |  29%   |                                                                               |=====================                                                 |  30%   |                                                                               |======================                                                |  31%   |                                                                               |======================                                                |  32%   |                                                                               |=======================                                               |  33%   |                                                                               |========================                                              |  34%   |                                                                               |========================                                              |  35%   |                                                                               |=========================                                             |  36%   |                                                                               |==========================                                            |  37%   |                                                                               |===========================                                           |  38%   |                                                                               |===========================                                           |  39%   |                                                                               |============================                                          |  40%   |                                                                               |=============================                                         |  41%   |                                                                               |=============================                                         |  42%   |                                                                               |==============================                                        |  43%   |                                                                               |===============================                                       |  44%   |                                                                               |================================                                      |  45%   |                                                                               |================================                                      |  46%   |                                                                               |=================================                                     |  47%   |                                                                               |==================================                                    |  48%   |                                                                               |==================================                                    |  49%   |                                                                               |===================================                                   |  50%   |                                                                               |====================================                                  |  51%   |                                                                               |====================================                                  |  52%   |                                                                               |=====================================                                 |  53%   |                                                                               |======================================                                |  54%   |                                                                               |======================================                                |  55%   |                                                                               |=======================================                               |  56%   |                                                                               |========================================                              |  57%   |                                                                               |=========================================                             |  58%   |                                                                               |=========================================                             |  59%   |                                                                               |==========================================                            |  60%   |                                                                               |===========================================                           |  61%   |                                                                               |===========================================                           |  62%   |                                                                               |============================================                          |  63%   |                                                                               |=============================================                         |  64%   |                                                                               |==============================================                        |  65%   |                                                                               |==============================================                        |  66%   |                                                                               |===============================================                       |  67%   |                                                                               |================================================                      |  68%   |                                                                               |================================================                      |  69%   |                                                                               |=================================================                     |  70%   |                                                                               |==================================================                    |  71%   |                                                                               |==================================================                    |  72%   |                                                                               |===================================================                   |  73%   |                                                                               |====================================================                  |  74%   |                                                                               |====================================================                  |  75%   |                                                                               |=====================================================                 |  76%   |                                                                               |======================================================                |  77%   |                                                                               |=======================================================               |  78%   |                                                                               |=======================================================               |  79%   |                                                                               |========================================================              |  80%   |                                                                               |=========================================================             |  81%   |                                                                               |=========================================================             |  82%   |                                                                               |==========================================================            |  83%   |                                                                               |===========================================================           |  84%   |                                                                               |============================================================          |  85%   |                                                                               |============================================================          |  86%   |                                                                               |=============================================================         |  87%   |                                                                               |==============================================================        |  88%   |                                                                               |==============================================================        |  89%   |                                                                               |===============================================================       |  90%   |                                                                               |================================================================      |  91%   |                                                                               |================================================================      |  92%   |                                                                               |=================================================================     |  93%   |                                                                               |==================================================================    |  94%   |                                                                               |==================================================================    |  95%   |                                                                               |===================================================================   |  96%   |                                                                               |====================================================================  |  97%   |                                                                               |===================================================================== |  98%   |                                                                               |===================================================================== |  99%   |                                                                               |======================================================================| 100% #>   Running permutation test for indirect pathway (100 permutations)... #>    |                                                                               |                                                                      |   0%   |                                                                               |=                                                                     |   1%   |                                                                               |=                                                                     |   2%   |                                                                               |==                                                                    |   3%   |                                                                               |===                                                                   |   4%   |                                                                               |====                                                                  |   5%   |                                                                               |====                                                                  |   6%   |                                                                               |=====                                                                 |   7%   |                                                                               |======                                                                |   8%   |                                                                               |======                                                                |   9%   |                                                                               |=======                                                               |  10%   |                                                                               |========                                                              |  11%   |                                                                               |========                                                              |  12%   |                                                                               |=========                                                             |  13%   |                                                                               |==========                                                            |  14%   |                                                                               |==========                                                            |  15%   |                                                                               |===========                                                           |  16%   |                                                                               |============                                                          |  17%   |                                                                               |=============                                                         |  18%   |                                                                               |=============                                                         |  19%   |                                                                               |==============                                                        |  20%   |                                                                               |===============                                                       |  21%   |                                                                               |===============                                                       |  22%   |                                                                               |================                                                      |  23%   |                                                                               |=================                                                     |  24%   |                                                                               |==================                                                    |  25%   |                                                                               |==================                                                    |  26%   |                                                                               |===================                                                   |  27%   |                                                                               |====================                                                  |  28%   |                                                                               |====================                                                  |  29%   |                                                                               |=====================                                                 |  30%   |                                                                               |======================                                                |  31%   |                                                                               |======================                                                |  32%   |                                                                               |=======================                                               |  33%   |                                                                               |========================                                              |  34%   |                                                                               |========================                                              |  35%   |                                                                               |=========================                                             |  36%   |                                                                               |==========================                                            |  37%   |                                                                               |===========================                                           |  38%   |                                                                               |===========================                                           |  39%   |                                                                               |============================                                          |  40%   |                                                                               |=============================                                         |  41%   |                                                                               |=============================                                         |  42%   |                                                                               |==============================                                        |  43%   |                                                                               |===============================                                       |  44%   |                                                                               |================================                                      |  45%   |                                                                               |================================                                      |  46%   |                                                                               |=================================                                     |  47%   |                                                                               |==================================                                    |  48%   |                                                                               |==================================                                    |  49%   |                                                                               |===================================                                   |  50%   |                                                                               |====================================                                  |  51%   |                                                                               |====================================                                  |  52%   |                                                                               |=====================================                                 |  53%   |                                                                               |======================================                                |  54%   |                                                                               |======================================                                |  55%   |                                                                               |=======================================                               |  56%   |                                                                               |========================================                              |  57%   |                                                                               |=========================================                             |  58%   |                                                                               |=========================================                             |  59%   |                                                                               |==========================================                            |  60%   |                                                                               |===========================================                           |  61%   |                                                                               |===========================================                           |  62%   |                                                                               |============================================                          |  63%   |                                                                               |=============================================                         |  64%   |                                                                               |==============================================                        |  65%   |                                                                               |==============================================                        |  66%   |                                                                               |===============================================                       |  67%   |                                                                               |================================================                      |  68%   |                                                                               |================================================                      |  69%   |                                                                               |=================================================                     |  70%   |                                                                               |==================================================                    |  71%   |                                                                               |==================================================                    |  72%   |                                                                               |===================================================                   |  73%   |                                                                               |====================================================                  |  74%   |                                                                               |====================================================                  |  75%   |                                                                               |=====================================================                 |  76%   |                                                                               |======================================================                |  77%   |                                                                               |=======================================================               |  78%   |                                                                               |=======================================================               |  79%   |                                                                               |========================================================              |  80%   |                                                                               |=========================================================             |  81%   |                                                                               |=========================================================             |  82%   |                                                                               |==========================================================            |  83%   |                                                                               |===========================================================           |  84%   |                                                                               |============================================================          |  85%   |                                                                               |============================================================          |  86%   |                                                                               |=============================================================         |  87%   |                                                                               |==============================================================        |  88%   |                                                                               |==============================================================        |  89%   |                                                                               |===============================================================       |  90%   |                                                                               |================================================================      |  91%   |                                                                               |================================================================      |  92%   |                                                                               |=================================================================     |  93%   |                                                                               |==================================================================    |  94%   |                                                                               |==================================================================    |  95%   |                                                                               |===================================================================   |  96%   |                                                                               |====================================================================  |  97%   |                                                                               |===================================================================== |  98%   |                                                                               |===================================================================== |  99%   |                                                                               |======================================================================| 100% #> Done! #>   Production scores for 15 cell types #>   Direct communication: 15 x 15 matrix #>   Indirect communication: 15 x 15 matrix getLactateSignalingSummary(obj) #>               sender          receiver communication_score rank #> 1  Normal Macrophage               TAM           1.5176455    1 #> 2  Normal Macrophage Normal Macrophage           1.4345244    2 #> 3  Normal Macrophage          Pericyte           1.3311660    3 #> 4  Normal Macrophage              Mast           1.2868515    4 #> 5  Normal Macrophage               CAF           1.2522300    5 #> 6  Normal Macrophage Normal Fibroblast           1.2392587    6 #> 7  Normal Macrophage                 T           1.2179554    7 #> 8  Normal Macrophage       Endothelial           1.2001152    8 #> 9  Normal Macrophage               SMC           1.1799733    9 #> 10 Normal Macrophage                 B           0.7686704   10 # }"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/getMetaboliteReceptors.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Receptors for a Metabolite — getMetaboliteReceptors","title":"Get Receptors for a Metabolite — getMetaboliteReceptors","text":"Get Receptors Metabolite","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/getMetaboliteReceptors.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Receptors for a Metabolite — getMetaboliteReceptors","text":"","code":"getMetaboliteReceptors(metabolite, include_transporters = TRUE)"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/getMetaboliteReceptors.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Receptors for a Metabolite — getMetaboliteReceptors","text":"metabolite Character. Metabolite HMDB ID name include_transporters Logical. Include transporters","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/getMetaboliteReceptors.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Receptors for a Metabolite — getMetaboliteReceptors","text":"data.frame receptor information","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/getPathwayCommunicationMatrix.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Pathway Communication Matrix — getPathwayCommunicationMatrix","title":"Get Pathway Communication Matrix — getPathwayCommunicationMatrix","text":"Get Pathway Communication Matrix","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/getPathwayCommunicationMatrix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Pathway Communication Matrix — getPathwayCommunicationMatrix","text":"","code":"getPathwayCommunicationMatrix(object, pathway)"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/getPathwayCommunicationMatrix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Pathway Communication Matrix — getPathwayCommunicationMatrix","text":"object scMetaLink object pathway Character. Pathway name","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/getPathwayCommunicationMatrix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Pathway Communication Matrix — getPathwayCommunicationMatrix","text":"Matrix pathway-specific communication","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/getPathwayMetaboliteNetwork.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Pathway-Metabolite Network — getPathwayMetaboliteNetwork","title":"Get Pathway-Metabolite Network — getPathwayMetaboliteNetwork","text":"Extract pathway-metabolite relationships network visualization","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/getPathwayMetaboliteNetwork.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Pathway-Metabolite Network — getPathwayMetaboliteNetwork","text":"","code":"getPathwayMetaboliteNetwork(object, pathways = NULL, top_n = 10)"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/getPathwayMetaboliteNetwork.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Pathway-Metabolite Network — getPathwayMetaboliteNetwork","text":"object scMetaLink object pathways Character vector. Specific pathways include (NULL top pathways) top_n Integer. Number top pathways pathways NULL","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/getPathwayMetaboliteNetwork.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Pathway-Metabolite Network — getPathwayMetaboliteNetwork","text":"data.frame pathway-metabolite edges","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/getPathwayMetabolites.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Metabolites in Pathway — getPathwayMetabolites","title":"Get Metabolites in Pathway — getPathwayMetabolites","text":"Get Metabolites Pathway","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/getPathwayMetabolites.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Metabolites in Pathway — getPathwayMetabolites","text":"","code":"getPathwayMetabolites(pathway, only_signaling = FALSE)"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/getPathwayMetabolites.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Metabolites in Pathway — getPathwayMetabolites","text":"pathway Character. Pathway name (can partial match) only_signaling Logical. return metabolites receptors","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/getPathwayMetabolites.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Metabolites in Pathway — getPathwayMetabolites","text":"data.frame metabolites pathway","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/getSpatialDistanceStats.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Spatial Distance Statistics — getSpatialDistanceStats","title":"Get Spatial Distance Statistics — getSpatialDistanceStats","text":"Calculate statistics spatial distances dataset","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/getSpatialDistanceStats.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Spatial Distance Statistics — getSpatialDistanceStats","text":"","code":"getSpatialDistanceStats(object)"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/getSpatialDistanceStats.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Spatial Distance Statistics — getSpatialDistanceStats","text":"object scMetaLink object spatial information","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/getSpatialDistanceStats.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Spatial Distance Statistics — getSpatialDistanceStats","text":"list distance statistics","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/getSpatialLactateHotspots.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Spatial Lactate Hotspots — getSpatialLactateHotspots","title":"Get Spatial Lactate Hotspots — getSpatialLactateHotspots","text":"Identifies spatial hotspots lactate production sensing.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/getSpatialLactateHotspots.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Spatial Lactate Hotspots — getSpatialLactateHotspots","text":"","code":"getSpatialLactateHotspots(object, type = \"all\", top_n = 20)"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/getSpatialLactateHotspots.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Spatial Lactate Hotspots — getSpatialLactateHotspots","text":"object scMetaLink object spatial lactate signaling results type Character. Type hotspot: \"production\", \"direct_sensing\", \"indirect_sensing\", \"\". Default \"\". top_n Integer. Number top spots return. Default 20.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/getSpatialLactateHotspots.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Spatial Lactate Hotspots — getSpatialLactateHotspots","text":"data.frame spot IDs, coordinates, scores, cell types","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/getSummaryStats.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Summary Statistics — getSummaryStats","title":"Get Summary Statistics — getSummaryStats","text":"Get summary statistics scMetaLink analysis","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/getSummaryStats.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Summary Statistics — getSummaryStats","text":"","code":"getSummaryStats(object)"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/getSummaryStats.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Summary Statistics — getSummaryStats","text":"object scMetaLink object","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/getSummaryStats.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Summary Statistics — getSummaryStats","text":"list summary statistics","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/getTopLactateProducers.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Top Lactate Producers — getTopLactateProducers","title":"Get Top Lactate Producers — getTopLactateProducers","text":"Returns cell types ranked lactate production potential.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/getTopLactateProducers.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Top Lactate Producers — getTopLactateProducers","text":"","code":"getTopLactateProducers(object, top_n = 5)"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/getTopLactateProducers.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Top Lactate Producers — getTopLactateProducers","text":"object scMetaLink object lactate signaling results top_n Integer. Number top cell types return. Default 5.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/getTopLactateProducers.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Top Lactate Producers — getTopLactateProducers","text":"data.frame cell types, production scores, ranks","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/getTopLactateProducers.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get Top Lactate Producers — getTopLactateProducers","text":"","code":"# \\donttest{ data(crc_example) obj <- createScMetaLink(crc_expr, crc_meta, \"cell_type\") #> Created scMetaLink object with 4210 genes, 2850 cells, 15 cell types obj <- inferLactateSignaling(obj) #> Inferring lactate-mediated cell communication... #>   Cell types: 15 #>   Direct pathway: TRUE #>   Indirect pathway: TRUE #>   Available lactate genes: 17/17 #>   Calculating gene expression scores... #>   Calculating lactate production scores... #>   Calculating direct sensing scores (HCAR1)... #>   Calculating indirect sensing scores (GPR4/65/68/132)... #>   Normalizing scores... #>   Calculating direct communication scores... #>   Calculating indirect communication scores... #>   Running permutation test for direct pathway (100 permutations)... #>    |                                                                               |                                                                      |   0%   |                                                                               |=                                                                     |   1%   |                                                                               |=                                                                     |   2%   |                                                                               |==                                                                    |   3%   |                                                                               |===                                                                   |   4%   |                                                                               |====                                                                  |   5%   |                                                                               |====                                                                  |   6%   |                                                                               |=====                                                                 |   7%   |                                                                               |======                                                                |   8%   |                                                                               |======                                                                |   9%   |                                                                               |=======                                                               |  10%   |                                                                               |========                                                              |  11%   |                                                                               |========                                                              |  12%   |                                                                               |=========                                                             |  13%   |                                                                               |==========                                                            |  14%   |                                                                               |==========                                                            |  15%   |                                                                               |===========                                                           |  16%   |                                                                               |============                                                          |  17%   |                                                                               |=============                                                         |  18%   |                                                                               |=============                                                         |  19%   |                                                                               |==============                                                        |  20%   |                                                                               |===============                                                       |  21%   |                                                                               |===============                                                       |  22%   |                                                                               |================                                                      |  23%   |                                                                               |=================                                                     |  24%   |                                                                               |==================                                                    |  25%   |                                                                               |==================                                                    |  26%   |                                                                               |===================                                                   |  27%   |                                                                               |====================                                                  |  28%   |                                                                               |====================                                                  |  29%   |                                                                               |=====================                                                 |  30%   |                                                                               |======================                                                |  31%   |                                                                               |======================                                                |  32%   |                                                                               |=======================                                               |  33%   |                                                                               |========================                                              |  34%   |                                                                               |========================                                              |  35%   |                                                                               |=========================                                             |  36%   |                                                                               |==========================                                            |  37%   |                                                                               |===========================                                           |  38%   |                                                                               |===========================                                           |  39%   |                                                                               |============================                                          |  40%   |                                                                               |=============================                                         |  41%   |                                                                               |=============================                                         |  42%   |                                                                               |==============================                                        |  43%   |                                                                               |===============================                                       |  44%   |                                                                               |================================                                      |  45%   |                                                                               |================================                                      |  46%   |                                                                               |=================================                                     |  47%   |                                                                               |==================================                                    |  48%   |                                                                               |==================================                                    |  49%   |                                                                               |===================================                                   |  50%   |                                                                               |====================================                                  |  51%   |                                                                               |====================================                                  |  52%   |                                                                               |=====================================                                 |  53%   |                                                                               |======================================                                |  54%   |                                                                               |======================================                                |  55%   |                                                                               |=======================================                               |  56%   |                                                                               |========================================                              |  57%   |                                                                               |=========================================                             |  58%   |                                                                               |=========================================                             |  59%   |                                                                               |==========================================                            |  60%   |                                                                               |===========================================                           |  61%   |                                                                               |===========================================                           |  62%   |                                                                               |============================================                          |  63%   |                                                                               |=============================================                         |  64%   |                                                                               |==============================================                        |  65%   |                                                                               |==============================================                        |  66%   |                                                                               |===============================================                       |  67%   |                                                                               |================================================                      |  68%   |                                                                               |================================================                      |  69%   |                                                                               |=================================================                     |  70%   |                                                                               |==================================================                    |  71%   |                                                                               |==================================================                    |  72%   |                                                                               |===================================================                   |  73%   |                                                                               |====================================================                  |  74%   |                                                                               |====================================================                  |  75%   |                                                                               |=====================================================                 |  76%   |                                                                               |======================================================                |  77%   |                                                                               |=======================================================               |  78%   |                                                                               |=======================================================               |  79%   |                                                                               |========================================================              |  80%   |                                                                               |=========================================================             |  81%   |                                                                               |=========================================================             |  82%   |                                                                               |==========================================================            |  83%   |                                                                               |===========================================================           |  84%   |                                                                               |============================================================          |  85%   |                                                                               |============================================================          |  86%   |                                                                               |=============================================================         |  87%   |                                                                               |==============================================================        |  88%   |                                                                               |==============================================================        |  89%   |                                                                               |===============================================================       |  90%   |                                                                               |================================================================      |  91%   |                                                                               |================================================================      |  92%   |                                                                               |=================================================================     |  93%   |                                                                               |==================================================================    |  94%   |                                                                               |==================================================================    |  95%   |                                                                               |===================================================================   |  96%   |                                                                               |====================================================================  |  97%   |                                                                               |===================================================================== |  98%   |                                                                               |===================================================================== |  99%   |                                                                               |======================================================================| 100% #>   Running permutation test for indirect pathway (100 permutations)... #>    |                                                                               |                                                                      |   0%   |                                                                               |=                                                                     |   1%   |                                                                               |=                                                                     |   2%   |                                                                               |==                                                                    |   3%   |                                                                               |===                                                                   |   4%   |                                                                               |====                                                                  |   5%   |                                                                               |====                                                                  |   6%   |                                                                               |=====                                                                 |   7%   |                                                                               |======                                                                |   8%   |                                                                               |======                                                                |   9%   |                                                                               |=======                                                               |  10%   |                                                                               |========                                                              |  11%   |                                                                               |========                                                              |  12%   |                                                                               |=========                                                             |  13%   |                                                                               |==========                                                            |  14%   |                                                                               |==========                                                            |  15%   |                                                                               |===========                                                           |  16%   |                                                                               |============                                                          |  17%   |                                                                               |=============                                                         |  18%   |                                                                               |=============                                                         |  19%   |                                                                               |==============                                                        |  20%   |                                                                               |===============                                                       |  21%   |                                                                               |===============                                                       |  22%   |                                                                               |================                                                      |  23%   |                                                                               |=================                                                     |  24%   |                                                                               |==================                                                    |  25%   |                                                                               |==================                                                    |  26%   |                                                                               |===================                                                   |  27%   |                                                                               |====================                                                  |  28%   |                                                                               |====================                                                  |  29%   |                                                                               |=====================                                                 |  30%   |                                                                               |======================                                                |  31%   |                                                                               |======================                                                |  32%   |                                                                               |=======================                                               |  33%   |                                                                               |========================                                              |  34%   |                                                                               |========================                                              |  35%   |                                                                               |=========================                                             |  36%   |                                                                               |==========================                                            |  37%   |                                                                               |===========================                                           |  38%   |                                                                               |===========================                                           |  39%   |                                                                               |============================                                          |  40%   |                                                                               |=============================                                         |  41%   |                                                                               |=============================                                         |  42%   |                                                                               |==============================                                        |  43%   |                                                                               |===============================                                       |  44%   |                                                                               |================================                                      |  45%   |                                                                               |================================                                      |  46%   |                                                                               |=================================                                     |  47%   |                                                                               |==================================                                    |  48%   |                                                                               |==================================                                    |  49%   |                                                                               |===================================                                   |  50%   |                                                                               |====================================                                  |  51%   |                                                                               |====================================                                  |  52%   |                                                                               |=====================================                                 |  53%   |                                                                               |======================================                                |  54%   |                                                                               |======================================                                |  55%   |                                                                               |=======================================                               |  56%   |                                                                               |========================================                              |  57%   |                                                                               |=========================================                             |  58%   |                                                                               |=========================================                             |  59%   |                                                                               |==========================================                            |  60%   |                                                                               |===========================================                           |  61%   |                                                                               |===========================================                           |  62%   |                                                                               |============================================                          |  63%   |                                                                               |=============================================                         |  64%   |                                                                               |==============================================                        |  65%   |                                                                               |==============================================                        |  66%   |                                                                               |===============================================                       |  67%   |                                                                               |================================================                      |  68%   |                                                                               |================================================                      |  69%   |                                                                               |=================================================                     |  70%   |                                                                               |==================================================                    |  71%   |                                                                               |==================================================                    |  72%   |                                                                               |===================================================                   |  73%   |                                                                               |====================================================                  |  74%   |                                                                               |====================================================                  |  75%   |                                                                               |=====================================================                 |  76%   |                                                                               |======================================================                |  77%   |                                                                               |=======================================================               |  78%   |                                                                               |=======================================================               |  79%   |                                                                               |========================================================              |  80%   |                                                                               |=========================================================             |  81%   |                                                                               |=========================================================             |  82%   |                                                                               |==========================================================            |  83%   |                                                                               |===========================================================           |  84%   |                                                                               |============================================================          |  85%   |                                                                               |============================================================          |  86%   |                                                                               |=============================================================         |  87%   |                                                                               |==============================================================        |  88%   |                                                                               |==============================================================        |  89%   |                                                                               |===============================================================       |  90%   |                                                                               |================================================================      |  91%   |                                                                               |================================================================      |  92%   |                                                                               |=================================================================     |  93%   |                                                                               |==================================================================    |  94%   |                                                                               |==================================================================    |  95%   |                                                                               |===================================================================   |  96%   |                                                                               |====================================================================  |  97%   |                                                                               |===================================================================== |  98%   |                                                                               |===================================================================== |  99%   |                                                                               |======================================================================| 100% #> Done! #>   Production scores for 15 cell types #>   Direct communication: 15 x 15 matrix #>   Indirect communication: 15 x 15 matrix getTopLactateProducers(obj) #>           cell_type production_score rank #> 1 Normal Macrophage         1.000000    1 #> 2          Monocyte         0.136039    2 #> 3 Normal Epithelial         0.000000    3 #> 4                 T         0.000000    4 #> 5            Plasma         0.000000    5 # }"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/getTopLactateSensors.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Top Lactate Sensors — getTopLactateSensors","title":"Get Top Lactate Sensors — getTopLactateSensors","text":"Returns cell types ranked lactate sensing capability.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/getTopLactateSensors.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Top Lactate Sensors — getTopLactateSensors","text":"","code":"getTopLactateSensors(object, pathway = \"both\", top_n = 5)"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/getTopLactateSensors.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Top Lactate Sensors — getTopLactateSensors","text":"object scMetaLink object lactate signaling results pathway Character. \"direct\" (HCAR1), \"indirect\" (proton GPCRs), \"\". Default \"\". top_n Integer. Number top cell types return. Default 5.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/getTopLactateSensors.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Top Lactate Sensors — getTopLactateSensors","text":"data.frame cell types, sensing scores, ranks","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/getTopLactateSensors.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get Top Lactate Sensors — getTopLactateSensors","text":"","code":"# \\donttest{ data(crc_example) obj <- createScMetaLink(crc_expr, crc_meta, \"cell_type\") #> Created scMetaLink object with 4210 genes, 2850 cells, 15 cell types obj <- inferLactateSignaling(obj) #> Inferring lactate-mediated cell communication... #>   Cell types: 15 #>   Direct pathway: TRUE #>   Indirect pathway: TRUE #>   Available lactate genes: 17/17 #>   Calculating gene expression scores... #>   Calculating lactate production scores... #>   Calculating direct sensing scores (HCAR1)... #>   Calculating indirect sensing scores (GPR4/65/68/132)... #>   Normalizing scores... #>   Calculating direct communication scores... #>   Calculating indirect communication scores... #>   Running permutation test for direct pathway (100 permutations)... #>    |                                                                               |                                                                      |   0%   |                                                                               |=                                                                     |   1%   |                                                                               |=                                                                     |   2%   |                                                                               |==                                                                    |   3%   |                                                                               |===                                                                   |   4%   |                                                                               |====                                                                  |   5%   |                                                                               |====                                                                  |   6%   |                                                                               |=====                                                                 |   7%   |                                                                               |======                                                                |   8%   |                                                                               |======                                                                |   9%   |                                                                               |=======                                                               |  10%   |                                                                               |========                                                              |  11%   |                                                                               |========                                                              |  12%   |                                                                               |=========                                                             |  13%   |                                                                               |==========                                                            |  14%   |                                                                               |==========                                                            |  15%   |                                                                               |===========                                                           |  16%   |                                                                               |============                                                          |  17%   |                                                                               |=============                                                         |  18%   |                                                                               |=============                                                         |  19%   |                                                                               |==============                                                        |  20%   |                                                                               |===============                                                       |  21%   |                                                                               |===============                                                       |  22%   |                                                                               |================                                                      |  23%   |                                                                               |=================                                                     |  24%   |                                                                               |==================                                                    |  25%   |                                                                               |==================                                                    |  26%   |                                                                               |===================                                                   |  27%   |                                                                               |====================                                                  |  28%   |                                                                               |====================                                                  |  29%   |                                                                               |=====================                                                 |  30%   |                                                                               |======================                                                |  31%   |                                                                               |======================                                                |  32%   |                                                                               |=======================                                               |  33%   |                                                                               |========================                                              |  34%   |                                                                               |========================                                              |  35%   |                                                                               |=========================                                             |  36%   |                                                                               |==========================                                            |  37%   |                                                                               |===========================                                           |  38%   |                                                                               |===========================                                           |  39%   |                                                                               |============================                                          |  40%   |                                                                               |=============================                                         |  41%   |                                                                               |=============================                                         |  42%   |                                                                               |==============================                                        |  43%   |                                                                               |===============================                                       |  44%   |                                                                               |================================                                      |  45%   |                                                                               |================================                                      |  46%   |                                                                               |=================================                                     |  47%   |                                                                               |==================================                                    |  48%   |                                                                               |==================================                                    |  49%   |                                                                               |===================================                                   |  50%   |                                                                               |====================================                                  |  51%   |                                                                               |====================================                                  |  52%   |                                                                               |=====================================                                 |  53%   |                                                                               |======================================                                |  54%   |                                                                               |======================================                                |  55%   |                                                                               |=======================================                               |  56%   |                                                                               |========================================                              |  57%   |                                                                               |=========================================                             |  58%   |                                                                               |=========================================                             |  59%   |                                                                               |==========================================                            |  60%   |                                                                               |===========================================                           |  61%   |                                                                               |===========================================                           |  62%   |                                                                               |============================================                          |  63%   |                                                                               |=============================================                         |  64%   |                                                                               |==============================================                        |  65%   |                                                                               |==============================================                        |  66%   |                                                                               |===============================================                       |  67%   |                                                                               |================================================                      |  68%   |                                                                               |================================================                      |  69%   |                                                                               |=================================================                     |  70%   |                                                                               |==================================================                    |  71%   |                                                                               |==================================================                    |  72%   |                                                                               |===================================================                   |  73%   |                                                                               |====================================================                  |  74%   |                                                                               |====================================================                  |  75%   |                                                                               |=====================================================                 |  76%   |                                                                               |======================================================                |  77%   |                                                                               |=======================================================               |  78%   |                                                                               |=======================================================               |  79%   |                                                                               |========================================================              |  80%   |                                                                               |=========================================================             |  81%   |                                                                               |=========================================================             |  82%   |                                                                               |==========================================================            |  83%   |                                                                               |===========================================================           |  84%   |                                                                               |============================================================          |  85%   |                                                                               |============================================================          |  86%   |                                                                               |=============================================================         |  87%   |                                                                               |==============================================================        |  88%   |                                                                               |==============================================================        |  89%   |                                                                               |===============================================================       |  90%   |                                                                               |================================================================      |  91%   |                                                                               |================================================================      |  92%   |                                                                               |=================================================================     |  93%   |                                                                               |==================================================================    |  94%   |                                                                               |==================================================================    |  95%   |                                                                               |===================================================================   |  96%   |                                                                               |====================================================================  |  97%   |                                                                               |===================================================================== |  98%   |                                                                               |===================================================================== |  99%   |                                                                               |======================================================================| 100% #>   Running permutation test for indirect pathway (100 permutations)... #>    |                                                                               |                                                                      |   0%   |                                                                               |=                                                                     |   1%   |                                                                               |=                                                                     |   2%   |                                                                               |==                                                                    |   3%   |                                                                               |===                                                                   |   4%   |                                                                               |====                                                                  |   5%   |                                                                               |====                                                                  |   6%   |                                                                               |=====                                                                 |   7%   |                                                                               |======                                                                |   8%   |                                                                               |======                                                                |   9%   |                                                                               |=======                                                               |  10%   |                                                                               |========                                                              |  11%   |                                                                               |========                                                              |  12%   |                                                                               |=========                                                             |  13%   |                                                                               |==========                                                            |  14%   |                                                                               |==========                                                            |  15%   |                                                                               |===========                                                           |  16%   |                                                                               |============                                                          |  17%   |                                                                               |=============                                                         |  18%   |                                                                               |=============                                                         |  19%   |                                                                               |==============                                                        |  20%   |                                                                               |===============                                                       |  21%   |                                                                               |===============                                                       |  22%   |                                                                               |================                                                      |  23%   |                                                                               |=================                                                     |  24%   |                                                                               |==================                                                    |  25%   |                                                                               |==================                                                    |  26%   |                                                                               |===================                                                   |  27%   |                                                                               |====================                                                  |  28%   |                                                                               |====================                                                  |  29%   |                                                                               |=====================                                                 |  30%   |                                                                               |======================                                                |  31%   |                                                                               |======================                                                |  32%   |                                                                               |=======================                                               |  33%   |                                                                               |========================                                              |  34%   |                                                                               |========================                                              |  35%   |                                                                               |=========================                                             |  36%   |                                                                               |==========================                                            |  37%   |                                                                               |===========================                                           |  38%   |                                                                               |===========================                                           |  39%   |                                                                               |============================                                          |  40%   |                                                                               |=============================                                         |  41%   |                                                                               |=============================                                         |  42%   |                                                                               |==============================                                        |  43%   |                                                                               |===============================                                       |  44%   |                                                                               |================================                                      |  45%   |                                                                               |================================                                      |  46%   |                                                                               |=================================                                     |  47%   |                                                                               |==================================                                    |  48%   |                                                                               |==================================                                    |  49%   |                                                                               |===================================                                   |  50%   |                                                                               |====================================                                  |  51%   |                                                                               |====================================                                  |  52%   |                                                                               |=====================================                                 |  53%   |                                                                               |======================================                                |  54%   |                                                                               |======================================                                |  55%   |                                                                               |=======================================                               |  56%   |                                                                               |========================================                              |  57%   |                                                                               |=========================================                             |  58%   |                                                                               |=========================================                             |  59%   |                                                                               |==========================================                            |  60%   |                                                                               |===========================================                           |  61%   |                                                                               |===========================================                           |  62%   |                                                                               |============================================                          |  63%   |                                                                               |=============================================                         |  64%   |                                                                               |==============================================                        |  65%   |                                                                               |==============================================                        |  66%   |                                                                               |===============================================                       |  67%   |                                                                               |================================================                      |  68%   |                                                                               |================================================                      |  69%   |                                                                               |=================================================                     |  70%   |                                                                               |==================================================                    |  71%   |                                                                               |==================================================                    |  72%   |                                                                               |===================================================                   |  73%   |                                                                               |====================================================                  |  74%   |                                                                               |====================================================                  |  75%   |                                                                               |=====================================================                 |  76%   |                                                                               |======================================================                |  77%   |                                                                               |=======================================================               |  78%   |                                                                               |=======================================================               |  79%   |                                                                               |========================================================              |  80%   |                                                                               |=========================================================             |  81%   |                                                                               |=========================================================             |  82%   |                                                                               |==========================================================            |  83%   |                                                                               |===========================================================           |  84%   |                                                                               |============================================================          |  85%   |                                                                               |============================================================          |  86%   |                                                                               |=============================================================         |  87%   |                                                                               |==============================================================        |  88%   |                                                                               |==============================================================        |  89%   |                                                                               |===============================================================       |  90%   |                                                                               |================================================================      |  91%   |                                                                               |================================================================      |  92%   |                                                                               |=================================================================     |  93%   |                                                                               |==================================================================    |  94%   |                                                                               |==================================================================    |  95%   |                                                                               |===================================================================   |  96%   |                                                                               |====================================================================  |  97%   |                                                                               |===================================================================== |  98%   |                                                                               |===================================================================== |  99%   |                                                                               |======================================================================| 100% #> Done! #>   Production scores for 15 cell types #>   Direct communication: 15 x 15 matrix #>   Indirect communication: 15 x 15 matrix  # Get top sensors for indirect pathway getTopLactateSensors(obj, pathway = \"indirect\") #>           cell_type sensing_score  pathway rank #> 1               TAM     1.0000000 indirect    1 #> 2 Normal Macrophage     0.9694235 indirect    2 #> 3              Mast     0.6878452 indirect    3 #> 4                 T     0.6399321 indirect    4 #> 5          Monocyte     0.4406017 indirect    5 # }"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/getTopProducers.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Top Producing Cell Types for a Metabolite — getTopProducers","title":"Get Top Producing Cell Types for a Metabolite — getTopProducers","text":"Get Top Producing Cell Types Metabolite","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/getTopProducers.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Top Producing Cell Types for a Metabolite — getTopProducers","text":"","code":"getTopProducers(object, metabolite, top_n = 5)"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/getTopProducers.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Top Producing Cell Types for a Metabolite — getTopProducers","text":"object scMetaLink object metabolite Character. Metabolite HMDB ID name top_n Integer. Number top cell types return","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/getTopProducers.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Top Producing Cell Types for a Metabolite — getTopProducers","text":"data.frame top producing cell types","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/getTopSensors.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Top Sensing Cell Types for a Metabolite — getTopSensors","title":"Get Top Sensing Cell Types for a Metabolite — getTopSensors","text":"Get Top Sensing Cell Types Metabolite","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/getTopSensors.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Top Sensing Cell Types for a Metabolite — getTopSensors","text":"","code":"getTopSensors(object, metabolite, top_n = 5)"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/getTopSensors.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Top Sensing Cell Types for a Metabolite — getTopSensors","text":"object scMetaLink object metabolite Character. Metabolite HMDB ID name top_n Integer. Number top cell types return","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/getTopSensors.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Top Sensing Cell Types for a Metabolite — getTopSensors","text":"data.frame top sensing cell types","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/identifyCellTypeSpecificMetabolites.html","id":null,"dir":"Reference","previous_headings":"","what":"Identify Cell Type Specific Metabolites — identifyCellTypeSpecificMetabolites","title":"Identify Cell Type Specific Metabolites — identifyCellTypeSpecificMetabolites","text":"Find metabolites specifically produced sensed cell types","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/identifyCellTypeSpecificMetabolites.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Identify Cell Type Specific Metabolites — identifyCellTypeSpecificMetabolites","text":"","code":"identifyCellTypeSpecificMetabolites(   object,   type = \"production\",   specificity_threshold = 1.5 )"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/identifyCellTypeSpecificMetabolites.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Identify Cell Type Specific Metabolites — identifyCellTypeSpecificMetabolites","text":"object scMetaLink object type Character. \"production\" \"sensing\" specificity_threshold Numeric. Z-score threshold specificity","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/identifyCellTypeSpecificMetabolites.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Identify Cell Type Specific Metabolites — identifyCellTypeSpecificMetabolites","text":"data.frame cell type specific metabolites","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/identifyCommunicationHotspots.html","id":null,"dir":"Reference","previous_headings":"","what":"Identify Communication Hotspots — identifyCommunicationHotspots","title":"Identify Communication Hotspots — identifyCommunicationHotspots","text":"Find spatial regions high metabolite communication activity.   **Note**: function requires running computeSpatialCommunication()   analysis_level='spot' first.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/identifyCommunicationHotspots.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Identify Communication Hotspots — identifyCommunicationHotspots","text":"","code":"identifyCommunicationHotspots(   object,   metabolite = NULL,   type = \"sender\",   n_hotspots = 5,   method = \"density\" )"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/identifyCommunicationHotspots.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Identify Communication Hotspots — identifyCommunicationHotspots","text":"object scMetaLink object spatial communication results metabolite Character. Metabolite ID name analyze (NULL aggregate) type Character. \"sender\" \"receiver\" identify production sensing hotspots n_hotspots Integer. Number hotspot regions identify method Character. Method hotspot detection: \"density\" \"clustering\"","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/identifyCommunicationHotspots.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Identify Communication Hotspots — identifyCommunicationHotspots","text":"data.frame hotspot information","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/inferLactateSignaling.html","id":null,"dir":"Reference","previous_headings":"","what":"Infer Lactate-Mediated Cell Communication — inferLactateSignaling","title":"Infer Lactate-Mediated Cell Communication — inferLactateSignaling","text":"Infers direct indirect lactate signaling single-cell data. Direct signaling: Lactate binds HCAR1 (GPR81), confirmed lactate GPCR (validated cryo-EM structure, PLOS Biology 2024). Indirect signaling: Lactate dissociation (pKa=3.86) produces H+ ions activate proton-sensing GPCRs (GPR4, GPR65, GPR68, GPR132).","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/inferLactateSignaling.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Infer Lactate-Mediated Cell Communication — inferLactateSignaling","text":"","code":"inferLactateSignaling(   object,   include_direct = TRUE,   include_indirect = TRUE,   method = \"combined\",   comm_method = \"geometric\",   min_pct = 0.1,   min_production = 0,   min_sensing = 0,   consider_uptake = TRUE,   consider_degradation = TRUE,   normalize = TRUE,   n_permutations = 100,   seed = 42,   verbose = TRUE )"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/inferLactateSignaling.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Infer Lactate-Mediated Cell Communication — inferLactateSignaling","text":"object scMetaLink object expression data include_direct Logical. Include direct lactate-HCAR1 signaling. Default TRUE. include_indirect Logical. Include indirect lactate-H+-GPCR signaling. Default TRUE. method Character. Scoring method: \"combined\" (recommended), \"mean\", \"proportion\". Default \"combined\". comm_method Character. Communication score method: \"geometric\" (default), \"product\", \"harmonic\". min_pct Numeric. Minimum percentage expressing cells (0-1). Default 0.1. min_production Numeric. Minimum production score threshold (0-1). Default 0. min_sensing Numeric. Minimum sensing score threshold (0-1). Default 0. consider_uptake Logical. Include MCT uptake transporters direct sensing. Default TRUE. consider_degradation Logical. Subtract degradation enzyme expression production scores. Default TRUE. normalize Logical. Normalize scores across cell types. Default TRUE. n_permutations Integer. Number permutations significance testing. Set 0 skip. Default 100. seed Integer. Random seed reproducibility. Default 42. verbose Logical. Print progress messages. Default TRUE.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/inferLactateSignaling.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Infer Lactate-Mediated Cell Communication — inferLactateSignaling","text":"Updated scMetaLink object lactate_signaling results stored   parameters slot, containing: production Lactate production scores per cell type direct_sensing Direct sensing scores (HCAR1) indirect_sensing Indirect sensing scores (proton GPCRs) direct_communication Communication matrix via direct pathway indirect_communication Communication matrix via indirect pathway combined_communication Sum direct indirect communication pvalues Permutation-based p-values (n_permutations > 0) gene_contributions Expression contribution gene parameters Analysis parameters used","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/inferLactateSignaling.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Infer Lactate-Mediated Cell Communication — inferLactateSignaling","text":"HCAR1 structure: PLOS Biology (2024) GPR81 function: Nature Metabolism (2024) Lactate signaling: Signal Transduction Targeted Therapy (2024) Proton-sensing GPCRs: Reactome R-HSA-444731","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/inferLactateSignaling.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Infer Lactate-Mediated Cell Communication — inferLactateSignaling","text":"","code":"# \\donttest{ # Load example data data(crc_example)  # Create scMetaLink object obj <- createScMetaLink(crc_expr, crc_meta, \"cell_type\") #> Created scMetaLink object with 4210 genes, 2850 cells, 15 cell types  # Run lactate signaling analysis obj <- inferLactateSignaling(obj) #> Inferring lactate-mediated cell communication... #>   Cell types: 15 #>   Direct pathway: TRUE #>   Indirect pathway: TRUE #>   Available lactate genes: 17/17 #>   Calculating gene expression scores... #>   Calculating lactate production scores... #>   Calculating direct sensing scores (HCAR1)... #>   Calculating indirect sensing scores (GPR4/65/68/132)... #>   Normalizing scores... #>   Calculating direct communication scores... #>   Calculating indirect communication scores... #>   Running permutation test for direct pathway (100 permutations)... #>    |                                                                               |                                                                      |   0%   |                                                                               |=                                                                     |   1%   |                                                                               |=                                                                     |   2%   |                                                                               |==                                                                    |   3%   |                                                                               |===                                                                   |   4%   |                                                                               |====                                                                  |   5%   |                                                                               |====                                                                  |   6%   |                                                                               |=====                                                                 |   7%   |                                                                               |======                                                                |   8%   |                                                                               |======                                                                |   9%   |                                                                               |=======                                                               |  10%   |                                                                               |========                                                              |  11%   |                                                                               |========                                                              |  12%   |                                                                               |=========                                                             |  13%   |                                                                               |==========                                                            |  14%   |                                                                               |==========                                                            |  15%   |                                                                               |===========                                                           |  16%   |                                                                               |============                                                          |  17%   |                                                                               |=============                                                         |  18%   |                                                                               |=============                                                         |  19%   |                                                                               |==============                                                        |  20%   |                                                                               |===============                                                       |  21%   |                                                                               |===============                                                       |  22%   |                                                                               |================                                                      |  23%   |                                                                               |=================                                                     |  24%   |                                                                               |==================                                                    |  25%   |                                                                               |==================                                                    |  26%   |                                                                               |===================                                                   |  27%   |                                                                               |====================                                                  |  28%   |                                                                               |====================                                                  |  29%   |                                                                               |=====================                                                 |  30%   |                                                                               |======================                                                |  31%   |                                                                               |======================                                                |  32%   |                                                                               |=======================                                               |  33%   |                                                                               |========================                                              |  34%   |                                                                               |========================                                              |  35%   |                                                                               |=========================                                             |  36%   |                                                                               |==========================                                            |  37%   |                                                                               |===========================                                           |  38%   |                                                                               |===========================                                           |  39%   |                                                                               |============================                                          |  40%   |                                                                               |=============================                                         |  41%   |                                                                               |=============================                                         |  42%   |                                                                               |==============================                                        |  43%   |                                                                               |===============================                                       |  44%   |                                                                               |================================                                      |  45%   |                                                                               |================================                                      |  46%   |                                                                               |=================================                                     |  47%   |                                                                               |==================================                                    |  48%   |                                                                               |==================================                                    |  49%   |                                                                               |===================================                                   |  50%   |                                                                               |====================================                                  |  51%   |                                                                               |====================================                                  |  52%   |                                                                               |=====================================                                 |  53%   |                                                                               |======================================                                |  54%   |                                                                               |======================================                                |  55%   |                                                                               |=======================================                               |  56%   |                                                                               |========================================                              |  57%   |                                                                               |=========================================                             |  58%   |                                                                               |=========================================                             |  59%   |                                                                               |==========================================                            |  60%   |                                                                               |===========================================                           |  61%   |                                                                               |===========================================                           |  62%   |                                                                               |============================================                          |  63%   |                                                                               |=============================================                         |  64%   |                                                                               |==============================================                        |  65%   |                                                                               |==============================================                        |  66%   |                                                                               |===============================================                       |  67%   |                                                                               |================================================                      |  68%   |                                                                               |================================================                      |  69%   |                                                                               |=================================================                     |  70%   |                                                                               |==================================================                    |  71%   |                                                                               |==================================================                    |  72%   |                                                                               |===================================================                   |  73%   |                                                                               |====================================================                  |  74%   |                                                                               |====================================================                  |  75%   |                                                                               |=====================================================                 |  76%   |                                                                               |======================================================                |  77%   |                                                                               |=======================================================               |  78%   |                                                                               |=======================================================               |  79%   |                                                                               |========================================================              |  80%   |                                                                               |=========================================================             |  81%   |                                                                               |=========================================================             |  82%   |                                                                               |==========================================================            |  83%   |                                                                               |===========================================================           |  84%   |                                                                               |============================================================          |  85%   |                                                                               |============================================================          |  86%   |                                                                               |=============================================================         |  87%   |                                                                               |==============================================================        |  88%   |                                                                               |==============================================================        |  89%   |                                                                               |===============================================================       |  90%   |                                                                               |================================================================      |  91%   |                                                                               |================================================================      |  92%   |                                                                               |=================================================================     |  93%   |                                                                               |==================================================================    |  94%   |                                                                               |==================================================================    |  95%   |                                                                               |===================================================================   |  96%   |                                                                               |====================================================================  |  97%   |                                                                               |===================================================================== |  98%   |                                                                               |===================================================================== |  99%   |                                                                               |======================================================================| 100% #>   Running permutation test for indirect pathway (100 permutations)... #>    |                                                                               |                                                                      |   0%   |                                                                               |=                                                                     |   1%   |                                                                               |=                                                                     |   2%   |                                                                               |==                                                                    |   3%   |                                                                               |===                                                                   |   4%   |                                                                               |====                                                                  |   5%   |                                                                               |====                                                                  |   6%   |                                                                               |=====                                                                 |   7%   |                                                                               |======                                                                |   8%   |                                                                               |======                                                                |   9%   |                                                                               |=======                                                               |  10%   |                                                                               |========                                                              |  11%   |                                                                               |========                                                              |  12%   |                                                                               |=========                                                             |  13%   |                                                                               |==========                                                            |  14%   |                                                                               |==========                                                            |  15%   |                                                                               |===========                                                           |  16%   |                                                                               |============                                                          |  17%   |                                                                               |=============                                                         |  18%   |                                                                               |=============                                                         |  19%   |                                                                               |==============                                                        |  20%   |                                                                               |===============                                                       |  21%   |                                                                               |===============                                                       |  22%   |                                                                               |================                                                      |  23%   |                                                                               |=================                                                     |  24%   |                                                                               |==================                                                    |  25%   |                                                                               |==================                                                    |  26%   |                                                                               |===================                                                   |  27%   |                                                                               |====================                                                  |  28%   |                                                                               |====================                                                  |  29%   |                                                                               |=====================                                                 |  30%   |                                                                               |======================                                                |  31%   |                                                                               |======================                                                |  32%   |                                                                               |=======================                                               |  33%   |                                                                               |========================                                              |  34%   |                                                                               |========================                                              |  35%   |                                                                               |=========================                                             |  36%   |                                                                               |==========================                                            |  37%   |                                                                               |===========================                                           |  38%   |                                                                               |===========================                                           |  39%   |                                                                               |============================                                          |  40%   |                                                                               |=============================                                         |  41%   |                                                                               |=============================                                         |  42%   |                                                                               |==============================                                        |  43%   |                                                                               |===============================                                       |  44%   |                                                                               |================================                                      |  45%   |                                                                               |================================                                      |  46%   |                                                                               |=================================                                     |  47%   |                                                                               |==================================                                    |  48%   |                                                                               |==================================                                    |  49%   |                                                                               |===================================                                   |  50%   |                                                                               |====================================                                  |  51%   |                                                                               |====================================                                  |  52%   |                                                                               |=====================================                                 |  53%   |                                                                               |======================================                                |  54%   |                                                                               |======================================                                |  55%   |                                                                               |=======================================                               |  56%   |                                                                               |========================================                              |  57%   |                                                                               |=========================================                             |  58%   |                                                                               |=========================================                             |  59%   |                                                                               |==========================================                            |  60%   |                                                                               |===========================================                           |  61%   |                                                                               |===========================================                           |  62%   |                                                                               |============================================                          |  63%   |                                                                               |=============================================                         |  64%   |                                                                               |==============================================                        |  65%   |                                                                               |==============================================                        |  66%   |                                                                               |===============================================                       |  67%   |                                                                               |================================================                      |  68%   |                                                                               |================================================                      |  69%   |                                                                               |=================================================                     |  70%   |                                                                               |==================================================                    |  71%   |                                                                               |==================================================                    |  72%   |                                                                               |===================================================                   |  73%   |                                                                               |====================================================                  |  74%   |                                                                               |====================================================                  |  75%   |                                                                               |=====================================================                 |  76%   |                                                                               |======================================================                |  77%   |                                                                               |=======================================================               |  78%   |                                                                               |=======================================================               |  79%   |                                                                               |========================================================              |  80%   |                                                                               |=========================================================             |  81%   |                                                                               |=========================================================             |  82%   |                                                                               |==========================================================            |  83%   |                                                                               |===========================================================           |  84%   |                                                                               |============================================================          |  85%   |                                                                               |============================================================          |  86%   |                                                                               |=============================================================         |  87%   |                                                                               |==============================================================        |  88%   |                                                                               |==============================================================        |  89%   |                                                                               |===============================================================       |  90%   |                                                                               |================================================================      |  91%   |                                                                               |================================================================      |  92%   |                                                                               |=================================================================     |  93%   |                                                                               |==================================================================    |  94%   |                                                                               |==================================================================    |  95%   |                                                                               |===================================================================   |  96%   |                                                                               |====================================================================  |  97%   |                                                                               |===================================================================== |  98%   |                                                                               |===================================================================== |  99%   |                                                                               |======================================================================| 100% #> Done! #>   Production scores for 15 cell types #>   Direct communication: 15 x 15 matrix #>   Indirect communication: 15 x 15 matrix  # Access results lactate_results <- obj@parameters$lactate_signaling head(lactate_results$direct_communication) #>                    receiver #> sender              Normal Epithelial         T    Plasma Normal Fibroblast #>   Normal Epithelial         0.0000000 0.0000000 0.0000000                 0 #>   T                         0.0000000 0.0000000 0.0000000                 0 #>   Plasma                    0.0000000 0.0000000 0.0000000                 0 #>   Normal Fibroblast         0.0000000 0.0000000 0.0000000                 0 #>   CAF                       0.0000000 0.0000000 0.0000000                 0 #>   Normal Macrophage         0.5020111 0.4179979 0.4185931                 1 #>                    receiver #> sender                   CAF Normal Macrophage       TAM         B Monocyte #>   Normal Epithelial 0.000000         0.0000000 0.0000000 0.0000000        0 #>   T                 0.000000         0.0000000 0.0000000 0.0000000        0 #>   Plasma            0.000000         0.0000000 0.0000000 0.0000000        0 #>   Normal Fibroblast 0.000000         0.0000000 0.0000000 0.0000000        0 #>   CAF               0.000000         0.0000000 0.0000000 0.0000000        0 #>   Normal Macrophage 0.943947         0.4499313 0.5176455 0.3266372        0 #>                    receiver #> sender              Endothelial  Pericyte       SMC      Mast Gliacyte #>   Normal Epithelial   0.0000000 0.0000000 0.0000000 0.0000000 0.000000 #>   T                   0.0000000 0.0000000 0.0000000 0.0000000 0.000000 #>   Plasma              0.0000000 0.0000000 0.0000000 0.0000000 0.000000 #>   Normal Fibroblast   0.0000000 0.0000000 0.0000000 0.0000000 0.000000 #>   CAF                 0.0000000 0.0000000 0.0000000 0.0000000 0.000000 #>   Normal Macrophage   0.6155285 0.8977151 0.8215609 0.4574871 0.536653 #>                    receiver #> sender              Tumor Epithelial #>   Normal Epithelial        0.0000000 #>   T                        0.0000000 #>   Plasma                   0.0000000 #>   Normal Fibroblast        0.0000000 #>   CAF                      0.0000000 #>   Normal Macrophage        0.5800917  # Analyze only indirect (proton) signaling obj <- inferLactateSignaling(obj, include_direct = FALSE) #> Inferring lactate-mediated cell communication... #>   Cell types: 15 #>   Direct pathway: FALSE #>   Indirect pathway: TRUE #>   Available lactate genes: 17/17 #>   Calculating gene expression scores... #>   Calculating lactate production scores... #>   Calculating indirect sensing scores (GPR4/65/68/132)... #>   Normalizing scores... #>   Calculating indirect communication scores... #>   Running permutation test for indirect pathway (100 permutations)... #>    |                                                                               |                                                                      |   0%   |                                                                               |=                                                                     |   1%   |                                                                               |=                                                                     |   2%   |                                                                               |==                                                                    |   3%   |                                                                               |===                                                                   |   4%   |                                                                               |====                                                                  |   5%   |                                                                               |====                                                                  |   6%   |                                                                               |=====                                                                 |   7%   |                                                                               |======                                                                |   8%   |                                                                               |======                                                                |   9%   |                                                                               |=======                                                               |  10%   |                                                                               |========                                                              |  11%   |                                                                               |========                                                              |  12%   |                                                                               |=========                                                             |  13%   |                                                                               |==========                                                            |  14%   |                                                                               |==========                                                            |  15%   |                                                                               |===========                                                           |  16%   |                                                                               |============                                                          |  17%   |                                                                               |=============                                                         |  18%   |                                                                               |=============                                                         |  19%   |                                                                               |==============                                                        |  20%   |                                                                               |===============                                                       |  21%   |                                                                               |===============                                                       |  22%   |                                                                               |================                                                      |  23%   |                                                                               |=================                                                     |  24%   |                                                                               |==================                                                    |  25%   |                                                                               |==================                                                    |  26%   |                                                                               |===================                                                   |  27%   |                                                                               |====================                                                  |  28%   |                                                                               |====================                                                  |  29%   |                                                                               |=====================                                                 |  30%   |                                                                               |======================                                                |  31%   |                                                                               |======================                                                |  32%   |                                                                               |=======================                                               |  33%   |                                                                               |========================                                              |  34%   |                                                                               |========================                                              |  35%   |                                                                               |=========================                                             |  36%   |                                                                               |==========================                                            |  37%   |                                                                               |===========================                                           |  38%   |                                                                               |===========================                                           |  39%   |                                                                               |============================                                          |  40%   |                                                                               |=============================                                         |  41%   |                                                                               |=============================                                         |  42%   |                                                                               |==============================                                        |  43%   |                                                                               |===============================                                       |  44%   |                                                                               |================================                                      |  45%   |                                                                               |================================                                      |  46%   |                                                                               |=================================                                     |  47%   |                                                                               |==================================                                    |  48%   |                                                                               |==================================                                    |  49%   |                                                                               |===================================                                   |  50%   |                                                                               |====================================                                  |  51%   |                                                                               |====================================                                  |  52%   |                                                                               |=====================================                                 |  53%   |                                                                               |======================================                                |  54%   |                                                                               |======================================                                |  55%   |                                                                               |=======================================                               |  56%   |                                                                               |========================================                              |  57%   |                                                                               |=========================================                             |  58%   |                                                                               |=========================================                             |  59%   |                                                                               |==========================================                            |  60%   |                                                                               |===========================================                           |  61%   |                                                                               |===========================================                           |  62%   |                                                                               |============================================                          |  63%   |                                                                               |=============================================                         |  64%   |                                                                               |==============================================                        |  65%   |                                                                               |==============================================                        |  66%   |                                                                               |===============================================                       |  67%   |                                                                               |================================================                      |  68%   |                                                                               |================================================                      |  69%   |                                                                               |=================================================                     |  70%   |                                                                               |==================================================                    |  71%   |                                                                               |==================================================                    |  72%   |                                                                               |===================================================                   |  73%   |                                                                               |====================================================                  |  74%   |                                                                               |====================================================                  |  75%   |                                                                               |=====================================================                 |  76%   |                                                                               |======================================================                |  77%   |                                                                               |=======================================================               |  78%   |                                                                               |=======================================================               |  79%   |                                                                               |========================================================              |  80%   |                                                                               |=========================================================             |  81%   |                                                                               |=========================================================             |  82%   |                                                                               |==========================================================            |  83%   |                                                                               |===========================================================           |  84%   |                                                                               |============================================================          |  85%   |                                                                               |============================================================          |  86%   |                                                                               |=============================================================         |  87%   |                                                                               |==============================================================        |  88%   |                                                                               |==============================================================        |  89%   |                                                                               |===============================================================       |  90%   |                                                                               |================================================================      |  91%   |                                                                               |================================================================      |  92%   |                                                                               |=================================================================     |  93%   |                                                                               |==================================================================    |  94%   |                                                                               |==================================================================    |  95%   |                                                                               |===================================================================   |  96%   |                                                                               |====================================================================  |  97%   |                                                                               |===================================================================== |  98%   |                                                                               |===================================================================== |  99%   |                                                                               |======================================================================| 100% #> Done! #>   Production scores for 15 cell types #>   Indirect communication: 15 x 15 matrix # }"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/inferProduction.html","id":null,"dir":"Reference","previous_headings":"","what":"Infer Metabolite Production Potential — inferProduction","title":"Infer Metabolite Production Potential — inferProduction","text":"Infer metabolite production potential cell type based   enzyme expression patterns. Production potential reflects cell type's capacity   synthesize secrete metabolites intercellular communication.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/inferProduction.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Infer Metabolite Production Potential — inferProduction","text":"","code":"inferProduction(   object,   method = \"combined\",   mean_method = \"arithmetic\",   min_expression = 0,   min_pct = 0.1,   consider_degradation = TRUE,   consider_secretion = TRUE,   normalize = TRUE,   verbose = TRUE )"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/inferProduction.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Infer Metabolite Production Potential — inferProduction","text":"object scMetaLink object method Character. Scoring method: \"mean\", \"proportion\", \"combined\" mean_method Character. Method calculating mean expression: \"arithmetic\" (standard mean) \"trimean\" (robust outliers dropout). Trimean recommended single-cell data high dropout rates. min_expression Numeric. Minimum expression threshold min_pct Numeric. Minimum percentage expressing cells (0-1) consider_degradation Logical. Subtract degradation enzyme expression consider_secretion Logical. Weight secretion potential normalize Logical. Normalize scores across cell types verbose Logical. Print progress messages","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/inferProduction.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Infer Metabolite Production Potential — inferProduction","text":"Updated scMetaLink object production_scores slot filled","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/inferSensing.html","id":null,"dir":"Reference","previous_headings":"","what":"Infer Metabolite Sensing Capability — inferSensing","title":"Infer Metabolite Sensing Capability — inferSensing","text":"Infer metabolite sensing capability cell type based   receptor transporter expression. Sensing capability reflects cell type's   capacity detect respond extracellular metabolites.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/inferSensing.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Infer Metabolite Sensing Capability — inferSensing","text":"","code":"inferSensing(   object,   method = \"combined\",   mean_method = \"arithmetic\",   min_expression = 0,   min_pct = 0.1,   weight_by_affinity = TRUE,   include_transporters = TRUE,   use_hill = FALSE,   hill_n = 1,   hill_Kh = 0.5,   normalize = TRUE,   verbose = TRUE )"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/inferSensing.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Infer Metabolite Sensing Capability — inferSensing","text":"object scMetaLink object method Character. Scoring method: \"mean\", \"proportion\", \"combined\" mean_method Character. Method calculating mean expression: \"arithmetic\" (standard mean) \"trimean\" (robust outliers dropout). min_expression Numeric. Minimum expression threshold min_pct Numeric. Minimum percentage expressing cells (0-1) weight_by_affinity Logical. Weight receptor-metabolite affinity score include_transporters Logical. Include uptake transporters sensing use_hill Logical. Apply Hill function transformation model receptor binding saturation kinetics. TRUE, high expression levels show diminishing returns, reflecting biological receptor saturation. hill_n Numeric. Hill coefficient (cooperativity). Default 1 (cooperativity). Values > 1 indicate positive cooperativity. hill_Kh Numeric. Half-maximal response threshold (0-1 scale normalization). Default 0.5. Lower values mean saturation occurs lower expression levels. normalize Logical. Normalize scores across cell types verbose Logical. Print progress messages","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/inferSensing.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Infer Metabolite Sensing Capability — inferSensing","text":"Updated scMetaLink object sensing_scores slot filled","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/inferSensing.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Infer Metabolite Sensing Capability — inferSensing","text":"Hill function transformation models receptor-ligand binding dynamics: $$P = \\frac{E^n}{K_h^n + E^n}$$ E expression, n Hill coefficient, Kh half-maximal threshold. reflects biological reality receptor signaling saturates high ligand/receptor concentrations.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/inferSpatialLactateSignaling.html","id":null,"dir":"Reference","previous_headings":"","what":"Infer Spatial Lactate Signaling — inferSpatialLactateSignaling","title":"Infer Spatial Lactate Signaling — inferSpatialLactateSignaling","text":"Infers lactate signaling spatial transcriptomics data distance-weighted communication scores. Supports direct (HCAR1) indirect (proton-sensing GPCRs) pathways spatial context.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/inferSpatialLactateSignaling.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Infer Spatial Lactate Signaling — inferSpatialLactateSignaling","text":"","code":"inferSpatialLactateSignaling(   object,   max_distance = 200,   distance_decay = \"gaussian\",   sigma = 50,   include_direct = TRUE,   include_indirect = TRUE,   method = \"combined\",   comm_method = \"geometric\",   aggregate_by = \"cell_type\",   min_production = 0,   min_sensing = 0,   normalize = TRUE,   verbose = TRUE )"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/inferSpatialLactateSignaling.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Infer Spatial Lactate Signaling — inferSpatialLactateSignaling","text":"object spatial scMetaLink object (created createScMetaLinkFromSpatial) max_distance Numeric. Maximum communication distance micrometers. Spot pairs beyond distance considered non-interacting. Default 200 um. distance_decay Character. Distance decay function: \"gaussian\": Gaussian decay exp(-d^2/(2*sigma^2)) (default) \"exponential\": Exponential decay exp(-d/sigma) \"linear\": Linear decay max(0, 1 - d/max_distance) \"none\": distance weighting, use cell type level aggregation sigma Numeric. Decay parameter gaussian/exponential (um). Default 50 um. Literature suggests lactate medium-range diffusion (~50-80 um). include_direct Logical. Include direct lactate-HCAR1 signaling. Default TRUE. include_indirect Logical. Include indirect lactate-H+-GPCR signaling. Default TRUE. method Character. Scoring method: \"combined\", \"mean\", \"proportion\". Default \"combined\". comm_method Character. Communication score method: \"geometric\", \"product\", \"harmonic\". Default \"geometric\". aggregate_by Character. Aggregation level: \"cell_type\": Aggregate cell type (default) \"spot\": Return spot-level scores (memory intensive) \"\": Return levels min_production Numeric. Minimum production score threshold. Default 0. min_sensing Numeric. Minimum sensing score threshold. Default 0. normalize Logical. Normalize scores. Default TRUE. verbose Logical. Print progress messages. Default TRUE.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/inferSpatialLactateSignaling.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Infer Spatial Lactate Signaling — inferSpatialLactateSignaling","text":"Updated scMetaLink object spatial_lactate_signaling results   stored parameters slot, containing: spot_production Spot-level production scores spot_direct_sensing Spot-level direct sensing scores spot_indirect_sensing Spot-level indirect sensing scores celltype_communication Cell type level communication (aggregate_by includes \"cell_type\") spot_communication Spot level communication (aggregate_by includes \"spot\") parameters Analysis parameters","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/inferSpatialLactateSignaling.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Infer Spatial Lactate Signaling — inferSpatialLactateSignaling","text":"","code":"# \\donttest{ data(st_expr) data(st_meta) data(st_scalefactors)  # Create spatial object obj <- createScMetaLinkFromSpatial(   expression_data = st_expr,   spatial_coords = st_meta[, c(\"x\", \"y\")],   cell_meta = st_meta,   cell_type_column = \"cell_type\",   scale_factors = st_scalefactors ) #> Created spatial scMetaLink object with 4284 genes, 1000 spots, 6 cell types  # Run spatial lactate analysis obj <- inferSpatialLactateSignaling(obj) #> Inferring spatial lactate signaling... #>   Spots: 1000 #>   Cell types: 6 #>   Distance decay: gaussian (sigma=50 um, max=200 um) #>   Available lactate genes: 17/17 #>   Calculating spot-level expression scores... #>   Calculating spot-level production scores... #>   Calculating spot-level direct sensing scores... #>   Calculating spot-level indirect sensing scores... #>   Computing spatial distance weights... #>   Aggregating by cell type... #> Done! #>   Spot production scores: 1000 spots #>   Cell type communication: 6 x 6  # Access results spatial_results <- obj@parameters$spatial_lactate_signaling # }"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/listGenes.html","id":null,"dir":"Reference","previous_headings":"","what":"List Available Genes — listGenes","title":"List Available Genes — listGenes","text":"Get list genes database roles","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/listGenes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"List Available Genes — listGenes","text":"","code":"listGenes(role = \"all\")"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/listGenes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"List Available Genes — listGenes","text":"role Character. Filter role: \"\", \"enzyme\", \"receptor\", \"transporter\"","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/listGenes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"List Available Genes — listGenes","text":"data.frame gene information","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/listGenes.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"List Available Genes — listGenes","text":"","code":"# \\donttest{ # Get all genes genes <- listGenes()  # Get only receptor genes receptors <- listGenes(role = \"receptor\") # }"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/listMetabolites.html","id":null,"dir":"Reference","previous_headings":"","what":"List Available Metabolites — listMetabolites","title":"List Available Metabolites — listMetabolites","text":"Get list metabolites database properties","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/listMetabolites.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"List Available Metabolites — listMetabolites","text":"","code":"listMetabolites(type = \"all\")"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/listMetabolites.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"List Available Metabolites — listMetabolites","text":"type Character. Filter interaction type: \"\", \"signaling\" (lr ), \"metabolic\" (pd )","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/listMetabolites.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"List Available Metabolites — listMetabolites","text":"data.frame metabolite information","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/listMetabolites.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"List Available Metabolites — listMetabolites","text":"","code":"# \\donttest{ # Get all metabolites mets <- listMetabolites() head(mets) #> # A tibble: 6 × 4 #>   hmdb        metabolite        pubchem metabolite_subclass                      #>   <chr>       <chr>             <chr>   <chr>                                    #> 1 HMDB0001448 Sulfate           1117    Non-metal sulfates                       #> 2 HMDB0000208 Oxoglutaric acid  51      Gamma-keto acids and derivatives         #> 3 HMDB0000464 Calcium           271     NA                                       #> 4 HMDB0000131 Glycerol          753     Carbohydrates and carbohydrate conjugat… #> 5 HMDB0000429 17alpha-Estradiol 68570   Estrane steroids                         #> 6 HMDB0000990 Acetaldehyde      177     Carbonyl compounds                        # Get only signaling metabolites (those with receptors) signaling_mets <- listMetabolites(type = \"signaling\") # }"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/listTopPathways.html","id":null,"dir":"Reference","previous_headings":"","what":"List Top Pathways — listTopPathways","title":"List Top Pathways — listTopPathways","text":"List Top Pathways","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/listTopPathways.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"List Top Pathways — listTopPathways","text":"","code":"listTopPathways(object, n = 20)"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/listTopPathways.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"List Top Pathways — listTopPathways","text":"object scMetaLink object n Integer. Number top pathways","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/listTopPathways.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"List Top Pathways — listTopPathways","text":"data.frame top pathways","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/loadScMetaLink.html","id":null,"dir":"Reference","previous_headings":"","what":"Load scMetaLink Object — loadScMetaLink","title":"Load scMetaLink Object — loadScMetaLink","text":"Load scMetaLink Object","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/loadScMetaLink.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Load scMetaLink Object — loadScMetaLink","text":"","code":"loadScMetaLink(file)"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/loadScMetaLink.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Load scMetaLink Object — loadScMetaLink","text":"file Character. File path","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/loadScMetaLink.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Load scMetaLink Object — loadScMetaLink","text":"scMetaLink object","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/metalinksdb.html","id":null,"dir":"Reference","previous_headings":"","what":"MetalinksDB Database — metalinksdb","title":"MetalinksDB Database — metalinksdb","text":"Pre-compiled metabolite-protein interaction database MetalinksDB","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/metalinksdb.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"MetalinksDB Database — metalinksdb","text":"","code":"metalinksdb"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/metalinksdb.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"MetalinksDB Database — metalinksdb","text":"list containing following components: edges data.frame 41,894 metabolite-protein interactions containing: hmdb: HMDB metabolite identifier uniprot: UniProt protein identifier source: Data source combined_score: Interaction confidence score (0-1000) mor: Mode regulation (1=producing, -1=degrading, 0=binding) type: Interaction type (\"lr\"=ligand-receptor, \"pd\"=produce-degrade) transport_direction: transporters (\"\" \"\")  metabolites data.frame 1,128 metabolites containing: hmdb: HMDB identifier metabolite: Metabolite name pubchem: PubChem identifier metabolite_subclass: Chemical classification  proteins data.frame 4,374 proteins containing: uniprot: UniProt identifier gene_symbol: Gene symbol protein_type: Protein classification (enzyme, gpcr, transporter, etc.)  pathway data.frame 157,741 metabolite-pathway associations cell_location data.frame 2,816 subcellular location annotations tissue_location data.frame 2,410 tissue location annotations disease data.frame 3,216 disease associations","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/metalinksdb.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"MetalinksDB Database — metalinksdb","text":"MetalinksDB (https://metalinks.org/)","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/metalinksdb.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"MetalinksDB Database — metalinksdb","text":"database enables two types metabolite-mediated communication inference: **Ligand-Receptor (lr) type**: Direct metabolite-receptor binding interactions, primarily involving GPCRs, nuclear hormone receptors, ion channels. **Produce-Degrade (pd) type**: Enzyme-mediated metabolite production consumption, enabling inference metabolite availability enzyme expression.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/metalinksdb.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"MetalinksDB Database — metalinksdb","text":"Schafer, S., et al. (2023). MetalinksDB: knowledgebase metabolite-centric signaling. Nature Communications.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/metalinksdb.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"MetalinksDB Database — metalinksdb","text":"","code":"# \\donttest{ # Access the database db <- scMetaLink:::.load_metalinksdb()  # View available metabolites head(db$metabolites) #> # A tibble: 6 × 4 #>   hmdb        metabolite        pubchem metabolite_subclass                      #>   <chr>       <chr>             <chr>   <chr>                                    #> 1 HMDB0001448 Sulfate           1117    Non-metal sulfates                       #> 2 HMDB0000208 Oxoglutaric acid  51      Gamma-keto acids and derivatives         #> 3 HMDB0000464 Calcium           271     NA                                       #> 4 HMDB0000131 Glycerol          753     Carbohydrates and carbohydrate conjugat… #> 5 HMDB0000429 17alpha-Estradiol 68570   Estrane steroids                         #> 6 HMDB0000990 Acetaldehyde      177     Carbonyl compounds                        # Check interaction types table(db$edges$type) #>  #>    lr    pd  #> 11869 30025  # }"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotCommunicationCircle.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Communication Circle — plotCommunicationCircle","title":"Plot Communication Circle — plotCommunicationCircle","text":"Create chord diagram cell-cell communication","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotCommunicationCircle.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Communication Circle — plotCommunicationCircle","text":"","code":"plotCommunicationCircle(   object,   top_n = 50,   metabolite = NULL,   colors = NULL,   transparency = 0.5,   title = NULL )"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotCommunicationCircle.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Communication Circle — plotCommunicationCircle","text":"object scMetaLink object top_n Integer. Number top interactions show metabolite Character. Specific metabolite (NULL aggregated) colors Named vector. Colors cell types transparency Numeric. Link transparency (0-1) title Character. Plot title","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotCommunicationCircle.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Communication Circle — plotCommunicationCircle","text":"Invisibly returns NULL, plots chord diagram","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotCommunicationHeatmap.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Communication Heatmap — plotCommunicationHeatmap","title":"Plot Communication Heatmap — plotCommunicationHeatmap","text":"Create heatmap cell-cell communication","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotCommunicationHeatmap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Communication Heatmap — plotCommunicationHeatmap","text":"","code":"plotCommunicationHeatmap(   object,   metabolite = NULL,   cluster_rows = TRUE,   cluster_cols = TRUE,   show_values = FALSE,   colors = NULL,   title = NULL )"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotCommunicationHeatmap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Communication Heatmap — plotCommunicationHeatmap","text":"object scMetaLink object metabolite Character. Specific metabolite show (NULL aggregated) cluster_rows Logical. Cluster rows cluster_cols Logical. Cluster columns show_values Logical. Show values cells colors Character vector. Color palette title Character. Plot title","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotCommunicationHeatmap.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Communication Heatmap — plotCommunicationHeatmap","text":"ComplexHeatmap object","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotCommunicationHeatmap.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot Communication Heatmap — plotCommunicationHeatmap","text":"","code":"# \\donttest{ # Plot aggregated communication heatmap plotCommunicationHeatmap(obj) #> Error: object 'obj' not found  # Plot specific metabolite plotCommunicationHeatmap(obj, metabolite = \"HMDB0000148\") #> Error: object 'obj' not found # }"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotCommunicationNetwork.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Communication Network — plotCommunicationNetwork","title":"Plot Communication Network — plotCommunicationNetwork","text":"Create network visualization cell-cell communication","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotCommunicationNetwork.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Communication Network — plotCommunicationNetwork","text":"","code":"plotCommunicationNetwork(   object,   metabolite = NULL,   min_score = 0,   layout = \"fr\",   node_size_by = \"degree\",   edge_width_scale = 2,   colors = NULL )"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotCommunicationNetwork.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Communication Network — plotCommunicationNetwork","text":"object scMetaLink object metabolite Character. Specific metabolite (NULL aggregated) min_score Numeric. Minimum score threshold layout Character. Network layout algorithm node_size_by Character. Size nodes \"degree\" \"centrality\" edge_width_scale Numeric. Scale factor edge widths colors Named vector. Colors cell types","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotCommunicationNetwork.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Communication Network — plotCommunicationNetwork","text":"ggplot object","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotDifferentialCommunication.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Differential Communication — plotDifferentialCommunication","title":"Plot Differential Communication — plotDifferentialCommunication","text":"Visualize differential communication conditions","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotDifferentialCommunication.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Differential Communication — plotDifferentialCommunication","text":"","code":"plotDifferentialCommunication(diff_results, top_n = 30, type = \"bar\")"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotDifferentialCommunication.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Differential Communication — plotDifferentialCommunication","text":"diff_results data.frame compareCommunication() top_n Integer. Number top changes show type Character. \"bar\" \"volcano\"","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotDifferentialCommunication.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Differential Communication — plotDifferentialCommunication","text":"ggplot object","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotEnrichedPathways.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Enriched Pathways — plotEnrichedPathways","title":"Plot Enriched Pathways — plotEnrichedPathways","text":"Visualize enriched pathways enrichPathways()","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotEnrichedPathways.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Enriched Pathways — plotEnrichedPathways","text":"","code":"plotEnrichedPathways(enrichment_results, top_n = 20, show_overlap = TRUE)"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotEnrichedPathways.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Enriched Pathways — plotEnrichedPathways","text":"enrichment_results data.frame enrichPathways() top_n Integer. Number top pathways show show_overlap Logical. Show overlap count","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotEnrichedPathways.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Enriched Pathways — plotEnrichedPathways","text":"ggplot object","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotLactatePathwayComparison.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Lactate Pathway Comparison — plotLactatePathwayComparison","title":"Plot Lactate Pathway Comparison — plotLactatePathwayComparison","text":"Creates side--side comparison direct indirect lactate signaling pathways.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotLactatePathwayComparison.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Lactate Pathway Comparison — plotLactatePathwayComparison","text":"","code":"plotLactatePathwayComparison(object, show_production = TRUE)"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotLactatePathwayComparison.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Lactate Pathway Comparison — plotLactatePathwayComparison","text":"object scMetaLink object lactate signaling results show_production Logical. Also show production scores. Default TRUE.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotLactatePathwayComparison.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Lactate Pathway Comparison — plotLactatePathwayComparison","text":"ggplot2 object base R plot","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotLactateSignaling.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Lactate Signaling Heatmap — plotLactateSignaling","title":"Plot Lactate Signaling Heatmap — plotLactateSignaling","text":"Creates heatmap visualization lactate-mediated cell communication. Shows sender cell types rows receiver cell types columns.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotLactateSignaling.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Lactate Signaling Heatmap — plotLactateSignaling","text":"","code":"plotLactateSignaling(   object,   pathway = \"combined\",   cluster_rows = TRUE,   cluster_cols = TRUE,   show_values = FALSE,   colors = NULL,   title = NULL )"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotLactateSignaling.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Lactate Signaling Heatmap — plotLactateSignaling","text":"object scMetaLink object lactate signaling results pathway Character. pathway plot: \"direct\", \"indirect\", \"combined\". Default \"combined\". cluster_rows Logical. Cluster rows. Default TRUE. cluster_cols Logical. Cluster columns. Default TRUE. show_values Logical. Show score values cells. Default FALSE. colors Character vector. Color palette. Default viridis. title Character. Plot title. Default auto-generated.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotLactateSignaling.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Lactate Signaling Heatmap — plotLactateSignaling","text":"ggplot2 object ComplexHeatmap object (available)","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotLactateSignaling.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot Lactate Signaling Heatmap — plotLactateSignaling","text":"","code":"# \\donttest{ data(crc_example) obj <- createScMetaLink(crc_expr, crc_meta, \"cell_type\") #> Created scMetaLink object with 4210 genes, 2850 cells, 15 cell types obj <- inferLactateSignaling(obj) #> Inferring lactate-mediated cell communication... #>   Cell types: 15 #>   Direct pathway: TRUE #>   Indirect pathway: TRUE #>   Available lactate genes: 17/17 #>   Calculating gene expression scores... #>   Calculating lactate production scores... #>   Calculating direct sensing scores (HCAR1)... #>   Calculating indirect sensing scores (GPR4/65/68/132)... #>   Normalizing scores... #>   Calculating direct communication scores... #>   Calculating indirect communication scores... #>   Running permutation test for direct pathway (100 permutations)... #>    |                                                                               |                                                                      |   0%   |                                                                               |=                                                                     |   1%   |                                                                               |=                                                                     |   2%   |                                                                               |==                                                                    |   3%   |                                                                               |===                                                                   |   4%   |                                                                               |====                                                                  |   5%   |                                                                               |====                                                                  |   6%   |                                                                               |=====                                                                 |   7%   |                                                                               |======                                                                |   8%   |                                                                               |======                                                                |   9%   |                                                                               |=======                                                               |  10%   |                                                                               |========                                                              |  11%   |                                                                               |========                                                              |  12%   |                                                                               |=========                                                             |  13%   |                                                                               |==========                                                            |  14%   |                                                                               |==========                                                            |  15%   |                                                                               |===========                                                           |  16%   |                                                                               |============                                                          |  17%   |                                                                               |=============                                                         |  18%   |                                                                               |=============                                                         |  19%   |                                                                               |==============                                                        |  20%   |                                                                               |===============                                                       |  21%   |                                                                               |===============                                                       |  22%   |                                                                               |================                                                      |  23%   |                                                                               |=================                                                     |  24%   |                                                                               |==================                                                    |  25%   |                                                                               |==================                                                    |  26%   |                                                                               |===================                                                   |  27%   |                                                                               |====================                                                  |  28%   |                                                                               |====================                                                  |  29%   |                                                                               |=====================                                                 |  30%   |                                                                               |======================                                                |  31%   |                                                                               |======================                                                |  32%   |                                                                               |=======================                                               |  33%   |                                                                               |========================                                              |  34%   |                                                                               |========================                                              |  35%   |                                                                               |=========================                                             |  36%   |                                                                               |==========================                                            |  37%   |                                                                               |===========================                                           |  38%   |                                                                               |===========================                                           |  39%   |                                                                               |============================                                          |  40%   |                                                                               |=============================                                         |  41%   |                                                                               |=============================                                         |  42%   |                                                                               |==============================                                        |  43%   |                                                                               |===============================                                       |  44%   |                                                                               |================================                                      |  45%   |                                                                               |================================                                      |  46%   |                                                                               |=================================                                     |  47%   |                                                                               |==================================                                    |  48%   |                                                                               |==================================                                    |  49%   |                                                                               |===================================                                   |  50%   |                                                                               |====================================                                  |  51%   |                                                                               |====================================                                  |  52%   |                                                                               |=====================================                                 |  53%   |                                                                               |======================================                                |  54%   |                                                                               |======================================                                |  55%   |                                                                               |=======================================                               |  56%   |                                                                               |========================================                              |  57%   |                                                                               |=========================================                             |  58%   |                                                                               |=========================================                             |  59%   |                                                                               |==========================================                            |  60%   |                                                                               |===========================================                           |  61%   |                                                                               |===========================================                           |  62%   |                                                                               |============================================                          |  63%   |                                                                               |=============================================                         |  64%   |                                                                               |==============================================                        |  65%   |                                                                               |==============================================                        |  66%   |                                                                               |===============================================                       |  67%   |                                                                               |================================================                      |  68%   |                                                                               |================================================                      |  69%   |                                                                               |=================================================                     |  70%   |                                                                               |==================================================                    |  71%   |                                                                               |==================================================                    |  72%   |                                                                               |===================================================                   |  73%   |                                                                               |====================================================                  |  74%   |                                                                               |====================================================                  |  75%   |                                                                               |=====================================================                 |  76%   |                                                                               |======================================================                |  77%   |                                                                               |=======================================================               |  78%   |                                                                               |=======================================================               |  79%   |                                                                               |========================================================              |  80%   |                                                                               |=========================================================             |  81%   |                                                                               |=========================================================             |  82%   |                                                                               |==========================================================            |  83%   |                                                                               |===========================================================           |  84%   |                                                                               |============================================================          |  85%   |                                                                               |============================================================          |  86%   |                                                                               |=============================================================         |  87%   |                                                                               |==============================================================        |  88%   |                                                                               |==============================================================        |  89%   |                                                                               |===============================================================       |  90%   |                                                                               |================================================================      |  91%   |                                                                               |================================================================      |  92%   |                                                                               |=================================================================     |  93%   |                                                                               |==================================================================    |  94%   |                                                                               |==================================================================    |  95%   |                                                                               |===================================================================   |  96%   |                                                                               |====================================================================  |  97%   |                                                                               |===================================================================== |  98%   |                                                                               |===================================================================== |  99%   |                                                                               |======================================================================| 100% #>   Running permutation test for indirect pathway (100 permutations)... #>    |                                                                               |                                                                      |   0%   |                                                                               |=                                                                     |   1%   |                                                                               |=                                                                     |   2%   |                                                                               |==                                                                    |   3%   |                                                                               |===                                                                   |   4%   |                                                                               |====                                                                  |   5%   |                                                                               |====                                                                  |   6%   |                                                                               |=====                                                                 |   7%   |                                                                               |======                                                                |   8%   |                                                                               |======                                                                |   9%   |                                                                               |=======                                                               |  10%   |                                                                               |========                                                              |  11%   |                                                                               |========                                                              |  12%   |                                                                               |=========                                                             |  13%   |                                                                               |==========                                                            |  14%   |                                                                               |==========                                                            |  15%   |                                                                               |===========                                                           |  16%   |                                                                               |============                                                          |  17%   |                                                                               |=============                                                         |  18%   |                                                                               |=============                                                         |  19%   |                                                                               |==============                                                        |  20%   |                                                                               |===============                                                       |  21%   |                                                                               |===============                                                       |  22%   |                                                                               |================                                                      |  23%   |                                                                               |=================                                                     |  24%   |                                                                               |==================                                                    |  25%   |                                                                               |==================                                                    |  26%   |                                                                               |===================                                                   |  27%   |                                                                               |====================                                                  |  28%   |                                                                               |====================                                                  |  29%   |                                                                               |=====================                                                 |  30%   |                                                                               |======================                                                |  31%   |                                                                               |======================                                                |  32%   |                                                                               |=======================                                               |  33%   |                                                                               |========================                                              |  34%   |                                                                               |========================                                              |  35%   |                                                                               |=========================                                             |  36%   |                                                                               |==========================                                            |  37%   |                                                                               |===========================                                           |  38%   |                                                                               |===========================                                           |  39%   |                                                                               |============================                                          |  40%   |                                                                               |=============================                                         |  41%   |                                                                               |=============================                                         |  42%   |                                                                               |==============================                                        |  43%   |                                                                               |===============================                                       |  44%   |                                                                               |================================                                      |  45%   |                                                                               |================================                                      |  46%   |                                                                               |=================================                                     |  47%   |                                                                               |==================================                                    |  48%   |                                                                               |==================================                                    |  49%   |                                                                               |===================================                                   |  50%   |                                                                               |====================================                                  |  51%   |                                                                               |====================================                                  |  52%   |                                                                               |=====================================                                 |  53%   |                                                                               |======================================                                |  54%   |                                                                               |======================================                                |  55%   |                                                                               |=======================================                               |  56%   |                                                                               |========================================                              |  57%   |                                                                               |=========================================                             |  58%   |                                                                               |=========================================                             |  59%   |                                                                               |==========================================                            |  60%   |                                                                               |===========================================                           |  61%   |                                                                               |===========================================                           |  62%   |                                                                               |============================================                          |  63%   |                                                                               |=============================================                         |  64%   |                                                                               |==============================================                        |  65%   |                                                                               |==============================================                        |  66%   |                                                                               |===============================================                       |  67%   |                                                                               |================================================                      |  68%   |                                                                               |================================================                      |  69%   |                                                                               |=================================================                     |  70%   |                                                                               |==================================================                    |  71%   |                                                                               |==================================================                    |  72%   |                                                                               |===================================================                   |  73%   |                                                                               |====================================================                  |  74%   |                                                                               |====================================================                  |  75%   |                                                                               |=====================================================                 |  76%   |                                                                               |======================================================                |  77%   |                                                                               |=======================================================               |  78%   |                                                                               |=======================================================               |  79%   |                                                                               |========================================================              |  80%   |                                                                               |=========================================================             |  81%   |                                                                               |=========================================================             |  82%   |                                                                               |==========================================================            |  83%   |                                                                               |===========================================================           |  84%   |                                                                               |============================================================          |  85%   |                                                                               |============================================================          |  86%   |                                                                               |=============================================================         |  87%   |                                                                               |==============================================================        |  88%   |                                                                               |==============================================================        |  89%   |                                                                               |===============================================================       |  90%   |                                                                               |================================================================      |  91%   |                                                                               |================================================================      |  92%   |                                                                               |=================================================================     |  93%   |                                                                               |==================================================================    |  94%   |                                                                               |==================================================================    |  95%   |                                                                               |===================================================================   |  96%   |                                                                               |====================================================================  |  97%   |                                                                               |===================================================================== |  98%   |                                                                               |===================================================================== |  99%   |                                                                               |======================================================================| 100% #> Done! #>   Production scores for 15 cell types #>   Direct communication: 15 x 15 matrix #>   Indirect communication: 15 x 15 matrix plotLactateSignaling(obj, pathway = \"indirect\")  # }"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotMetaboliteProfile.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Metabolite Profile — plotMetaboliteProfile","title":"Plot Metabolite Profile — plotMetaboliteProfile","text":"Visualize production sensing profiles metabolite","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotMetaboliteProfile.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Metabolite Profile — plotMetaboliteProfile","text":"","code":"plotMetaboliteProfile(object, metabolite, show_genes = FALSE)"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotMetaboliteProfile.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Metabolite Profile — plotMetaboliteProfile","text":"object scMetaLink object metabolite Character. Metabolite HMDB ID name show_genes Logical. Show contributing genes","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotMetaboliteProfile.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Metabolite Profile — plotMetaboliteProfile","text":"ggplot object","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotPathwayCommunication.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Pathway Communication — plotPathwayCommunication","title":"Plot Pathway Communication — plotPathwayCommunication","text":"Visualize pathway-level communication","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotPathwayCommunication.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Pathway Communication — plotPathwayCommunication","text":"","code":"plotPathwayCommunication(object, top_pathways = 20, type = \"bar\")"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotPathwayCommunication.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Pathway Communication — plotPathwayCommunication","text":"object scMetaLink object top_pathways Integer. Number top pathways show type Character. \"heatmap\" \"bar\"","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotPathwayCommunication.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Pathway Communication — plotPathwayCommunication","text":"ggplot ComplexHeatmap object","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotSpatialCellTypes.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Spatial Cell Types — plotSpatialCellTypes","title":"Plot Spatial Cell Types — plotSpatialCellTypes","text":"Visualize cell type distribution spatial coordinates","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotSpatialCellTypes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Spatial Cell Types — plotSpatialCellTypes","text":"","code":"plotSpatialCellTypes(   object,   point_size = 1.5,   alpha = 0.8,   colors = NULL,   show_legend = TRUE )"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotSpatialCellTypes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Spatial Cell Types — plotSpatialCellTypes","text":"object scMetaLink object spatial information point_size Numeric. Size spot points alpha Numeric. Transparency (0-1) colors Character vector. Colors cell types (NULL default) show_legend Logical. Show legend","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotSpatialCellTypes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Spatial Cell Types — plotSpatialCellTypes","text":"ggplot2 object","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotSpatialCommunicationNetwork.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Spatial Communication Network — plotSpatialCommunicationNetwork","title":"Plot Spatial Communication Network — plotSpatialCommunicationNetwork","text":"Visualize cell-cell communication spatial context","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotSpatialCommunicationNetwork.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Spatial Communication Network — plotSpatialCommunicationNetwork","text":"","code":"plotSpatialCommunicationNetwork(   object,   metabolite = NULL,   sender_type = NULL,   receiver_type = NULL,   top_n = 20,   arrow_scale = 1,   point_size = 5,   show_labels = TRUE )"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotSpatialCommunicationNetwork.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Spatial Communication Network — plotSpatialCommunicationNetwork","text":"object scMetaLink object spatial communication results metabolite Character. Metabolite visualize (NULL aggregate) sender_type Character. Sender cell type (NULL ) receiver_type Character. Receiver cell type (NULL ) top_n Integer. Number top interactions show arrows arrow_scale Numeric. Scale factor arrow thickness point_size Numeric. Size cell type center points show_labels Logical. Show cell type labels","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotSpatialCommunicationNetwork.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Spatial Communication Network — plotSpatialCommunicationNetwork","text":"ggplot2 object","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotSpatialComparison.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Spatial Communication Comparison — plotSpatialComparison","title":"Plot Spatial Communication Comparison — plotSpatialComparison","text":"Compare communication patterns multiple metabolites","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotSpatialComparison.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Spatial Communication Comparison — plotSpatialComparison","text":"","code":"plotSpatialComparison(   object,   metabolites,   type = \"production\",   ncol = 2,   point_size = 1 )"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotSpatialComparison.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Spatial Communication Comparison — plotSpatialComparison","text":"object scMetaLink object spatial communication results metabolites Character vector. Metabolites compare type Character. \"production\" \"sensing\" ncol Integer. Number columns facet grid point_size Numeric. Size spot points","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotSpatialComparison.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Spatial Communication Comparison — plotSpatialComparison","text":"ggplot2 object","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotSpatialDistanceDistribution.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Spatial Distance Distribution — plotSpatialDistanceDistribution","title":"Plot Spatial Distance Distribution — plotSpatialDistanceDistribution","text":"Visualize distribution spatial distances spots","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotSpatialDistanceDistribution.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Spatial Distance Distribution — plotSpatialDistanceDistribution","text":"","code":"plotSpatialDistanceDistribution(   object,   by_celltype = FALSE,   max_distance = NULL,   bins = 50 )"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotSpatialDistanceDistribution.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Spatial Distance Distribution — plotSpatialDistanceDistribution","text":"object scMetaLink object spatial information by_celltype Logical. Show distances stratified cell type pairs max_distance Numeric. Maximum distance show (NULL ) bins Integer. Number histogram bins","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotSpatialDistanceDistribution.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Spatial Distance Distribution — plotSpatialDistanceDistribution","text":"ggplot2 object","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotSpatialFeature.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Spatial Communication Heatmap — plotSpatialFeature","title":"Plot Spatial Communication Heatmap — plotSpatialFeature","text":"Visualize metabolite communication spatial coordinates","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotSpatialFeature.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Spatial Communication Heatmap — plotSpatialFeature","text":"","code":"plotSpatialFeature(   object,   metabolite,   type = \"production\",   cell_type = NULL,   point_size = 1.5,   alpha = 0.8,   low_color = \"#FFFFCC\",   high_color = \"#E31A1C\",   title = NULL )"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotSpatialFeature.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Spatial Communication Heatmap — plotSpatialFeature","text":"object scMetaLink object spatial information metabolite Character. Metabolite ID name visualize type Character. plot: \"production\", \"sensing\", \"communication\" cell_type Character. communication, specify sender receiver cell type point_size Numeric. Size spot points alpha Numeric. Transparency (0-1) low_color Character. Color low values high_color Character. Color high values title Character. Plot title (NULL auto)","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotSpatialFeature.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Spatial Communication Heatmap — plotSpatialFeature","text":"ggplot2 object","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotSpatialFeature.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot Spatial Communication Heatmap — plotSpatialFeature","text":"","code":"# \\donttest{ data(st_expr) data(st_meta) data(st_scalefactors) obj <- createScMetaLinkFromSpatial(st_expr, st_meta[,c(\"x\",\"y\")],                                    st_meta, \"cell_type\", st_scalefactors) #> Created spatial scMetaLink object with 4284 genes, 1000 spots, 6 cell types obj <- inferProduction(obj) #> Inferring production potential for 6 cell types... #>   Calculating cell type expression profiles... #>   Building metabolite-gene mapping... #>   Found 15699 production enzyme-metabolite pairs #>   Computing production scores (matrix multiplication)... #>   Adjusting for degradation... #>   Applying secretion potential weights... #>   Normalizing scores... #>   Computed production scores for 796 metabolites #> Done!  # Plot lactate production plotSpatialFeature(obj, metabolite = \"HMDB0000190\", type = \"production\")  # }"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotSpatialHotspots.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Spatial Hotspots — plotSpatialHotspots","title":"Plot Spatial Hotspots — plotSpatialHotspots","text":"Visualize communication hotspots spatial coordinates","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotSpatialHotspots.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Spatial Hotspots — plotSpatialHotspots","text":"","code":"plotSpatialHotspots(   object,   metabolite = NULL,   type = \"sender\",   point_size = 1,   hotspot_size = 5,   n_hotspots = 5 )"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotSpatialHotspots.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Spatial Hotspots — plotSpatialHotspots","text":"object scMetaLink object spatial communication results metabolite Character. Metabolite analyze (NULL aggregate) type Character. \"sender\" \"receiver\" point_size Numeric. Size spot points hotspot_size Numeric. Size hotspot markers n_hotspots Integer. Number hotspots highlight","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotSpatialHotspots.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Spatial Hotspots — plotSpatialHotspots","text":"ggplot2 object","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotSpatialLactate.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Spatial Lactate Signaling — plotSpatialLactate","title":"Plot Spatial Lactate Signaling — plotSpatialLactate","text":"Visualizes spatial distribution lactate production sensing scores.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotSpatialLactate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Spatial Lactate Signaling — plotSpatialLactate","text":"","code":"plotSpatialLactate(object, type = \"production\", point_size = 2, title = NULL)"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotSpatialLactate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Spatial Lactate Signaling — plotSpatialLactate","text":"object scMetaLink object spatial lactate signaling results type Character. plot: \"production\", \"direct_sensing\", \"indirect_sensing\", \"\". Default \"production\". point_size Numeric. Size spots. Default 2. title Character. Plot title. Default auto-generated.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotSpatialLactate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Spatial Lactate Signaling — plotSpatialLactate","text":"ggplot2 object base R plot","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotTopInteractions.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Top Interactions — plotTopInteractions","title":"Plot Top Interactions — plotTopInteractions","text":"Dot plot top metabolite-mediated interactions","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotTopInteractions.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Top Interactions — plotTopInteractions","text":"","code":"plotTopInteractions(object, top_n = 30, group_by = \"metabolite\")"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotTopInteractions.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Top Interactions — plotTopInteractions","text":"object scMetaLink object top_n Integer. Number top interactions group_by Character. Group \"sender\", \"receiver\", \"metabolite\"","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/plotTopInteractions.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Top Interactions — plotTopInteractions","text":"ggplot object","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/runScMetaLink.html","id":null,"dir":"Reference","previous_headings":"","what":"Run Complete scMetaLink Analysis — runScMetaLink","title":"Run Complete scMetaLink Analysis — runScMetaLink","text":"One-step function run complete metabolite-mediated cell   communication analysis pipeline","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/runScMetaLink.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run Complete scMetaLink Analysis — runScMetaLink","text":"","code":"runScMetaLink(   expression_data,   cell_meta,   cell_type_column = \"cell_type\",   method = \"combined\",   min_cells = 10,   min_pct = 0.1,   n_permutations = 1000,   pvalue_threshold = 0.05,   n_cores = 1,   verbose = TRUE )"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/runScMetaLink.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run Complete scMetaLink Analysis — runScMetaLink","text":"expression_data matrix sparse matrix normalized expression cell_meta data.frame cell metadata cell_type_column Character. Column name cell type annotations method Character. Expression scoring method: \"mean\", \"proportion\", \"combined\" min_cells Integer. Minimum cells per cell type min_pct Numeric. Minimum percentage expressing cells (0-1) n_permutations Integer. Number permutations significance testing pvalue_threshold Numeric. P-value threshold significance n_cores Integer. Number cores parallel computing verbose Logical. Print progress messages","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/runScMetaLink.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run Complete scMetaLink Analysis — runScMetaLink","text":"scMetaLink object analysis completed","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/runScMetaLink.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Run Complete scMetaLink Analysis — runScMetaLink","text":"function runs complete scMetaLink pipeline: Create scMetaLink object expression data Infer metabolite production potential (MPP) Infer metabolite sensing capability (MSC) Compute cell-cell communication scores Perform permutation-based significance testing Filter significant interactions Aggregate pathway","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/runScMetaLink.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run Complete scMetaLink Analysis — runScMetaLink","text":"","code":"# \\donttest{ # Run complete analysis result <- runScMetaLink(   expression_data = expr_matrix,   cell_meta = cell_metadata,   cell_type_column = \"cell_type\",   n_permutations = 1000 ) #> === Step 1/6: Creating scMetaLink object === #> Error: object 'expr_matrix' not found  # View significant interactions sig <- getSignificantInteractions(result) #> Error in h(simpleError(msg, call)): error in evaluating the argument 'object' in selecting a method for function 'getSignificantInteractions': object 'result' not found head(sig) #> Error: object 'sig' not found # }"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/runScMetaLinkSeurat.html","id":null,"dir":"Reference","previous_headings":"","what":"Run scMetaLink from Seurat Object — runScMetaLinkSeurat","title":"Run scMetaLink from Seurat Object — runScMetaLinkSeurat","text":"Convenience function run analysis Seurat object","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/runScMetaLinkSeurat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run scMetaLink from Seurat Object — runScMetaLinkSeurat","text":"","code":"runScMetaLinkSeurat(   seurat_obj,   cell_type_column = \"cell_type\",   assay = \"RNA\",   slot = \"data\",   ... )"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/runScMetaLinkSeurat.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run scMetaLink from Seurat Object — runScMetaLinkSeurat","text":"seurat_obj Seurat object cell_type_column Character. Column meta.data cell type assay Character. Assay use slot Character. Slot use (\"data\" \"counts\") ... Additional arguments passed runScMetaLink","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/runScMetaLinkSeurat.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run scMetaLink from Seurat Object — runScMetaLinkSeurat","text":"scMetaLink object","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/saveScMetaLink.html","id":null,"dir":"Reference","previous_headings":"","what":"Save scMetaLink Object — saveScMetaLink","title":"Save scMetaLink Object — saveScMetaLink","text":"Save scMetaLink Object","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/saveScMetaLink.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Save scMetaLink Object — saveScMetaLink","text":"","code":"saveScMetaLink(object, file)"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/saveScMetaLink.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Save scMetaLink Object — saveScMetaLink","text":"object scMetaLink object file Character. File path (RDS format)","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/saveScMetaLink.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Save scMetaLink Object — saveScMetaLink","text":"Invisibly returns file path","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/scMetaLink-class.html","id":null,"dir":"Reference","previous_headings":"","what":"scMetaLink Class Definition — scMetaLink-class","title":"scMetaLink Class Definition — scMetaLink-class","text":"S4 class storing metabolite-mediated cell communication analysis results","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/scMetaLink-class.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"scMetaLink Class Definition — scMetaLink-class","text":"","code":"# S4 method for class 'scMetaLink' show(object)"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/scMetaLink-class.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"scMetaLink Class Definition — scMetaLink-class","text":"object scMetaLink object","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/scMetaLink-class.html","id":"slots","dir":"Reference","previous_headings":"","what":"Slots","title":"scMetaLink Class Definition — scMetaLink-class","text":"expression_data Matrix. Normalized gene expression matrix (genes x cells) cell_meta data.frame. Cell metadata cell type annotations cell_type_column Character. Column name cell type cell_meta production_scores Matrix. Metabolite production potential scores (metabolites x cell_types) sensing_scores Matrix. Metabolite sensing capability scores (metabolites x cell_types) communication_scores Array. Communication scores (sender x receiver x metabolite) communication_pvalues Array. P-values permutation test significant_interactions data.frame. Filtered significant interactions pathway_aggregated data.frame. Pathway-level aggregated results parameters list. Analysis parameters database list. MetalinksDB reference data","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/scMetaLink-package.html","id":null,"dir":"Reference","previous_headings":"","what":"scMetaLink: Single-Cell Metabolite-Mediated Cell Communication Analysis — scMetaLink-package","title":"scMetaLink: Single-Cell Metabolite-Mediated Cell Communication Analysis — scMetaLink-package","text":"comprehensive framework inferring metabolite-mediated cell-cell communication single-cell transcriptomic data. scMetaLink integrates metabolite production potential via enzyme expression, metabolite sensing capability via receptor transporter expression, secretion potential construct intercellular metabolic communication networks.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/scMetaLink-package.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"scMetaLink: Single-Cell Metabolite-Mediated Cell Communication Analysis — scMetaLink-package","text":"package provides following main functions: createScMetaLink: Create analysis object expression data inferProduction: Infer metabolite production potential inferSensing: Infer metabolite sensing capability computeCommunication: Compute cell-cell communication scores filterSignificantInteractions: Filter significant interactions aggregateByPathway: Aggregate metabolic pathways runScMetaLink: Run complete analysis pipeline spatial transcriptomics data: createScMetaLinkFromSpatial: Create object spatial data computeSpatialCommunication: Compute spatially-weighted communication","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/scMetaLink-package.html","id":"database","dir":"Reference","previous_headings":"","what":"Database","title":"scMetaLink: Single-Cell Metabolite-Mediated Cell Communication Analysis — scMetaLink-package","text":"scMetaLink utilizes MetalinksDB, containing: 41,894 metabolite-protein interactions 1,128 metabolites 4,374 proteins/genes 157,741 pathway associations","code":""},{"path":[]},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/scMetaLink-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"scMetaLink: Single-Cell Metabolite-Mediated Cell Communication Analysis — scMetaLink-package","text":"Zaoqu Liu liuzaoqu@163.com","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/searchGene.html","id":null,"dir":"Reference","previous_headings":"","what":"Search Gene in Database — searchGene","title":"Search Gene in Database — searchGene","text":"Search Gene Database","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/searchGene.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Search Gene in Database — searchGene","text":"","code":"searchGene(query)"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/searchGene.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Search Gene in Database — searchGene","text":"query Character. Gene symbol","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/searchGene.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Search Gene in Database — searchGene","text":"data.frame gene information associated metabolites","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/searchMetabolite.html","id":null,"dir":"Reference","previous_headings":"","what":"Search Metabolite in Database — searchMetabolite","title":"Search Metabolite in Database — searchMetabolite","text":"Search Metabolite Database","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/searchMetabolite.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Search Metabolite in Database — searchMetabolite","text":"","code":"searchMetabolite(query, exact = FALSE)"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/searchMetabolite.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Search Metabolite in Database — searchMetabolite","text":"query Character. Search query (name HMDB ID) exact Logical. Exact match ","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/searchMetabolite.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Search Metabolite in Database — searchMetabolite","text":"data.frame matching metabolites","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/spatial.html","id":null,"dir":"Reference","previous_headings":"","what":"scMetaLink Spatial Transcriptomics Module — spatial","title":"scMetaLink Spatial Transcriptomics Module — spatial","text":"Functions analyzing metabolite-mediated cell communication   spatial transcriptomics data.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/spatial_visualization.html","id":null,"dir":"Reference","previous_headings":"","what":"scMetaLink Spatial Visualization Functions — spatial_visualization","title":"scMetaLink Spatial Visualization Functions — spatial_visualization","text":"Visualization functions spatial metabolite communication analysis","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/st_expr.html","id":null,"dir":"Reference","previous_headings":"","what":"Colon Spatial Transcriptomics Expression Data — st_expr","title":"Colon Spatial Transcriptomics Expression Data — st_expr","text":"Example 10x Visium spatial transcriptomics expression matrix colon tissue","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/st_expr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Colon Spatial Transcriptomics Expression Data — st_expr","text":"","code":"st_expr"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/st_expr.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Colon Spatial Transcriptomics Expression Data — st_expr","text":"sparse dgCMatrix 4,284 genes (rows) x 1,000 spots (columns).   genes present MetalinksDB included reduce file size.","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/st_expr.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Colon Spatial Transcriptomics Expression Data — st_expr","text":"Colon spatial transcriptomics dataset","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/st_expr.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Colon Spatial Transcriptomics Expression Data — st_expr","text":"subset colon Visium data containing 1,000 randomly sampled spots. data suitable testing spatial metabolite communication analysis. Technical specifications: Platform: 10x Genomics Visium Spot diameter: 55 um Resolution: ~2.37 pixels/um Genes: 4,284 (filtered MetalinksDB) Spots: 1,000 (subsampled 3,313)","code":""},{"path":[]},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/st_expr.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Colon Spatial Transcriptomics Expression Data — st_expr","text":"","code":"# \\donttest{ data(st_expr) data(st_meta) data(st_scalefactors)  # Check dimensions dim(st_expr) #> [1] 4284 1000  # View spatial coordinates head(st_meta) #>                        x     y array_row array_col   cell_type #> TAGTCCCGGAGACCAC-1  6642 13195        66        48 Endothelial #> GTGCGTGTATATGAGC-1 10097  8796        41        83     Stromal #> CCGGTATCTGGCGACT-1 10371 15069        77        85  Fibroblast #> CCCAAGAATGCACGGT-1 10519  1993         2        88      Immune #> CGAAACATAGATGGCA-1  9435  3574        11        77      Immune #> TTCTTATCCGCTGGGT-1 11917 10169        49       101  Fibroblast  # Run spatial scMetaLink analysis obj <- createScMetaLinkFromSpatial(   expression_data = st_expr,   spatial_coords = st_meta[, c(\"x\", \"y\")],   cell_meta = st_meta,   cell_type_column = \"cell_type\" ) #> Created spatial scMetaLink object with 4284 genes, 1000 spots, 6 cell types #> Warning: Coordinates appear to be in pixels (range: 13511). For Visium data, please provide scale_factors with 'pixels_per_um'. Without correct scaling, distance parameters (sigma, threshold) will be interpreted as pixels instead of micrometers, leading to incorrect results. Assuming coordinates are in micrometers for now (pixels_per_um = 1). # }"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/st_meta.html","id":null,"dir":"Reference","previous_headings":"","what":"Colon Spatial Transcriptomics Metadata — st_meta","title":"Colon Spatial Transcriptomics Metadata — st_meta","text":"Spot metadata colon Visium example dataset","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/st_meta.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Colon Spatial Transcriptomics Metadata — st_meta","text":"","code":"st_meta"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/st_meta.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Colon Spatial Transcriptomics Metadata — st_meta","text":"data.frame 1,000 rows (spots) 5 columns: x X coordinate image pixels (imagecol) y Y coordinate image pixels (imagerow) array_row Row position Visium array array_col Column position Visium array cell_type Cell type annotation (mock clusters testing)","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/st_meta.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Colon Spatial Transcriptomics Metadata — st_meta","text":"cell_type column contains mock cell type annotations generated spatial k-means clustering. real analysis, users provide cell type annotations deconvolution methods (e.g., RCTD, cell2location, SPOTlight) manual annotation. Cell type distribution example: Epithelial: ~189 spots Fibroblast: ~232 spots Endothelial: ~174 spots Immune: ~145 spots Stromal: ~133 spots Tumor: ~127 spots","code":""},{"path":[]},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/st_meta.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Colon Spatial Transcriptomics Metadata — st_meta","text":"","code":"# \\donttest{ data(st_meta)  # View spot distribution table(st_meta$cell_type) #>  #> Endothelial  Epithelial  Fibroblast      Immune     Stromal       Tumor  #>         174         189         232         145         133         127   # Plot spatial coordinates plot(st_meta$x, st_meta$y, col = as.factor(st_meta$cell_type), pch = 16)  # }"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/st_scalefactors.html","id":null,"dir":"Reference","previous_headings":"","what":"Colon Spatial Transcriptomics Scale Factors — st_scalefactors","title":"Colon Spatial Transcriptomics Scale Factors — st_scalefactors","text":"Scale factors colon Visium example dataset","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/st_scalefactors.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Colon Spatial Transcriptomics Scale Factors — st_scalefactors","text":"","code":"st_scalefactors"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/st_scalefactors.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Colon Spatial Transcriptomics Scale Factors — st_scalefactors","text":"list containing: spot_diameter_fullres Spot diameter full resolution pixels (~130) tissue_hires_scalef Scale factor high-res image (~0.12) tissue_lowres_scalef Scale factor low-res image (~0.037) spot_diameter_um Spot diameter micrometers (55 um) pixels_per_um Pixels per micrometer (~2.37)","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/st_scalefactors.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Colon Spatial Transcriptomics Scale Factors — st_scalefactors","text":"scale factors essential converting pixel coordinates physical distances (micrometers). standard Visium spot diameter 55 um, used calculate pixels_per_um conversion factor. spatial communication analysis, distances converted micrometers enable biologically meaningful distance thresholds.","code":""},{"path":[]},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/st_scalefactors.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Colon Spatial Transcriptomics Scale Factors — st_scalefactors","text":"","code":"# \\donttest{ data(st_scalefactors)  # Convert pixel distance to micrometers pixel_distance <- 500 um_distance <- pixel_distance / st_scalefactors$pixels_per_um cat(\"Distance:\", um_distance, \"um\\n\") #> Distance: 211.1615 um # }"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/summarizeCommunicationPairs.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarize Communication by Cell Type Pairs — summarizeCommunicationPairs","title":"Summarize Communication by Cell Type Pairs — summarizeCommunicationPairs","text":"Summarize Communication Cell Type Pairs","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/summarizeCommunicationPairs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarize Communication by Cell Type Pairs — summarizeCommunicationPairs","text":"","code":"summarizeCommunicationPairs(object, aggregate_method = \"sum\")"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/summarizeCommunicationPairs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarize Communication by Cell Type Pairs — summarizeCommunicationPairs","text":"object scMetaLink object aggregate_method Character. \"sum\", \"mean\", \"count\"","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/summarizeCommunicationPairs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summarize Communication by Cell Type Pairs — summarizeCommunicationPairs","text":"data.frame summarized communication","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/summarizePathwayActivity.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarize Pathway Activity — summarizePathwayActivity","title":"Summarize Pathway Activity — summarizePathwayActivity","text":"Summarize Pathway Activity","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/summarizePathwayActivity.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarize Pathway Activity — summarizePathwayActivity","text":"","code":"summarizePathwayActivity(object)"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/summarizePathwayActivity.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarize Pathway Activity — summarizePathwayActivity","text":"object scMetaLink object","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/summarizePathwayActivity.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summarize Pathway Activity — summarizePathwayActivity","text":"data.frame pathway activity summary","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/utils.html","id":null,"dir":"Reference","previous_headings":"","what":"scMetaLink Utility Functions — utils","title":"scMetaLink Utility Functions — utils","text":"Internal utility functions scMetaLink package","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/utils.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"scMetaLink Utility Functions — utils","text":"","code":".check_dependencies(packages, type = \"error\")"},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/reference/utils.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"scMetaLink Utility Functions — utils","text":"packages Character vector package names type Character. \"error\" stop, \"warning\" warn","code":""},{"path":[]},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/news/index.html","id":"new-features-0-99-0","dir":"Changelog","previous_headings":"","what":"New Features","title":"scMetaLink 0.99.0","text":"Initial Bioconductor submission createScMetaLink() - Create scMetaLink object expression data createScMetaLinkFromSeurat() - Create Seurat object createScMetaLinkFromSCE() - Create SingleCellExperiment createScMetaLinkFromSpatial() - Create spatial transcriptomics data inferProduction() - Infer metabolite production potential inferSensing() - Infer metabolite sensing capability computeCommunication() - Compute cell-cell communication scores computeSpatialCommunication() - Spatial communication analysis filterSignificantInteractions() - Filter statistical significance aggregateByPathway() - Pathway-level aggregation","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/news/index.html","id":"lactate-signaling-module-0-99-0","dir":"Changelog","previous_headings":"","what":"Lactate Signaling Module","title":"scMetaLink 0.99.0","text":"inferLactateSignaling() - Specialized lactate communication analysis checkLactateGenes() - Check lactate-related gene availability getLactateGenes() - Get curated lactate gene sets","code":""},{"path":"https://Zaoqu-Liu.github.io/scMetaLink/news/index.html","id":"visualization-0-99-0","dir":"Changelog","previous_headings":"","what":"Visualization","title":"scMetaLink 0.99.0","text":"plotCommunicationHeatmap() - Communication heatmap plotCommunicationCircle() - Chord diagram plotCommunicationNetwork() - Network visualization plotMetaboliteFlow() - Metabolite flow diagram plotSpatialCellTypes() - Spatial cell type distribution plotSpatialFeature() - Spatial feature maps plotSpatialCommunicationNetwork() - Spatial network overlay","code":""}]
