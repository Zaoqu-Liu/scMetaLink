% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/lactate.R
\name{inferSpatialLactateSignaling}
\alias{inferSpatialLactateSignaling}
\title{Infer Spatial Lactate Signaling}
\usage{
inferSpatialLactateSignaling(
  object,
  max_distance = 200,
  distance_decay = "gaussian",
  sigma = 50,
  include_direct = TRUE,
  include_indirect = TRUE,
  method = "combined",
  comm_method = "geometric",
  aggregate_by = "cell_type",
  min_production = 0,
  min_sensing = 0,
  normalize = TRUE,
  verbose = TRUE
)
}
\arguments{
\item{object}{A spatial scMetaLink object (created with createScMetaLinkFromSpatial)}

\item{max_distance}{Numeric. Maximum communication distance in micrometers.
Spot pairs beyond this distance are considered non-interacting. Default 200 um.}

\item{distance_decay}{Character. Distance decay function:
\itemize{
  \item "gaussian": Gaussian decay exp(-d^2/(2*sigma^2)) (default)
  \item "exponential": Exponential decay exp(-d/sigma)
  \item "linear": Linear decay max(0, 1 - d/max_distance)
  \item "none": No distance weighting, use cell type level aggregation
}}

\item{sigma}{Numeric. Decay parameter for gaussian/exponential (in um). Default 50 um.
Literature suggests lactate has medium-range diffusion (~50-80 um).}

\item{include_direct}{Logical. Include direct lactate-HCAR1 signaling. Default TRUE.}

\item{include_indirect}{Logical. Include indirect lactate-H+-GPCR signaling. Default TRUE.}

\item{method}{Character. Scoring method: "combined", "mean", or "proportion". Default "combined".}

\item{comm_method}{Character. Communication score method: "geometric", "product", "harmonic".
Default "geometric".}

\item{aggregate_by}{Character. Aggregation level:
\itemize{
  \item "cell_type": Aggregate by cell type (default)
  \item "spot": Return spot-level scores (memory intensive)
  \item "both": Return both levels
}}

\item{min_production}{Numeric. Minimum production score threshold. Default 0.}

\item{min_sensing}{Numeric. Minimum sensing score threshold. Default 0.}

\item{normalize}{Logical. Normalize scores. Default TRUE.}

\item{verbose}{Logical. Print progress messages. Default TRUE.}
}
\value{
Updated scMetaLink object with spatial_lactate_signaling results
  stored in the parameters slot, containing:
  \item{spot_production}{Spot-level production scores}
  \item{spot_direct_sensing}{Spot-level direct sensing scores}
  \item{spot_indirect_sensing}{Spot-level indirect sensing scores}
  \item{celltype_communication}{Cell type level communication (if aggregate_by includes "cell_type")}
  \item{spot_communication}{Spot level communication (if aggregate_by includes "spot")}
  \item{parameters}{Analysis parameters}
}
\description{
Infers lactate signaling in spatial transcriptomics data with distance-weighted
communication scores. Supports both direct (HCAR1) and indirect (proton-sensing
GPCRs) pathways with spatial context.
}
\examples{
\donttest{
data(st_expr)
data(st_meta)
data(st_scalefactors)

# Create spatial object
obj <- createScMetaLinkFromSpatial(
  expression_data = st_expr,
  spatial_coords = st_meta[, c("x", "y")],
  cell_meta = st_meta,
  cell_type_column = "cell_type",
  scale_factors = st_scalefactors
)

# Run spatial lactate analysis
obj <- inferSpatialLactateSignaling(obj)

# Access results
spatial_results <- obj@parameters$spatial_lactate_signaling
}
}
