<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Single-Cell Metabolite-Mediated Cell Communication Analysis â€¢ scMetaLink</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Single-Cell Metabolite-Mediated Cell Communication Analysis">
<meta property="og:description" content="A comprehensive framework for inferring metabolite-mediated cell-cell communication from single-cell transcriptomic data. scMetaLink integrates metabolite production potential via enzyme expression, metabolite sensing capability via receptor and transporter expression, and secretion potential to construct intercellular metabolic communication networks. The package leverages the MetalinksDB database containing 41894 metabolite-protein interactions covering 1128 metabolites and 4374 proteins. Key features include probabilistic inference of metabolite production, receptor-mediated metabolite sensing quantification, permutation-based statistical testing with multiple hypothesis correction, pathway-level aggregation analysis, and publication-ready visualization.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">scMetaLink</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.99.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/quick-start.html">Quick Start Guide</a>
    </li>
    <li>
      <a href="articles/theory.html">Theory &amp; Methods</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/Zaoqu-Liu/scMetaLink/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="scmetalink">scMetaLink<a class="anchor" aria-label="anchor" href="#scmetalink"></a>
</h1></div>
<!-- badges: start -->

<p><strong>scMetaLink</strong> is an R package for inferring metabolite-mediated cell-cell communication from single-cell and spatial transcriptomics data.</p>
<p>ðŸ“– <strong>Documentation</strong>: <a href="https://Zaoqu-Liu.github.io/scMetaLink/" class="external-link uri">https://Zaoqu-Liu.github.io/scMetaLink/</a></p>
<div class="section level2">
<h2 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h2>
<p>Metabolites serve as critical signaling molecules in the cellular microenvironment. While tools like CellChat and CellPhoneDB have advanced our understanding of ligand-receptor interactions, the metabolic dimension of intercellular communication remains underexplored. scMetaLink addresses this gap by integrating enzyme expression, transporter activity, and receptor-metabolite interactions to reconstruct metabolite-mediated communication networks.</p>
</div>
<div class="section level2">
<h2 id="workflow">Workflow<a class="anchor" aria-label="anchor" href="#workflow"></a>
</h2>
<p align="center">
<img src="reference/figures/flowchart.png" width="90%"></p>
</div>
<div class="section level2">
<h2 id="features">Features<a class="anchor" aria-label="anchor" href="#features"></a>
</h2>
<ul>
<li>
<strong>Metabolite Production Inference</strong>: Estimate metabolite production potential based on biosynthetic enzyme expression</li>
<li>
<strong>Metabolite Sensing Analysis</strong>: Quantify sensing capability via receptors (GPCRs, nuclear receptors) and transporters</li>
<li>
<strong>Statistical Framework</strong>: Permutation-based significance testing with multiple hypothesis correction</li>
<li>
<strong>Pathway Integration</strong>: Aggregate communication patterns at the pathway level</li>
<li>
<strong>Spatial Transcriptomics</strong>: Distance-weighted communication analysis for spatial data</li>
<li>
<strong>Visualization</strong>: Heatmaps, chord diagrams, network plots, and spatial maps</li>
</ul>
</div>
<div class="section level2">
<h2 id="database">Database<a class="anchor" aria-label="anchor" href="#database"></a>
</h2>
<p>scMetaLink utilizes MetalinksDB, containing:</p>
<ul>
<li>41,894 metabolite-protein interactions</li>
<li>1,128 metabolites</li>
<li>4,374 proteins/genes</li>
<li>157,741 pathway associations</li>
</ul>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<div class="section level3">
<h3 id="from-r-universe-recommended">From r-universe (Recommended)<a class="anchor" aria-label="anchor" href="#from-r-universe-recommended"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"scMetaLink"</span>, repos <span class="op">=</span> <span class="st">"https://zaoqu-liu.r-universe.dev"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="from-github">From GitHub<a class="anchor" aria-label="anchor" href="#from-github"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install devtools if needed</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://devtools.r-lib.org/" class="external-link">"devtools"</a></span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"Zaoqu-Liu/scMetaLink"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="quick-start">Quick Start<a class="anchor" aria-label="anchor" href="#quick-start"></a>
</h2>
<div class="section level3">
<h3 id="single-cell-analysis">Single-Cell Analysis<a class="anchor" aria-label="anchor" href="#single-cell-analysis"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Zaoqu-Liu/scMetaLink" class="external-link">scMetaLink</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create scMetaLink object</span></span>
<span><span class="va">obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/createScMetaLink.html">createScMetaLink</a></span><span class="op">(</span></span>
<span>  expression_data <span class="op">=</span> <span class="va">expr_matrix</span>,</span>
<span>  cell_meta <span class="op">=</span> <span class="va">cell_metadata</span>,</span>
<span>  cell_type_column <span class="op">=</span> <span class="st">"cell_type"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Infer metabolite production and sensing</span></span>
<span><span class="va">obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/inferProduction.html">inferProduction</a></span><span class="op">(</span><span class="va">obj</span><span class="op">)</span></span>
<span><span class="va">obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/inferSensing.html">inferSensing</a></span><span class="op">(</span><span class="va">obj</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compute communication with significance testing</span></span>
<span><span class="va">obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/computeCommunication.html">computeCommunication</a></span><span class="op">(</span><span class="va">obj</span>, n_permutations <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="va">obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/filterSignificantInteractions.html">filterSignificantInteractions</a></span><span class="op">(</span><span class="va">obj</span>, pvalue_threshold <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualize results</span></span>
<span><span class="fu"><a href="reference/plotCommunicationHeatmap.html">plotCommunicationHeatmap</a></span><span class="op">(</span><span class="va">obj</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/plotCommunicationCircle.html">plotCommunicationCircle</a></span><span class="op">(</span><span class="va">obj</span><span class="op">)</span></span></code></pre></div>
<p>For Seurat users:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/runScMetaLinkSeurat.html">runScMetaLinkSeurat</a></span><span class="op">(</span><span class="va">seurat_obj</span>, cell_type_column <span class="op">=</span> <span class="st">"cell_type"</span><span class="op">)</span></span></code></pre></div>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="spatial-transcriptomics-analysis">Spatial Transcriptomics Analysis<a class="anchor" aria-label="anchor" href="#spatial-transcriptomics-analysis"></a>
</h2>
<p>scMetaLink supports <strong>spatial transcriptomics</strong> data with distance-weighted communication analysis.</p>
<div class="section level3">
<h3 id="spatial-workflow">Spatial Workflow<a class="anchor" aria-label="anchor" href="#spatial-workflow"></a>
</h3>
<p align="center">
<img src="reference/figures/spatial-flow.png" width="90%"></p>
</div>
<div class="section level3">
<h3 id="spatial-communication-algorithm">Spatial Communication Algorithm<a class="anchor" aria-label="anchor" href="#spatial-communication-algorithm"></a>
</h3>
<p align="center">
<img src="reference/figures/spatial-cal.png" width="90%"></p>
</div>
<div class="section level3">
<h3 id="spatial-quick-start">Spatial Quick Start<a class="anchor" aria-label="anchor" href="#spatial-quick-start"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Zaoqu-Liu/scMetaLink" class="external-link">scMetaLink</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load spatial data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">st_expr</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">st_meta</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">st_scalefactors</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create spatial scMetaLink object</span></span>
<span><span class="va">obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/createScMetaLinkFromSpatial.html">createScMetaLinkFromSpatial</a></span><span class="op">(</span></span>
<span>  expression_data <span class="op">=</span> <span class="va">st_expr</span>,</span>
<span>  spatial_coords <span class="op">=</span> <span class="va">st_meta</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>  cell_meta <span class="op">=</span> <span class="va">st_meta</span>,</span>
<span>  cell_type_column <span class="op">=</span> <span class="st">"cell_type"</span>,</span>
<span>  scale_factors <span class="op">=</span> <span class="va">st_scalefactors</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Infer production and sensing</span></span>
<span><span class="va">obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/inferProduction.html">inferProduction</a></span><span class="op">(</span><span class="va">obj</span><span class="op">)</span></span>
<span><span class="va">obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/inferSensing.html">inferSensing</a></span><span class="op">(</span><span class="va">obj</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compute spatially-weighted communication</span></span>
<span><span class="va">obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/computeSpatialCommunication.html">computeSpatialCommunication</a></span><span class="op">(</span></span>
<span>  <span class="va">obj</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"knn"</span>,        <span class="co"># K-nearest neighbors (recommended for Visium)</span></span>
<span>  k_neighbors <span class="op">=</span> <span class="fl">6</span>,       <span class="co"># Hexagonal grid neighbors</span></span>
<span>  n_permutations <span class="op">=</span> <span class="fl">1000</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Filter and visualize</span></span>
<span><span class="va">obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/filterSignificantInteractions.html">filterSignificantInteractions</a></span><span class="op">(</span><span class="va">obj</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/plotSpatialCellTypes.html">plotSpatialCellTypes</a></span><span class="op">(</span><span class="va">obj</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/plotSpatialCommunicationNetwork.html">plotSpatialCommunicationNetwork</a></span><span class="op">(</span><span class="va">obj</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/plotSpatialFeature.html">plotSpatialFeature</a></span><span class="op">(</span><span class="va">obj</span>, metabolite <span class="op">=</span> <span class="st">"L-Lactic acid"</span>, type <span class="op">=</span> <span class="st">"production"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="spatial-weighting-methods">Spatial Weighting Methods<a class="anchor" aria-label="anchor" href="#spatial-weighting-methods"></a>
</h3>
<table class="table">
<thead><tr class="header">
<th align="left">Method</th>
<th align="left">Formula</th>
<th align="left">Best for</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code>knn</code></td>
<td align="left">K-nearest neighbors</td>
<td align="left">Visium (recommended)</td>
</tr>
<tr class="even">
<td align="left"><code>gaussian</code></td>
<td align="left">exp(-dÂ²/2ÏƒÂ²)</td>
<td align="left">Smooth decay</td>
</tr>
<tr class="odd">
<td align="left"><code>exponential</code></td>
<td align="left">exp(-d/Î»)</td>
<td align="left">Sharp decay</td>
</tr>
<tr class="even">
<td align="left"><code>threshold</code></td>
<td align="left">Binary cutoff</td>
<td align="left">Strict distance limit</td>
</tr>
</tbody>
</table>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="methodology">Methodology<a class="anchor" aria-label="anchor" href="#methodology"></a>
</h2>
<div class="section level3">
<h3 id="metabolite-production-potential-mpp">Metabolite Production Potential (MPP)<a class="anchor" aria-label="anchor" href="#metabolite-production-potential-mpp"></a>
</h3>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>P</mi><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>m</mi><mo>,</mo><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><munder><mo>âˆ‘</mo><mrow><mi>e</mi><mo>âˆˆ</mo><msubsup><mi>E</mi><mi>m</mi><mo>+</mo></msubsup></mrow></munder><msub><mi>w</mi><mi>e</mi></msub><mo>â‹…</mo><mtext mathvariant="normal">expr</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>e</mi><mo>,</mo><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mo stretchy="true" form="prefix">|</mo><msubsup><mi>E</mi><mi>m</mi><mo>+</mo></msubsup><mo stretchy="true" form="postfix">|</mo></mrow></mfrac><mo>â‹…</mo><mi>S</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>m</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">MPP(m, c) = \frac{\sum_{e \in E_m^+} w_e \cdot \text{expr}(e, c)}{|E_m^+|} \cdot S(m)</annotation></semantics></math></p>
<p>where <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>E</mi><mi>m</mi><mo>+</mo></msubsup><annotation encoding="application/x-tex">E_m^+</annotation></semantics></math> denotes biosynthetic enzymes for metabolite <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mi>e</mi></msub><annotation encoding="application/x-tex">w_e</annotation></semantics></math> is the evidence weight, and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>m</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">S(m)</annotation></semantics></math> represents secretion potential.</p>
</div>
<div class="section level3">
<h3 id="metabolite-sensing-capability-msc">Metabolite Sensing Capability (MSC)<a class="anchor" aria-label="anchor" href="#metabolite-sensing-capability-msc"></a>
</h3>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>S</mi><mi>C</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>m</mi><mo>,</mo><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munder><mo>âˆ‘</mo><mrow><mi>r</mi><mo>âˆˆ</mo><msub><mi>R</mi><mi>m</mi></msub></mrow></munder><msub><mi>w</mi><mi>r</mi></msub><mo>â‹…</mo><mi>Ï„</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>r</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>â‹…</mo><mtext mathvariant="normal">expr</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>r</mi><mo>,</mo><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">MSC(m, c) = \sum_{r \in R_m} w_r \cdot \tau(r) \cdot \text{expr}(r, c)</annotation></semantics></math></p>
<p>where <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mi>m</mi></msub><annotation encoding="application/x-tex">R_m</annotation></semantics></math> includes receptors and transporters for metabolite <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>, and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ï„</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>r</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\tau(r)</annotation></semantics></math> is the receptor type weight.</p>
</div>
<div class="section level3">
<h3 id="communication-score">Communication Score<a class="anchor" aria-label="anchor" href="#communication-score"></a>
</h3>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo>â†’</mo><mi>r</mi><mo>,</mo><mi>m</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msqrt><mrow><mi>M</mi><mi>P</mi><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>m</mi><mo>,</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>Ã—</mo><mi>M</mi><mi>S</mi><mi>C</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>m</mi><mo>,</mo><mi>r</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msqrt></mrow><annotation encoding="application/x-tex">C(s \rightarrow r, m) = \sqrt{MPP(m, s) \times MSC(m, r)}</annotation></semantics></math></p>
</div>
<div class="section level3">
<h3 id="spatial-communication-score">Spatial Communication Score<a class="anchor" aria-label="anchor" href="#spatial-communication-score"></a>
</h3>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mrow><mi>s</mi><mi>p</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>a</mi><mi>l</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo>â†’</mo><mi>r</mi><mo>,</mo><mi>m</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msqrt><mrow><mi>M</mi><mi>P</mi><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>m</mi><mo>,</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>Ã—</mo><mi>M</mi><mi>S</mi><mi>C</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>m</mi><mo>,</mo><mi>r</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msqrt><mo>Ã—</mo><mi>w</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>d</mi><mrow><mi>s</mi><mi>r</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">C_{spatial}(s \rightarrow r, m) = \sqrt{MPP(m, s) \times MSC(m, r)} \times w(d_{sr})</annotation></semantics></math></p>
<p>where <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>d</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">w(d)</annotation></semantics></math> is the spatial weight function (e.g., Gaussian decay).</p>
<p>Statistical significance is assessed via permutation testing with FDR correction.</p>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="tutorials">Tutorials<a class="anchor" aria-label="anchor" href="#tutorials"></a>
</h2>
<table class="table">
<colgroup>
<col width="50%">
<col width="50%">
</colgroup>
<thead><tr class="header">
<th align="left">Tutorial</th>
<th align="left">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><a href="https://Zaoqu-Liu.github.io/scMetaLink/articles/quick-start.html" class="external-link">Quick Start</a></td>
<td align="left">Basic workflow</td>
</tr>
<tr class="even">
<td align="left"><a href="https://Zaoqu-Liu.github.io/scMetaLink/articles/theory.html" class="external-link">Theory</a></td>
<td align="left">Mathematical framework</td>
</tr>
<tr class="odd">
<td align="left"><a href="https://Zaoqu-Liu.github.io/scMetaLink/articles/production-sensing.html" class="external-link">Production &amp; Sensing</a></td>
<td align="left">Inference details</td>
</tr>
<tr class="even">
<td align="left"><a href="https://Zaoqu-Liu.github.io/scMetaLink/articles/communication.html" class="external-link">Communication</a></td>
<td align="left">Statistical analysis</td>
</tr>
<tr class="odd">
<td align="left"><a href="https://Zaoqu-Liu.github.io/scMetaLink/articles/spatial-analysis.html" class="external-link">Spatial Analysis</a></td>
<td align="left">Spatial transcriptomics</td>
</tr>
<tr class="even">
<td align="left"><a href="https://Zaoqu-Liu.github.io/scMetaLink/articles/lactate-signaling.html" class="external-link">Lactate Signaling</a></td>
<td align="left">Lactate-mediated communication</td>
</tr>
<tr class="odd">
<td align="left"><a href="https://Zaoqu-Liu.github.io/scMetaLink/articles/visualization.html" class="external-link">Visualization</a></td>
<td align="left">Plotting functions</td>
</tr>
<tr class="even">
<td align="left"><a href="https://Zaoqu-Liu.github.io/scMetaLink/articles/applications.html" class="external-link">Applications</a></td>
<td align="left">Case studies</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h2>
<p>If you use scMetaLink in your research, please cite:</p>
<pre><code>Liu Z, et al. (2026). scMetaLink: Inferring metabolite-mediated cell-cell
communication from single-cell and spatial transcriptomics data.</code></pre>
</div>
<div class="section level2">
<h2 id="contact">Contact<a class="anchor" aria-label="anchor" href="#contact"></a>
</h2>
<ul>
<li>
<strong>Author</strong>: Zaoqu Liu</li>
<li>
<strong>Email</strong>: <a href="mailto:liuzaoqu@163.com" class="email">liuzaoqu@163.com</a>
</li>
<li>
<strong>GitHub</strong>: <a href="https://github.com/Zaoqu-Liu/scMetaLink" class="external-link uri">https://github.com/Zaoqu-Liu/scMetaLink</a>
</li>
</ul>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/Zaoqu-Liu/scMetaLink/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/Zaoqu-Liu/scMetaLink/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing scMetaLink</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Zaoqu Liu <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-0452-742X" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/Zaoqu-Liu/scMetaLink/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/Zaoqu-Liu/scMetaLink/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://opensource.org/licenses/MIT" class="external-link"><img src="https://img.shields.io/badge/License-MIT-blue.svg" alt="License: MIT"></a></li>
<li><a href="https://www.r-project.org/" class="external-link"><img src="https://img.shields.io/badge/R-%3E%3D4.0-blue.svg" alt="R version"></a></li>
<li><a href="https://github.com/Zaoqu-Liu/scMetaLink" class="external-link"><img src="https://img.shields.io/badge/platform-linux%20%7C%20macOS%20%7C%20windows-lightgrey.svg" alt="Platform"></a></li>
<li><a href="https://zaoqu-liu.r-universe.dev/scMetaLink" class="external-link"><img src="https://zaoqu-liu.r-universe.dev/badges/scMetaLink" alt="r-universe"></a></li>
<li><a href="https://github.com/Zaoqu-Liu/scMetaLink/stargazers" class="external-link"><img src="https://img.shields.io/github/stars/Zaoqu-Liu/scMetaLink?style=social" alt="GitHub stars"></a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Zaoqu Liu.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
